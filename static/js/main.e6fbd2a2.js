/*! For license information please see main.e6fbd2a2.js.LICENSE.txt */
!function(){var t={7465:function(t){"use strict";var e,i="object"===typeof Reflect?Reflect:null,n=i&&"function"===typeof i.apply?i.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};e=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!==t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(i,n){function r(i){t.removeListener(e,s),n(i)}function s(){"function"===typeof t.removeListener&&t.removeListener("error",r),i([].slice.call(arguments))}p(t,e,s,{once:!0}),"error"!==e&&function(t,e,i){"function"===typeof t.on&&p(t,"error",e,i)}(t,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function u(t,e,i,n){var r,s,a,u;if(o(i),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),s=t._events),a=s[e]),void 0===a)a=s[e]=i,++t._eventsCount;else if("function"===typeof a?a=s[e]=n?[i,a]:[a,i]:n?a.unshift(i):a.push(i),(r=l(t))>0&&a.length>r&&!a.warned){a.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=a.length,u=h,console&&console.warn&&console.warn(u)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},r=h.bind(n);return r.listener=i,n.wrapFn=r,r}function f(t,e,i){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"===typeof r?i?[r.listener||r]:[r]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(r):v(r,r.length)}function d(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"===typeof i)return 1;if(void 0!==i)return i.length}return 0}function v(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}function p(t,e,i,n){if("function"===typeof t.on)n.once?t.once(e,i):t.on(e,i);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(s){n.once&&t.removeEventListener(e,r),i(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var r="error"===t,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=s[t];if(void 0===l)return!1;if("function"===typeof l)n(l,this,e);else{var u=l.length,h=v(l,u);for(i=0;i<u;++i)n(h[i],this,e)}return!0},s.prototype.addListener=function(t,e){return u(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return u(this,t,e,!0)},s.prototype.once=function(t,e){return o(e),this.on(t,c(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return o(e),this.prependListener(t,c(this,t,e)),this},s.prototype.removeListener=function(t,e){var i,n,r,s,a;if(o(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!==typeof i){for(r=-1,s=i.length-1;s>=0;s--)if(i[s]===e||i[s].listener===e){a=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,r),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},s.prototype.listeners=function(t){return f(this,t,!0)},s.prototype.rawListeners=function(t){return f(this,t,!1)},s.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},3294:function(t,e,i){"use strict";var n=i(4704).default;function r(t){if(this.words=[],null!=(s=t)&&void 0!==s[Symbol.iterator]){var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.add(r)}}catch(a){i.e(a)}finally{i.f()}}var s}r.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t},r.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t},r.prototype.clear=function(){this.words=[]},r.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)},r.prototype.isEmpty=function(t){for(var e=this.words.length,i=0;i<e;i++)if(0!==this.words[i])return!1;return!0},r.prototype.has=function(t){return 0!==(this.words[t>>>5]&1<<t)},r.prototype.checkedAdd=function(t){this.resize(t);var e=this.words[t>>>5],i=e|1<<t;return this.words[t>>>5]=i,(i^e)>>>t},r.prototype.trim=function(t){for(var e=this.words.length;e>0&&0===this.words[e-1];)e--;this.words=this.words.slice(0,e)},r.prototype.resize=function(t){for(var e=t+32>>>5,i=this.words.length;i<e;i++)this.words[i]=0},r.prototype.hammingWeight=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},r.prototype.hammingWeight4=function(t,e,i,n){return 16843009*((t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)+(i=(i=(858993459&(i-=i>>>1&1431655765))+(i>>>2&858993459))+(i>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135))>>>24},r.prototype.size=function(){for(var t=0,e=this.words.length,i=this.words,n=0;n<e;n++)t+=this.hammingWeight(i[n]);return t},r.prototype.array=function(){for(var t=new Array(this.size()),e=0,i=this.words.length,n=0;n<i;++n)for(var r=this.words[n];0!=r;){var s=r&-r;t[e++]=(n<<5)+this.hammingWeight(s-1|0),r^=s}return t},r.prototype.forEach=function(t){for(var e=this.words.length,i=0;i<e;++i)for(var n=this.words[i];0!=n;){var r=n&-n;t((i<<5)+this.hammingWeight(r-1|0)),n^=r}},r.prototype.clone=function(){var t=Object.create(r.prototype);return t.words=this.words.slice(),t},r.prototype.intersects=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i<e;++i)if(0!==(this.words[i]&t.words[i]))return!0;return!1},r.prototype.intersection=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i+7<e;i+=8)this.words[i]&=t.words[i],this.words[i+1]&=t.words[i+1],this.words[i+2]&=t.words[i+2],this.words[i+3]&=t.words[i+3],this.words[i+4]&=t.words[i+4],this.words[i+5]&=t.words[i+5],this.words[i+6]&=t.words[i+6],this.words[i+7]&=t.words[i+7];for(;i<e;++i)this.words[i]&=t.words[i];var n=this.words.length;for(i=e;i<n;++i)this.words[i]=0;return this},r.prototype.intersection_size=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0,n=0;n<e;++n)i+=this.hammingWeight(this.words[n]&t.words[n]);return i},r.prototype.new_intersection=function(t){var e=Object.create(r.prototype),i=Math.min(this.words.length,t.words.length);e.words=new Array(i);for(var n=i,s=0;s+7<n;s+=8)e.words[s]=this.words[s]&t.words[s],e.words[s+1]=this.words[s+1]&t.words[s+1],e.words[s+2]=this.words[s+2]&t.words[s+2],e.words[s+3]=this.words[s+3]&t.words[s+3],e.words[s+4]=this.words[s+4]&t.words[s+4],e.words[s+5]=this.words[s+5]&t.words[s+5],e.words[s+6]=this.words[s+6]&t.words[s+6],e.words[s+7]=this.words[s+7]&t.words[s+7];for(;s<n;++s)e.words[s]=this.words[s]&t.words[s];return e},r.prototype.equals=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i<e;++i)if(this.words[i]!=t.words[i])return!1;if(this.words.length<t.words.length){var n=t.words.length;for(i=this.words.length;i<n;++i)if(0!=t.words[i])return!1}else if(t.words.length<this.words.length)for(n=this.words.length,i=t.words.length;i<n;++i)if(0!=this.words[i])return!1;return!0},r.prototype.difference=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i+7<e;i+=8)this.words[i]&=~t.words[i],this.words[i+1]&=~t.words[i+1],this.words[i+2]&=~t.words[i+2],this.words[i+3]&=~t.words[i+3],this.words[i+4]&=~t.words[i+4],this.words[i+5]&=~t.words[i+5],this.words[i+6]&=~t.words[i+6],this.words[i+7]&=~t.words[i+7];for(;i<e;++i)this.words[i]&=~t.words[i];return this},r.prototype.difference_size=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0,n=0;n<e;++n)i+=this.hammingWeight(this.words[n]&~t.words[n]);for(var r=this.words.length;n<r;++n)i+=this.hammingWeight(this.words[n]);return i},r.prototype.toString=function(){return"{"+this.array().join(",")+"}"},r.prototype.union=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i+7<e;i+=8)this.words[i]|=t.words[i],this.words[i+1]|=t.words[i+1],this.words[i+2]|=t.words[i+2],this.words[i+3]|=t.words[i+3],this.words[i+4]|=t.words[i+4],this.words[i+5]|=t.words[i+5],this.words[i+6]|=t.words[i+6],this.words[i+7]|=t.words[i+7];for(;i<e;++i)this.words[i]|=t.words[i];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);var n=t.words.length;for(i=e;i<n;++i)this.words[i]=t.words[i]}return this},r.prototype.new_union=function(t){var e=Object.create(r.prototype),i=Math.max(this.words.length,t.words.length);e.words=new Array(i);for(var n=Math.min(this.words.length,t.words.length),s=0;s+7<n;s+=8)e.words[s]=this.words[s]|t.words[s],e.words[s+1]=this.words[s+1]|t.words[s+1],e.words[s+2]=this.words[s+2]|t.words[s+2],e.words[s+3]=this.words[s+3]|t.words[s+3],e.words[s+4]=this.words[s+4]|t.words[s+4],e.words[s+5]=this.words[s+5]|t.words[s+5],e.words[s+6]=this.words[s+6]|t.words[s+6],e.words[s+7]=this.words[s+7]|t.words[s+7];for(;s<n;++s)e.words[s]=this.words[s]|t.words[s];var a=this.words.length;for(s=n;s<a;++s)e.words[s]=this.words[s];var o=t.words.length;for(s=n;s<o;++s)e.words[s]=t.words[s];return e},r.prototype.new_difference=function(t){return this.clone().difference(t)},r.prototype.union_size=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0,n=0;n<e;++n)i+=this.hammingWeight(this.words[n]|t.words[n]);if(this.words.length<t.words.length){var r=t.words.length;for(n=this.words.length;n<r;++n)i+=this.hammingWeight(0|t.words[n])}else for(r=this.words.length,n=t.words.length;n<r;++n)i+=this.hammingWeight(0|this.words[n]);return i},t.exports=r},6894:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Archetype=void 0;var a=s(i(3294)),o=n((function t(e){r(this,t),this.componentBits=new a.default,this.componentBitsInitialized=!1,this.componentTypes=e}));e.Archetype=o},8315:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Component=void 0;var s=n((function t(){r(this,t)}));e.Component=s},3907:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ComponentMapper=void 0;var s=function(){function t(){n(this,t),this.data=[]}return r(t,[{key:"add",value:function(t,e){this.data[t]=e}},{key:"get",value:function(t){return this.data[t]}},{key:"remove",value:function(t){delete this.data[t]}}]),t}();e.ComponentMapper=s},1776:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=i(1588).default,o=i(3808).default,l=i(1655).default,u=i(6389).default,h=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.EntityIteratingSystem=void 0;var c=i(7812),f=h(i(3294)),d=function(t){l(i,t);var e=u(i);function i(t){var n;return r(this,i),(n=e.call(this)).componentBits=new f.default,n.types=t,n}return s(i,[{key:"setWorld",value:function(t){a(o(i.prototype),"setWorld",this).call(this,t);var e,r=n(this.types);try{for(r.s();!(e=r.n()).done;){var s=e.value;this.componentBits.add(t.getComponentIndex(s))}}catch(l){r.e(l)}finally{r.f()}}},{key:"process",value:function(){this.begin(),this.world.getEntities(this.componentBits,this.processEntity.bind(this)),this.end()}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),i}(c.System);e.EntityIteratingSystem=d},3929:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.EntitySystem=void 0;var o=function(t){s(i,t);var e=a(i);function i(){var t;return n(this,i),(t=e.apply(this,arguments)).entities=[],t}return r(i,[{key:"process",value:function(){this.entities.length=0,this.begin(),this.world.getEntities(this.componentBits,this.processEntity.bind(this)),this.processEntities(this.entities),this.end()}},{key:"processEntity",value:function(t){this.entities.push(t)}}]),i}(i(1776).EntityIteratingSystem);e.EntitySystem=o},8841:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Inject=void 0,e.Inject=function(t){return function(e,i){var n=e.constructor;n.hasOwnProperty("__inject__")||(n.__inject__={}),n.__inject__[i]=t}}},8675:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InjectMapper=void 0,e.InjectMapper=function(t){return function(e,i){var n=e.constructor;n.hasOwnProperty("__injectMapper__")||(n.__injectMapper__={}),n.__injectMapper__[i]=t}}},7812:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.System=void 0;var s=function(){function t(){n(this,t)}return r(t,[{key:"setWorld",value:function(t){this.world=t}},{key:"initialized",value:function(){}},{key:"dispose",value:function(){}}]),t}();e.System=s},1694:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=a(i(3294)),l=i(3907),u=function(){function t(){r(this,t),this.index=0,this.mappers={},this.componentBitsMap=[],this.componentIndices=new Map,this.currentComponentIndex=0,this.activeSystems=[],this.passiveSystems=[],this.injectionRegistry={},this.delta=0}return s(t,[{key:"getNewId",value:function(){return this.index++}},{key:"createEntity",value:function(){return this.getNewId()}},{key:"getComponentBits",value:function(t){return this.componentBitsMap[t]||(this.componentBitsMap[t]=new o.default),this.componentBitsMap[t]}},{key:"getMapper",value:function(t){var e=this.getComponentIndex(t);return this.getMapperByIndex(e)}},{key:"getMapperByIndex",value:function(t){return this.mappers[t]||(this.mappers[t]=new l.ComponentMapper),this.mappers[t]}},{key:"getComponentIndex",value:function(t){var e=this.componentIndices.get(t);return void 0===e&&(e=this.currentComponentIndex++,this.componentIndices.set(t,e)),e}},{key:"createEntityByArchetype",value:function(t){var e=this,i=this.getNewId();return t.componentTypes.forEach((function(n){var r=new n;t.componentBitsInitialized||t.componentBits.add(e.getComponentIndex(n)),e.addComponent(i,r,!1)})),this.componentBitsMap[i]=t.componentBits,i}},{key:"addComponent",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getComponentIndex(e.constructor),r=this.getMapperByIndex(n);return r.add(t,e),i&&this.getComponentBits(t).add(n),e}},{key:"getComponent",value:function(t,e){return this.getMapper(e).get(t)}},{key:"getEntities",value:function(t,e){for(var i=0;i<this.componentBitsMap.length;i++)if(this.componentBitsMap[i]){var n=this.componentBitsMap[i];t.union_size(n)===n.size()&&e(i)}}},{key:"addSystem",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?this.activeSystems.push(t):this.passiveSystems.push(t),t.setWorld(this),this.injectMapper(t),this.inject(t),t.initialized()}},{key:"injectMapper",value:function(t){var e=t.constructor.__injectMapper__||{};for(var i in e){var n=e[i];t[i]=this.getMapper(n)}}},{key:"register",value:function(t,e){this.injectionRegistry[t]=e}},{key:"inject",value:function(t){var e=t.constructor.__inject__||{};for(var i in e){var n=e[i];t[i]=this.injectionRegistry[n]}}},{key:"dispose",value:function(){var t,e=n(this.activeSystems);try{for(e.s();!(t=e.n()).done;){t.value.dispose()}}catch(s){e.e(s)}finally{e.f()}var i,r=n(this.passiveSystems);try{for(r.s();!(i=r.n()).done;){i.value.dispose()}}catch(s){r.e(s)}finally{r.f()}}},{key:"setDelta",value:function(t){this.delta=t}},{key:"processActiveSystem",value:function(){var t,e=n(this.activeSystems);try{for(e.s();!(t=e.n()).done;){t.value.process()}}catch(i){e.e(i)}finally{e.f()}}},{key:"processPassiveSystem",value:function(){var t,e=n(this.passiveSystems);try{for(e.s();!(t=e.n()).done;){t.value.process()}}catch(i){e.e(i)}finally{e.f()}}},{key:"deleteEntity",value:function(t){for(var e in this.mappers)this.mappers[e].remove(t);delete this.componentBitsMap[t]}},{key:"isEntityActive",value:function(t){return!!this.componentBitsMap[t]}}]),t}();e.default=u},7530:function(t,e,i){"use strict";var n=i(1694);Object.defineProperty(e,"q3",{enumerable:!0,get:function(){return n.default}});var r=i(6894);Object.defineProperty(e,"Yl",{enumerable:!0,get:function(){return r.Archetype}});var s=i(8315);Object.defineProperty(e,"wA",{enumerable:!0,get:function(){return s.Component}});var a=i(3907);var o=i(1776);var l=i(3929);var u=i(7812);Object.defineProperty(e,"xP",{enumerable:!0,get:function(){return u.System}});var h=i(8675);var c=i(8841);Object.defineProperty(e,"tB",{enumerable:!0,get:function(){return c.Inject}})},4569:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultRenderableSorter=void 0;var s=i(2668),a=i(8213),o=function(){function t(){n(this,t),this.tmpV1=new s.Vector3,this.tmpV2=new s.Vector3}return r(t,[{key:"sort",value:function(t,e){this.camera=t}},{key:"getTranslation",value:function(t,e,i){return e.isZero()?t.getTranslation(i):t.hasRotationOrScaling()?i.set(e.x,e.y,e.z).multiply(t):t.getTranslation(i).add(e),i}},{key:"compare",value:function(t,e){var i=t.material.has(a.BlendingAttribute.Type)&&t.material.get(a.BlendingAttribute.Type).blended;if(i!==(e.material.has(a.BlendingAttribute.Type)&&e.material.get(a.BlendingAttribute.Type).blended))return i?1:-1;this.getTranslation(t.worldTransform,t.meshPart.center,this.tmpV1),this.getTranslation(e.worldTransform,e.meshPart.center,this.tmpV2);var n=1e3*this.camera.position.dst2(this.tmpV1)-1e3*this.camera.position.dst2(this.tmpV2),r=n<0?-1:n>0?1:0;return i?-r:r}}]),t}();e.DefaultRenderableSorter=o},143:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultShaderProvider=void 0;var a=i(375),o=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";r(this,t),this.gl=e,this.shaders=[],this.config=i||new a.Config(n,s)}return s(t,[{key:"dispose",value:function(){}},{key:"getShader",value:function(t){var e=t.shader;if(e&&e.canRender(t))return e;var i,r=n(this.shaders);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(s.canRender(t))return s}}catch(o){r.e(o)}finally{r.f()}var a=this.createShader(this.gl,t);if(!a.canRender(t))throw new Error("unable to provide a shader for this renderable");return a.init(),this.shaders.push(a),a}},{key:"createShader",value:function(t,e){return new a.DefaultShader(t,e,this.config)}}]),t}();e.DefaultShaderProvider=o},138:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultTextureBinder=void 0;var s=i(3432),a=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;n(this,t),this.reuseCount=0,this.bindCount=0,this.currentTexture=0,t.gl=e;var a=Math.min(t.getMaxTextureUnits(),t.MAX_GLES_UNITS);if(s<0&&(s=a-r),r<0||s<0||r+s>a)throw new Error("Illegal arguments");this.method=i,this.offset=r,this.count=s,this.textures=new Array(s),this.unitsLRU=i===t.LRU?new Array(s):null}return r(t,[{key:"begin",value:function(){for(var t=0;t<this.count;t++)this.textures[t]=null,null!=this.unitsLRU&&(this.unitsLRU[t]=t)}},{key:"end",value:function(){t.gl.activeTexture(t.gl.TEXTURE0)}},{key:"bindTexture",value:function(e){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this.reused=!1,this.method){case t.ROUNDROBIN:i=this.offset+this.bindTextureRoundRobin(e);break;case t.LRU:i=this.offset+this.bindTextureLRU(e);break;default:return-1}return this.reused?(this.reuseCount++,n?e.bind(i):t.gl.activeTexture(t.gl.TEXTURE0+i)):this.bindCount++,e.setWraps(s.TextureWrap.Repeat,s.TextureWrap.Repeat),e.setFilters(s.TextureFilter.Linear,s.TextureFilter.Linear),i}},{key:"bindTextureRoundRobin",value:function(t){for(var e=0;e<this.count;e++){var i=(this.currentTexture+e)%this.count;if(this.textures[i]===t)return this.reused=!0,i}return this.currentTexture=(this.currentTexture+1)%this.count,this.textures[this.currentTexture]=t,t.bind(this.offset+this.currentTexture),this.currentTexture}},{key:"bindTextureLRU",value:function(t){var e;for(e=0;e<this.count;e++){var i=this.unitsLRU[e];if(this.textures[i]===t){this.reused=!0;break}if(!this.textures[i])break}e>=this.count&&(e=this.count-1);for(var n=this.unitsLRU[e];e>0;)this.unitsLRU[e]=this.unitsLRU[e-1],e--;return this.unitsLRU[0]=n,this.reused||(this.textures[n]=t,t.bind(this.offset+n)),n}},{key:"getBindCount",value:function(){return this.bindCount}},{key:"getReuseCount",value:function(){return this.reuseCount}},{key:"resetCounts",value:function(){this.bindCount=this.reuseCount=0}}],[{key:"getMaxTextureUnits",value:function(){return this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)}}]),t}();e.DefaultTextureBinder=a,a.ROUNDROBIN=0,a.LRU=1,a.MAX_GLES_UNITS=32},9203:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GL20=void 0;var s=n((function t(){r(this,t)}));e.GL20=s,s.GL_ES_VERSION_2_0=1,s.GL_DEPTH_BUFFER_BIT=256,s.GL_STENCIL_BUFFER_BIT=1024,s.GL_COLOR_BUFFER_BIT=16384,s.GL_FALSE=0,s.GL_TRUE=1,s.GL_POINTS=0,s.GL_LINES=1,s.GL_LINE_LOOP=2,s.GL_LINE_STRIP=3,s.GL_TRIANGLES=4,s.GL_TRIANGLE_STRIP=5,s.GL_TRIANGLE_FAN=6,s.GL_ZERO=0,s.GL_ONE=1,s.GL_SRC_COLOR=768,s.GL_ONE_MINUS_SRC_COLOR=769,s.GL_SRC_ALPHA=770,s.GL_ONE_MINUS_SRC_ALPHA=771,s.GL_DST_ALPHA=772,s.GL_ONE_MINUS_DST_ALPHA=773,s.GL_DST_COLOR=774,s.GL_ONE_MINUS_DST_COLOR=775,s.GL_SRC_ALPHA_SATURATE=776,s.GL_FUNC_ADD=32774,s.GL_BLEND_EQUATION=32777,s.GL_BLEND_EQUATION_RGB=32777,s.GL_BLEND_EQUATION_ALPHA=34877,s.GL_FUNC_SUBTRACT=32778,s.GL_FUNC_REVERSE_SUBTRACT=32779,s.GL_BLEND_DST_RGB=32968,s.GL_BLEND_SRC_RGB=32969,s.GL_BLEND_DST_ALPHA=32970,s.GL_BLEND_SRC_ALPHA=32971,s.GL_CONSTANT_COLOR=32769,s.GL_ONE_MINUS_CONSTANT_COLOR=32770,s.GL_CONSTANT_ALPHA=32771,s.GL_ONE_MINUS_CONSTANT_ALPHA=32772,s.GL_BLEND_COLOR=32773,s.GL_ARRAY_BUFFER=34962,s.GL_ELEMENT_ARRAY_BUFFER=34963,s.GL_ARRAY_BUFFER_BINDING=34964,s.GL_ELEMENT_ARRAY_BUFFER_BINDING=34965,s.GL_STREAM_DRAW=35040,s.GL_STATIC_DRAW=35044,s.GL_DYNAMIC_DRAW=35048,s.GL_BUFFER_SIZE=34660,s.GL_BUFFER_USAGE=34661,s.GL_CURRENT_VERTEX_ATTRIB=34342,s.GL_FRONT=1028,s.GL_BACK=1029,s.GL_FRONT_AND_BACK=1032,s.GL_TEXTURE_2D=3553,s.GL_CULL_FACE=2884,s.GL_BLEND=3042,s.GL_DITHER=3024,s.GL_STENCIL_TEST=2960,s.GL_DEPTH_TEST=2929,s.GL_SCISSOR_TEST=3089,s.GL_POLYGON_OFFSET_FILL=32823,s.GL_SAMPLE_ALPHA_TO_COVERAGE=32926,s.GL_SAMPLE_COVERAGE=32928,s.GL_NO_ERROR=0,s.GL_INVALID_ENUM=1280,s.GL_INVALID_VALUE=1281,s.GL_INVALID_OPERATION=1282,s.GL_OUT_OF_MEMORY=1285,s.GL_CW=2304,s.GL_CCW=2305,s.GL_LINE_WIDTH=2849,s.GL_ALIASED_POINT_SIZE_RANGE=33901,s.GL_ALIASED_LINE_WIDTH_RANGE=33902,s.GL_CULL_FACE_MODE=2885,s.GL_FRONT_FACE=2886,s.GL_DEPTH_RANGE=2928,s.GL_DEPTH_WRITEMASK=2930,s.GL_DEPTH_CLEAR_VALUE=2931,s.GL_DEPTH_FUNC=2932,s.GL_STENCIL_CLEAR_VALUE=2961,s.GL_STENCIL_FUNC=2962,s.GL_STENCIL_FAIL=2964,s.GL_STENCIL_PASS_DEPTH_FAIL=2965,s.GL_STENCIL_PASS_DEPTH_PASS=2966,s.GL_STENCIL_REF=2967,s.GL_STENCIL_VALUE_MASK=2963,s.GL_STENCIL_WRITEMASK=2968,s.GL_STENCIL_BACK_FUNC=34816,s.GL_STENCIL_BACK_FAIL=34817,s.GL_STENCIL_BACK_PASS_DEPTH_FAIL=34818,s.GL_STENCIL_BACK_PASS_DEPTH_PASS=34819,s.GL_STENCIL_BACK_REF=36003,s.GL_STENCIL_BACK_VALUE_MASK=36004,s.GL_STENCIL_BACK_WRITEMASK=36005,s.GL_VIEWPORT=2978,s.GL_SCISSOR_BOX=3088,s.GL_COLOR_CLEAR_VALUE=3106,s.GL_COLOR_WRITEMASK=3107,s.GL_UNPACK_ALIGNMENT=3317,s.GL_PACK_ALIGNMENT=3333,s.GL_MAX_TEXTURE_SIZE=3379,s.GL_MAX_TEXTURE_UNITS=34018,s.GL_MAX_VIEWPORT_DIMS=3386,s.GL_SUBPIXEL_BITS=3408,s.GL_RED_BITS=3410,s.GL_GREEN_BITS=3411,s.GL_BLUE_BITS=3412,s.GL_ALPHA_BITS=3413,s.GL_DEPTH_BITS=3414,s.GL_STENCIL_BITS=3415,s.GL_POLYGON_OFFSET_UNITS=10752,s.GL_POLYGON_OFFSET_FACTOR=32824,s.GL_TEXTURE_BINDING_2D=32873,s.GL_SAMPLE_BUFFERS=32936,s.GL_SAMPLES=32937,s.GL_SAMPLE_COVERAGE_VALUE=32938,s.GL_SAMPLE_COVERAGE_INVERT=32939,s.GL_NUM_COMPRESSED_TEXTURE_FORMATS=34466,s.GL_COMPRESSED_TEXTURE_FORMATS=34467,s.GL_DONT_CARE=4352,s.GL_FASTEST=4353,s.GL_NICEST=4354,s.GL_GENERATE_MIPMAP=33169,s.GL_GENERATE_MIPMAP_HINT=33170,s.GL_BYTE=5120,s.GL_UNSIGNED_BYTE=5121,s.GL_SHORT=5122,s.GL_UNSIGNED_SHORT=5123,s.GL_INT=5124,s.GL_UNSIGNED_INT=5125,s.GL_FLOAT=5126,s.GL_FIXED=5132,s.GL_DEPTH_COMPONENT=6402,s.GL_ALPHA=6406,s.GL_RGB=6407,s.GL_RGBA=6408,s.GL_LUMINANCE=6409,s.GL_LUMINANCE_ALPHA=6410,s.GL_UNSIGNED_SHORT_4_4_4_4=32819,s.GL_UNSIGNED_SHORT_5_5_5_1=32820,s.GL_UNSIGNED_SHORT_5_6_5=33635,s.GL_FRAGMENT_SHADER=35632,s.GL_VERTEX_SHADER=35633,s.GL_MAX_VERTEX_ATTRIBS=34921,s.GL_MAX_VERTEX_UNIFORM_VECTORS=36347,s.GL_MAX_VARYING_VECTORS=36348,s.GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,s.GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,s.GL_MAX_TEXTURE_IMAGE_UNITS=34930,s.GL_MAX_FRAGMENT_UNIFORM_VECTORS=36349,s.GL_SHADER_TYPE=35663,s.GL_DELETE_STATUS=35712,s.GL_LINK_STATUS=35714,s.GL_VALIDATE_STATUS=35715,s.GL_ATTACHED_SHADERS=35717,s.GL_ACTIVE_UNIFORMS=35718,s.GL_ACTIVE_UNIFORM_MAX_LENGTH=35719,s.GL_ACTIVE_ATTRIBUTES=35721,s.GL_ACTIVE_ATTRIBUTE_MAX_LENGTH=35722,s.GL_SHADING_LANGUAGE_VERSION=35724,s.GL_CURRENT_PROGRAM=35725,s.GL_NEVER=512,s.GL_LESS=513,s.GL_EQUAL=514,s.GL_LEQUAL=515,s.GL_GREATER=516,s.GL_NOTEQUAL=517,s.GL_GEQUAL=518,s.GL_ALWAYS=519,s.GL_KEEP=7680,s.GL_REPLACE=7681,s.GL_INCR=7682,s.GL_DECR=7683,s.GL_INVERT=5386,s.GL_INCR_WRAP=34055,s.GL_DECR_WRAP=34056,s.GL_VENDOR=7936,s.GL_RENDERER=7937,s.GL_VERSION=7938,s.GL_EXTENSIONS=7939,s.GL_NEAREST=9728,s.GL_LINEAR=9729,s.GL_NEAREST_MIPMAP_NEAREST=9984,s.GL_LINEAR_MIPMAP_NEAREST=9985,s.GL_NEAREST_MIPMAP_LINEAR=9986,s.GL_LINEAR_MIPMAP_LINEAR=9987,s.GL_TEXTURE_MAG_FILTER=10240,s.GL_TEXTURE_MIN_FILTER=10241,s.GL_TEXTURE_WRAP_S=10242,s.GL_TEXTURE_WRAP_T=10243,s.GL_TEXTURE=5890,s.GL_TEXTURE_CUBE_MAP=34067,s.GL_TEXTURE_BINDING_CUBE_MAP=34068,s.GL_TEXTURE_CUBE_MAP_POSITIVE_X=34069,s.GL_TEXTURE_CUBE_MAP_NEGATIVE_X=34070,s.GL_TEXTURE_CUBE_MAP_POSITIVE_Y=34071,s.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,s.GL_TEXTURE_CUBE_MAP_POSITIVE_Z=34073,s.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,s.GL_MAX_CUBE_MAP_TEXTURE_SIZE=34076,s.GL_TEXTURE0=33984,s.GL_TEXTURE1=33985,s.GL_TEXTURE2=33986,s.GL_TEXTURE3=33987,s.GL_TEXTURE4=33988,s.GL_TEXTURE5=33989,s.GL_TEXTURE6=33990,s.GL_TEXTURE7=33991,s.GL_TEXTURE8=33992,s.GL_TEXTURE9=33993,s.GL_TEXTURE10=33994,s.GL_TEXTURE11=33995,s.GL_TEXTURE12=33996,s.GL_TEXTURE13=33997,s.GL_TEXTURE14=33998,s.GL_TEXTURE15=33999,s.GL_TEXTURE16=34e3,s.GL_TEXTURE17=34001,s.GL_TEXTURE18=34002,s.GL_TEXTURE19=34003,s.GL_TEXTURE20=34004,s.GL_TEXTURE21=34005,s.GL_TEXTURE22=34006,s.GL_TEXTURE23=34007,s.GL_TEXTURE24=34008,s.GL_TEXTURE25=34009,s.GL_TEXTURE26=34010,s.GL_TEXTURE27=34011,s.GL_TEXTURE28=34012,s.GL_TEXTURE29=34013,s.GL_TEXTURE30=34014,s.GL_TEXTURE31=34015,s.GL_ACTIVE_TEXTURE=34016,s.GL_REPEAT=10497,s.GL_CLAMP_TO_EDGE=33071,s.GL_MIRRORED_REPEAT=33648,s.GL_FLOAT_VEC2=35664,s.GL_FLOAT_VEC3=35665,s.GL_FLOAT_VEC4=35666,s.GL_INT_VEC2=35667,s.GL_INT_VEC3=35668,s.GL_INT_VEC4=35669,s.GL_BOOL=35670,s.GL_BOOL_VEC2=35671,s.GL_BOOL_VEC3=35672,s.GL_BOOL_VEC4=35673,s.GL_FLOAT_MAT2=35674,s.GL_FLOAT_MAT3=35675,s.GL_FLOAT_MAT4=35676,s.GL_SAMPLER_2D=35678,s.GL_SAMPLER_CUBE=35680,s.GL_VERTEX_ATTRIB_ARRAY_ENABLED=34338,s.GL_VERTEX_ATTRIB_ARRAY_SIZE=34339,s.GL_VERTEX_ATTRIB_ARRAY_STRIDE=34340,s.GL_VERTEX_ATTRIB_ARRAY_TYPE=34341,s.GL_VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,s.GL_VERTEX_ATTRIB_ARRAY_POINTER=34373,s.GL_VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,s.GL_IMPLEMENTATION_COLOR_READ_TYPE=35738,s.GL_IMPLEMENTATION_COLOR_READ_FORMAT=35739,s.GL_COMPILE_STATUS=35713,s.GL_INFO_LOG_LENGTH=35716,s.GL_SHADER_SOURCE_LENGTH=35720,s.GL_SHADER_COMPILER=36346,s.GL_SHADER_BINARY_FORMATS=36344,s.GL_NUM_SHADER_BINARY_FORMATS=36345,s.GL_LOW_FLOAT=36336,s.GL_MEDIUM_FLOAT=36337,s.GL_HIGH_FLOAT=36338,s.GL_LOW_INT=36339,s.GL_MEDIUM_INT=36340,s.GL_HIGH_INT=36341,s.GL_FRAMEBUFFER=36160,s.GL_RENDERBUFFER=36161,s.GL_RGBA4=32854,s.GL_RGB5_A1=32855,s.GL_RGB565=36194,s.GL_DEPTH_COMPONENT16=33189,s.GL_STENCIL_INDEX=6401,s.GL_STENCIL_INDEX8=36168,s.GL_RENDERBUFFER_WIDTH=36162,s.GL_RENDERBUFFER_HEIGHT=36163,s.GL_RENDERBUFFER_INTERNAL_FORMAT=36164,s.GL_RENDERBUFFER_RED_SIZE=36176,s.GL_RENDERBUFFER_GREEN_SIZE=36177,s.GL_RENDERBUFFER_BLUE_SIZE=36178,s.GL_RENDERBUFFER_ALPHA_SIZE=36179,s.GL_RENDERBUFFER_DEPTH_SIZE=36180,s.GL_RENDERBUFFER_STENCIL_SIZE=36181,s.GL_FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,s.GL_FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,s.GL_FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,s.GL_FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,s.GL_COLOR_ATTACHMENT0=36064,s.GL_DEPTH_ATTACHMENT=36096,s.GL_STENCIL_ATTACHMENT=36128,s.GL_NONE=0,s.GL_FRAMEBUFFER_COMPLETE=36053,s.GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,s.GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,s.GL_FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,s.GL_FRAMEBUFFER_UNSUPPORTED=36061,s.GL_FRAMEBUFFER_BINDING=36006,s.GL_RENDERBUFFER_BINDING=36007,s.GL_MAX_RENDERBUFFER_SIZE=34024,s.GL_INVALID_FRAMEBUFFER_OPERATION=1286,s.GL_VERTEX_PROGRAM_POINT_SIZE=34370,s.GL_COVERAGE_BUFFER_BIT_NV=32768,s.GL_TEXTURE_MAX_ANISOTROPY_EXT=34046,s.GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047},6493:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=i(1588).default,o=i(3808).default,l=i(1655).default,u=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Material=void 0;var h=function(t){l(i,t);var e=u(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r(this,i),(t=e.call(this)).id=n||"mtl"+ ++i.counter,t}return s(i,[{key:"equals",value:function(t){return t&&(t===this||t.id===this.id&&a(o(i.prototype),"equals",this).call(this,t))}},{key:"copy",value:function(){var t=new i;t.id=this.id;var e,r=n(this.attributes);try{for(r.s();!(e=r.n()).done;){var s=e.value;t.set(s.copy())}}catch(a){r.e(a)}finally{r.f()}return t}}]),i}(i(3497).Attributes);e.Material=h,h.counter=0},8261:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Mesh3D=e.VertexDataType=void 0;var s=i(2691),a=i(3192),o=i(2668),l=i(2738),u=i(1116),h=i(9203),c=i(4955),f=i(8877);!function(t){t[t.VertexArray=0]="VertexArray",t[t.VertexBufferObject=1]="VertexBufferObject",t[t.VertexBufferObjectSubData=2]="VertexBufferObjectSubData",t[t.VertexBufferObjectWithVAO=3]="VertexBufferObjectWithVAO"}(e.VertexDataType||(e.VertexDataType={}));var d=function(){function t(e,i,r,s,a,l){n(this,t),this.gl=e,this.autoBind=!0,this.isInstanced=!1,this.tmpV=new o.Vector3,this.vertices=this.makeVertexBuffer(i,s,l),this.indices=new c.IndexBufferObject(e,a,r),this.isVertexArray=!1,t.addManagedMesh(this)}return r(t,[{key:"Mesh",value:function(e,i,n){this.vertices=e,this.indices=i,this.isVertexArray=n,t.addManagedMesh(this)}},{key:"makeVertexBuffer",value:function(t,e,i){return new f.VertexBufferObject(this.gl,t,e,i)}},{key:"setVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return i<0&&(i=t.length),this.vertices.setVertices(t,e,t.length),this}},{key:"updateVertices",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return n<0&&(n=e.length),this.vertices.updateVertices(t,e,i,n),this}},{key:"getVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.getNumVertices()*this.getVertexSize()/4;if(-1===i&&(i=r-e)>t.length-n&&(i=t.length-n),e<0||i<=0||e+i>r||n<0||n>=t.length)throw new Error("index out of bound");if(t.length-n<i)throw new Error("not enough room in vertices array, has "+t.length+" floats, needs "+i);for(var s=this.vertices.getBuffer(),a=e;a<i;a++)t[a]=s.at(a-e+n);return t}},{key:"setIndices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length;return this.indices.setIndices(t,e,i),this}},{key:"getIndices",value:function(t,e,i,n){var r=this.getNumIndices();if(e<0&&(e=r-t),t<0||t>=r||t+e>r)throw new Error("Invalid range specified, offset: "+t+", count: "+e+", max: "+r);if(i.length-n<e)throw new Error("not enough room in indices array, has "+i.length+" shorts, needs "+e);for(var s=this.indices.getBuffer(),a=t;a<e;a++)i[a]=s.at(a-t+n)}},{key:"getNumIndices",value:function(){return this.indices.getNumIndices()}},{key:"getNumVertices",value:function(){return this.vertices.getNumVertices()}},{key:"getMaxVertices",value:function(){return this.vertices.getNumMaxVertices()}},{key:"getMaxIndices",value:function(){return this.indices.getNumMaxIndices()}},{key:"getVertexSize",value:function(){return this.vertices.getAttributes().vertexSize}},{key:"setAutoBind",value:function(t){this.autoBind=t}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.vertices.bind(t,e),this.indices.getNumIndices()>0&&this.indices.bind()}},{key:"unbind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.vertices.unbind(t,e),this.indices.getNumIndices()>0&&this.indices.unbind()}},{key:"render",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.autoBind;if(n<0&&(n=this.indices.getNumMaxIndices()>0?this.getNumIndices():this.getNumVertices()),0!==n){if(r&&this.bind(t),this.isVertexArray)this.indices.getNumIndices()>0?this.gl.drawElements(e,n,h.GL20.GL_UNSIGNED_SHORT,2*i):this.gl.drawArrays(e,i,n);else if(this.indices.getNumIndices()>0){if(n+i>this.indices.getNumMaxIndices())throw new Error("Mesh attempting to access memory outside of the index buffer (count: "+n+", offset: "+i+", max: "+this.indices.getNumMaxIndices()+")");this.gl.drawElements(e,n,h.GL20.GL_UNSIGNED_SHORT,2*i)}else this.gl.drawArrays(e,i,n);r&&this.unbind(t)}}},{key:"dispose",value:function(){var e=t.meshes.indexOf(this);e>-1&&t.meshes.splice(e,1),this.vertices.dispose(),this.indices.dispose()}},{key:"getVertexAttribute",value:function(t){for(var e=this.vertices.getAttributes(),i=e.size(),n=0;n<i;n++)if(e.get(n).usage===t)return e.get(n);return null}},{key:"getVertexAttributes",value:function(){return this.vertices.getAttributes()}},{key:"getVerticesBuffer",value:function(){return this.vertices.getBuffer()}},{key:"calculateBoundingBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t||(t=new s.BoundingBox);var e=this.getNumVertices();if(0===e)throw new Error("No vertices defined");var i=this.vertices.getBuffer();t.inf();var n=this.getVertexAttribute(l.Usage.Position),r=n.offset/4,a=this.vertices.getAttributes().vertexSize/4,o=r;switch(n.numComponents){case 1:for(var u=0;u<e;u++)t.ext(i[o],0,0),o+=a;break;case 2:for(var h=0;h<e;h++)t.ext(i[o],i[o+1],0),o+=a;break;case 3:for(var c=0;c<e;c++)t.ext(i[o],i[o+1],i[o+2]),o+=a}}},{key:"extendBoundingBox",value:function(t,e,i,n){var r=this.getNumIndices(),s=this.getNumVertices(),a=0===r?s:r;if(e<0||i<1||e+i>a)throw new Error("Invalid part specified ( offset="+e+", count="+i+", max="+a+" )");var o=this.vertices.getBuffer(),u=this.indices.getBuffer(),h=this.getVertexAttribute(l.Usage.Position),c=h.offset/4,f=this.vertices.getAttributes().vertexSize/4,d=e+i;switch(h.numComponents){case 1:if(r>0)for(var v=e;v<d;v++){var p=(65535&u[v])*f+c;this.tmpV.set(o[p],0,0),n&&this.tmpV.multiply(n),t.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}else for(var g=e;g<d;g++){var m=g*f+c;this.tmpV.set(o[m],0,0),n&&this.tmpV.multiply(n),t.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}break;case 2:if(r>0)for(var y=e;y<d;y++){var M=(65535&u[y])*f+c;this.tmpV.set(o[M],o[M+1],0),n&&this.tmpV.multiply(n),t.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}else for(var x=e;x<d;x++){var b=x*f+c;this.tmpV.set(o[b],o[b+1],0),n&&this.tmpV.multiply(n),t.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}break;case 3:if(r>0)for(var w=e;w<d;w++){var _=(65535&u[w])*f+c;this.tmpV.set(o[_],o[_+1],o[_+2]),n&&this.tmpV.multiply(n),t.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}else for(var T=e;T<d;T++){var A=T*f+c;this.tmpV.set(o[A],o[A+1],o[A+2]),n&&this.tmpV.multiply(n),t.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}}return t}},{key:"calculateRadiusSquared",value:function(t,e,i,n,r,s){var a=this.getNumIndices();if(n<0||r<1||n+r>a)throw new Error("Not enough indices");var u=this.vertices.getBuffer(),h=this.indices.getBuffer(),c=this.getVertexAttribute(l.Usage.Position),f=c.offset/4,d=this.vertices.getAttributes().vertexSize/4,v=n+r,p=0;switch(c.numComponents){case 1:for(var g=n;g<v;g++){var m=(65535&h[g])*d+f;this.tmpV.set(u[m],0,0),s&&this.tmpV.multiply(s);var y=this.tmpV.sub(new o.Vector3(t,e,i)).length2();y>p&&(p=y)}break;case 2:for(var M=n;M<v;M++){var x=(65535&h[M])*d+f;this.tmpV.set(u[M],u[x+1],0),s&&this.tmpV.multiply(s);var b=this.tmpV.sub(new o.Vector3(t,e,i)).length2();b>p&&(p=b)}break;case 3:for(var w=n;w<v;w++){var _=(65535&h[w])*d+f;this.tmpV.set(u[w],u[_+1],u[_+2]),s&&this.tmpV.multiply(s);var T=this.tmpV.sub(new o.Vector3(t,e,i)).length2();T>p&&(p=T)}}return p}},{key:"calculateRadius",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getNumIndices(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return Math.sqrt(this.calculateRadiusSquared(t,e,i,n,r,s))}},{key:"getIndicesBuffer",value:function(){return this.indices.getBuffer()}},{key:"scale",value:function(t,e,i){var n=this.getVertexAttribute(l.Usage.Position),r=n.offset/4,s=n.numComponents,a=this.getNumVertices(),o=this.getVertexSize()/4,u=new Array(a*o);this.getVertices(u);var h=r;switch(s){case 1:for(var c=0;c<a;c++)u[h]*=t,h+=o;break;case 2:for(var f=0;f<a;f++)u[h]*=t,u[h+1]*=e,h+=o;break;case 3:for(var d=0;d<a;d++)u[h]*=t,u[h+1]*=e,u[h+2]*=i,h+=o}this.setVertices(u)}},{key:"transform",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getNumIndices(),r=this.getVertexAttribute(l.Usage.Position),s=r.offset/4,a=this.getVertexSize()/4,o=r.numComponents,u=new Array(n*a);this.getVertices(u,i*a,n*a),t.transform(e,u,a,s,o,0,n),this.updateVertices(i*a,u)}},{key:"transformUV",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getNumVertices(),r=this.getVertexAttribute(l.Usage.TextureCoordinates),s=r.offset/4,a=this.getVertexSize()/4,o=this.getNumVertices(),u=new Array(o*a);this.getVertices(u,0,u.length),t.transformUV(e,u,a,s,i,n),this.setVertices(u,0,u.length)}},{key:"copy",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getVertexSize()/4,s=this.getNumVertices(),a=new Array(s*r);this.getVertices(a,0,a.length);var o=null,l=null,h=0;if(n){for(var c=0,f=0,d=0;d<n.length;d++)this.getVertexAttribute(n[d])&&(c+=this.getVertexAttribute(n[d]).numComponents,f++);if(c>0){l=new Array(f),o=new Array(c);for(var v=-1,p=-1,g=0;g<n.length;g++){var m=this.getVertexAttribute(n[g]);if(m){for(var y=0;y<m.numComponents;y++)o[++v]=m.offset+y;l[++p]=m.copy(),h+=m.numComponents}}}}if(!o){o=new Array(r);for(var M=0;M<r;M++)o[M]=M;h=r}var x,b=this.getNumIndices(),w=null;if(b>0&&(w=new Array(b),this.getIndices(0,-1,w,0),i||h!==r)){for(var _=new Array(a.length),T=0,A=0;A<b;A++){var k=w[A]*r,L=-1;if(i)for(var S=0;S<T&&L<0;S++){for(var E=S*h,C=!0,P=0;P<o.length&&C;P++)_[E+P]!==a[k+o[P]]&&(C=!1);C&&(L=S)}if(L>0)w[A]=L;else{for(var R=T*h,I=0;I<o.length;I++)_[R+I]=a[k+o[I]];w[A]=T,T++}}a=_,s=T}return(x=new t(this.gl,e,e,s,w?w.length:0,l?new u.VertexAttributes(l):this.getVertexAttributes())).setVertices(a,0,s*h),w&&x.setIndices(w),x}}],[{key:"addManagedMesh",value:function(e){t.meshes||(t.meshes=new Array),t.meshes.push(e)}},{key:"invalidateAllMeshes",value:function(){if(t.meshes)for(var e=0;e<t.meshes.length;e++)t.meshes[e].vertices.invalidate(),t.meshes[e].indices.invalidate()}},{key:"clearAllMeshes",value:function(){t.meshes.length=0}},{key:"transform",value:function(t,e,i,n,r,s,a){if(n<0||r<1||n+r>i)throw new Error;if(s<0||a<1||(s+a)*i>e.length)throw new Error("start = "+s+", count = "+a+", vertexSize = "+i+", length = "+e.length);var l=new o.Vector3,u=n+s*i;switch(r){case 1:for(var h=0;h<a;h++)l.set(e[u],0,0).multiply(t),e[u]=l.x,u+=i;break;case 2:for(var c=0;c<a;c++)l.set(e[u],e[u+1],0).multiply(t),e[u]=l.x,e[u+1]=l.y,u+=i;break;case 3:for(var f=0;f<a;f++)l.set(e[u],e[u+1],e[u+2]).multiply(t),e[u]=l.x,e[u+1]=l.y,e[u+2]=l.z,u+=i}}},{key:"transformUV",value:function(t,e,i,n,r,s){if(r<0||s<1||(r+s)*i>e.length)throw new Error("start = "+r+", count = "+s+", vertexSize = "+i+", length = "+e.length);for(var o=new a.Vector2,l=n+r*i,u=0;u<s;u++)o.set(e[l],e[l+1]).mul(t),e[l]=o.x,e[l+1]=o.y,l+=i}}]),t}();e.Mesh3D=d,d.meshes=[]},6715:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1588).default,a=i(3808).default,o=i(1655).default,l=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelBatch=void 0;var u=i(8637),h=i(4569),c=i(143),f=i(138),d=i(4485),v=i(5841),p=function(t){o(i,t);var e=l(i);function i(){return n(this,i),e.apply(this,arguments)}return r(i,[{key:"obtain",value:function(){var t=s(a(i.prototype),"obtain",this).call(this);return t.environment=null,t.material=null,t.meshPart.set("",null,0,0,0),t.shader=null,t}}]),i}(u.FlushablePool),g=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,t),this.camera=null,this.renderablesPool=new p((function(){return new d.Renderable})),this.renderables=[],this.context=null,this.shaderProvider=null,this.sorter=null,this.sorter=r||new h.DefaultRenderableSorter,this.ownContext=!i,this.context=i||new v.RenderContext(new f.DefaultTextureBinder(e,f.DefaultTextureBinder.LRU,1)),this.shaderProvider=this.shaderProvider?this.shaderProvider:new c.DefaultShaderProvider(e)}return r(t,[{key:"dispose",value:function(){this.shaderProvider.dispose()}},{key:"begin",value:function(t){if(this.camera)throw new Error("Call end() first.");this.camera=t,this.ownContext&&this.context.begin()}},{key:"setCamera",value:function(t){if(!this.camera)throw new Error("Call begin() first.");this.renderables.length>0&&this.flush(),this.camera=t}},{key:"getCamera",value:function(){return this.camera}},{key:"ownsRenderContext",value:function(){return this.ownContext}},{key:"getRenderContext",value:function(){return this.context}},{key:"getRenderableSorter",value:function(){return this.sorter}},{key:"flush",value:function(){this.sorter.sort(this.camera,this.renderables);for(var t=null,e=0;e<this.renderables.length;e++){var i=this.renderables[e];t!==i.shader&&(t&&t.end(),(t=i.shader).begin(this.camera,this.context)),t.render(i)}t&&t.end(),this.renderablesPool.flush(),this.renderables.length=0}},{key:"end",value:function(){this.flush(),this.ownContext&&this.context.end(),this.camera=null}},{key:"renderWithRenderable",value:function(t){t.shader=this.shaderProvider.getShader(t),this.renderables.push(t)}},{key:"render",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.renderables.length;t.getRenderables(this.renderables,this.renderablesPool);for(var n=i;n<this.renderables.length;n++){var r=this.renderables[n];e&&(r.environment=e),r.shader=this.shaderProvider.getShader(r)}}}]),t}();e.ModelBatch=g},3250:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelInstance=void 0;var a=i(5474),o=i(8497),l=i(9862),u=i(1195),h=i(1589),c=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r(this,t),this.materials=[],this.nodes=[],this.animations=[],this.model=e,this.transform=i||new a.Matrix4,n?this.copyNodes(e.nodes,n):this.copyNodes(e.nodes),this.copyAnimations(e.animations,t.defaultShareKeyframes),this.calculateTransforms()}return s(t,[{key:"copyNodes",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=0,r=t.length;i<r;++i){var s=t[i];if(e){var a,o=n(e);try{for(o.s();!(a=o.n()).done;){var l=a.value;if(l===s.id){this.nodes.push(s.copy());break}}}catch(u){o.e(u)}finally{o.f()}}else this.nodes.push(s.copy())}this.invalidate()}},{key:"invalidateNode",value:function(t){for(var e=this,i=function(i,n){var r=t.parts[i],s=r.invBoneBindTransforms;if(s)for(var a=0;a<s.size;++a)s.keys[a]=e.getNode(s.keys[a].id);if(!e.materials.includes(r.material)){var o=e.materials.findIndex((function(t){return t.id===r.material.id}));o<0?e.materials.push(r.material=r.material.copy()):r.material=e.materials[o]}},n=0,r=t.parts.length;n<r;++n)i(n);for(var s=0,a=t.getChildCount();s<a;++s)this.invalidateNode(t.getChildByIndex(s))}},{key:"getNode",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l.Node.getNode(this.nodes,t,e,i)}},{key:"invalidate",value:function(){for(var t=0,e=this.nodes.length;t<e;++t)this.invalidateNode(this.nodes[t])}},{key:"copyAnimations",value:function(t,e){var i,r=n(t);try{for(r.s();!(i=r.n()).done;){var s=i.value;this.copyAnimation(s,e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"copyAnimation",value:function(t,e){var i=new o.Animation3D;i.id=t.id,i.duration=t.duration;var r,s=n(t.nodeAnimations);try{for(s.s();!(r=s.n()).done;){var a=r.value,l=this.getNode(a.node.id);if(l){var c=new u.NodeAnimation;if(c.node=l,e)c.translation=a.translation,c.rotation=a.rotation,c.scaling=a.scaling;else{if(a.translation){c.translation=new Array;var f,d=n(a.translation);try{for(d.s();!(f=d.n()).done;){var v=f.value;c.translation.push(new h.NodeKeyframe(v.keytime,v.value))}}catch(b){d.e(b)}finally{d.f()}}if(a.rotation){c.rotation=new Array;var p,g=n(a.rotation);try{for(g.s();!(p=g.n()).done;){var m=p.value;c.rotation.push(new h.NodeKeyframe(m.keytime,m.value))}}catch(b){g.e(b)}finally{g.f()}}if(a.scaling){c.scaling=new Array;var y,M=n(a.scaling);try{for(M.s();!(y=M.n()).done;){var x=y.value;c.scaling.push(new h.NodeKeyframe(x.keytime,x.value))}}catch(b){M.e(b)}finally{M.f()}}}(c.translation||c.rotation||c.scaling)&&i.nodeAnimations.push(c)}}}catch(b){s.e(b)}finally{s.f()}i.nodeAnimations.length>0&&this.animations.push(i)}},{key:"getRenderable",value:function(t,e,i){return i.setRenderable(t),!i.bones&&this.transform?t.worldTransform.set(this.transform.values).multiply(e.globalTransform):this.transform?t.worldTransform.set(this.transform.values):t.worldTransform.idt(),t}},{key:"getRenderables",value:function(t,e){var i,r=n(this.nodes);try{for(r.s();!(i=r.n()).done;){var s=i.value;this.getRenderablesWithNode(s,t,e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"getRenderablesWithNode",value:function(t,e,i){if(t.parts.length>0){var r,s=n(t.parts);try{for(s.s();!(r=s.n()).done;){var a=r.value;a.enabled&&e.push(this.getRenderable(i.obtain(),t,a))}}catch(h){s.e(h)}finally{s.f()}}var o,l=n(t.getChildren());try{for(l.s();!(o=l.n()).done;){var u=o.value;this.getRenderablesWithNode(u,e,i)}}catch(h){l.e(h)}finally{l.f()}}},{key:"calculateTransforms",value:function(){for(var t=this.nodes.length,e=0;e<t;e++)this.nodes[e].calculateTransforms(!0);for(var i=0;i<t;i++)this.nodes[i].calculateBoneTransforms(!0)}},{key:"calculateBoundingBox",value:function(t){return t.inf(),this.extendBoundingBox(t)}},{key:"extendBoundingBox",value:function(t){for(var e=this.nodes.length,i=0;i<e;i++)this.nodes[i].extendBoundingBox(t);return t}},{key:"getAnimation",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.animations.length;if(i){for(var r=0;r<n;r++)if((e=this.animations[r]).id.toUpperCase()===t.toUpperCase())return e}else for(var s=0;s<n;s++)if((e=this.animations[s]).id===t)return e;return null}},{key:"getMaterial",value:function(t){var e,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.materials.length;if(i){for(var r=0;r<n;r++)if((e=this.materials[r]).id.toUpperCase()===t.toUpperCase())return e}else for(var s=0;s<n;s++)if((e=this.materials[s]).id===t)return e;return null}}]),t}();e.ModelInstance=c,c.defaultShareKeyframes=!0},9219:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.PerspectiveCamera=void 0;var s=i(5474),a=i(2668),o=i(365),l=function(){function t(e,i,r){n(this,t),this.far=100,this.near=1,this.fieldOfView=67,this.viewportWidth=0,this.viewportHeight=0,this.up=new a.Vector3(0,1,0),this.position=new a.Vector3(0,0,0),this.direction=new a.Vector3(0,0,-1),this.view=new s.Matrix4,this.combined=new s.Matrix4,this.projection=new s.Matrix4,this.invProjectionView=new s.Matrix4,this.frustum=new o.Frustum,this.tmp=new a.Vector3,this.tmpVec=new a.Vector3,this.fieldOfView=e,this.viewportWidth=i,this.viewportHeight=r,this.update()}return r(t,[{key:"update",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.viewportWidth/this.viewportHeight;this.projection.projection(Math.abs(this.near),Math.abs(this.far),this.fieldOfView,e),this.tmp.set(this.position.x,this.position.y,this.position.z),this.tmp.add(this.direction),this.view.setToLookAt(this.position,this.tmp,this.up),this.combined.set(this.projection.values),this.combined.multiply(this.view),t&&(this.invProjectionView.set(this.combined.values),this.invProjectionView.invert(),this.frustum.update(this.invProjectionView))}},{key:"lookAt",value:function(t,e,i){if(this.tmpVec.set(t,e,i).sub(this.position).normalize(),!this.tmpVec.isZero()){var n=this.tmpVec.dot(this.up);Math.abs(n-1)<1e-9?this.up.set(this.direction.x,this.direction.y,this.direction.z).scale(-1):Math.abs(n+1)<1e-9&&this.up.set(this.direction.x,this.direction.y,this.direction.z),this.direction.set(this.tmpVec.x,this.tmpVec.y,this.tmpVec.z),this.normalizeUp()}}},{key:"normalizeUp",value:function(){this.tmpVec.set(this.direction.x,this.direction.y,this.direction.z).cross(this.up),this.up.set(this.tmpVec.x,this.tmpVec.y,this.tmpVec.z).cross(this.direction).normalize()}},{key:"translate",value:function(t){this.position.add(t)}},{key:"rotate",value:function(t,e){this.direction.rotate(t,e),this.up.rotate(t,e)}},{key:"rotateAround",value:function(t,e,i){this.tmpVec.set(t.x,t.y,t.z),this.tmpVec.sub(this.position),this.translate(this.tmpVec),this.rotate(e,i),this.tmpVec.rotate(e,i),this.translate(new a.Vector3(-this.tmpVec.x,-this.tmpVec.y,-this.tmpVec.z)),this.update()}}]),t}();e.PerspectiveCamera=l},5841:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.RenderContext=void 0;var s=i(138),a=function(){function t(e){n(this,t),this.textureBinder=e,this.gl=s.DefaultTextureBinder.gl}return r(t,[{key:"begin",value:function(){this.gl.disable(this.gl.DEPTH_TEST),this.depthFunc=0,this.gl.depthMask(!0),this.depthMask=!0,this.gl.disable(this.gl.BLEND),this.blending=!1,this.gl.disable(this.gl.CULL_FACE),this.cullFace=this.blendSFactor=this.blendDFactor=0,this.textureBinder.begin()}},{key:"end",value:function(){0!==this.depthFunc&&this.gl.disable(this.gl.DEPTH_TEST),this.depthMask||this.gl.depthMask(!0),this.blending&&this.gl.disable(this.gl.BLEND),this.cullFace>0&&this.gl.disable(this.gl.CULL_FACE),this.textureBinder.end()}},{key:"setDepthMask",value:function(t){this.depthMask!==t&&this.gl.depthMask(this.depthMask=t)}},{key:"setDepthTest",value:function(t,e,i){var n=0!==this.depthFunc,r=0!==t;this.depthFunc!==t&&(this.depthFunc=t,r?(this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(t)):this.gl.disable(this.gl.DEPTH_TEST)),r&&(n&&this.depthFunc===t||this.gl.depthFunc(this.depthFunc=t),n&&this.depthRangeNear===e&&this.depthRangeFar===i||this.gl.depthRange(this.depthRangeNear=e,this.depthRangeFar=i))}},{key:"setBlending",value:function(t,e,i){t!==this.blending&&(this.blending=t,t?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND)),!t||this.blendSFactor===e&&this.blendDFactor===i||(this.gl.blendFunc(e,i),this.blendSFactor=e,this.blendDFactor=i)}},{key:"setCullFace",value:function(t){t!==this.cullFace&&(this.cullFace=t,t===this.gl.FRONT||t===this.gl.BACK||t===this.gl.FRONT_AND_BACK?(this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(t)):this.gl.disable(this.gl.CULL_FACE))}}]),t}();e.RenderContext=a},4485:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Renderable=void 0;var s=i(5474),a=i(685),o=function(){function t(){n(this,t),this.worldTransform=new s.Matrix4,this.meshPart=new a.MeshPart,this.bones=null}return r(t,[{key:"set",value:function(t){return this.worldTransform.set(t.worldTransform.values),this.material=t.material,this.meshPart.setByMeshPart(t.meshPart),this.bones=t.bones,this.environment=t.environment,this.shader=t.shader,this}}]),t}();e.Renderable=o},158:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Attribute=void 0;var s=function(){function t(){n(this,t)}return r(t,[{key:"setType",value:function(t){this.type=t,this.typeBit=this.numberOfTrailingZeros(t)}},{key:"hashCode",value:function(){return 7489*this.typeBit}},{key:"equals",value:function(t){return!!t&&(t===this||!!t&&(this.type===t.type&&t.hashCode()===this.hashCode()))}},{key:"numberOfTrailingZeros",value:function(t){var e,i;if(0===t)return 64;var n=63;return 0!==(i=t)?(n-=32,e=i):e=t>>>32,0!==(i=e<<16)&&(n-=16,e=i),0!==(i=e<<8)&&(n-=8,e=i),0!==(i=e<<4)&&(n-=4,e=i),0!==(i=e<<2)&&(n-=2,e=i),n-(e<<1>>>31)}},{key:"toString",value:function(){return t.getAttributeAlias(this.type)}},{key:"copy",value:function(){return new t}}],[{key:"getAttributeType",value:function(e){for(var i=0;i<t.types.length;i++)if(t.types[i]===e)return 1<<i;return 0}},{key:"getAttributeAlias",value:function(e){for(var i=-1;0!==e&&++i<63&&0===(e>>i&1););return i>=0&&i<t.types.length?t.types[i]:null}},{key:"register",value:function(e){var i=this.getAttributeType(e);return i>0?i:(t.types.push(e),1<<t.types.length-1)}}]),t}();e.Attribute=s,s.types=[]},3497:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Attributes=void 0;var a=function(){function t(){r(this,t),this.attributes=[],this.sorted=!0}return s(t,[{key:"getMask",value:function(){return this.mask}},{key:"get",value:function(t){var e,i=n(this.attributes);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r.type===t)return r}}catch(s){i.e(s)}finally{i.f()}return null}},{key:"getArrayAttribute",value:function(t,e){var i,r=n(this.attributes);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.type===e&&t.push(s)}}catch(a){r.e(a)}finally{r.f()}return t}},{key:"clear",value:function(){this.mask=0,this.attributes=[]}},{key:"size",value:function(){return this.attributes.length}},{key:"enable",value:function(t){this.mask|=t}},{key:"disable",value:function(t){this.mask&=~t}},{key:"set",value:function(t){var e=this.indexOf(t.type);e<0?(this.enable(t.type),this.attributes.push(t),this.sorted=!1):this.attributes[e]=t}},{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(t){var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.set(r)}}catch(s){i.e(s)}finally{i.f()}}},{key:"has",value:function(t){return 0!==t&&(this.mask&t)===t}},{key:"indexOf",value:function(t){if(this.has(t))for(var e=0;e<this.attributes.length;e++)if(this.attributes[e].type===t)return e;return-1}},{key:"set2Attributes",value:function(t,e){this.set(t),this.set(e)}},{key:"set3Attributes",value:function(t,e,i){this.set(t),this.set(e),this.set(i)}},{key:"set4Attributes",value:function(t,e,i,n){this.set(t),this.set(e),this.set(i),this.set(n)}},{key:"setArrayAttribute",value:function(t){var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.set(r)}}catch(s){i.e(s)}finally{i.f()}}},{key:"setAttribute",value:function(t){this.set(t)}},{key:"remove",value:function(t){for(var e=this.attributes.length-1;e>=0;e--){var i=this.attributes[e].type;(t&i)===i&&(this.attributes.splice(e,1),this.disable(i),this.sorted=!1)}}},{key:"compare",value:function(t,e){return t.type-e.type}},{key:"same",value:function(t,e){if(t===this)return!0;if(!t||this.mask!==t.mask)return!1;if(!e)return!0;for(var i=0;i<this.attributes.length;i++)if(!this.attributes[i].equals(t.attributes[i]))return!1;return!0}},{key:"equals",value:function(t){return!!t&&(t===this||this.same(t,!0))}}]),t}();e.Attributes=a},8213:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BlendingAttribute=void 0;var l=i(9203),u=function(t){a(i,t);var e=o(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.GL20.GL_SRC_ALPHA,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.GL20.GL_ONE_MINUS_SRC_ALPHA,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return r(this,i),(t=e.call(this)).opacity=1,t.setType(t.type),t.blended=a,t.sourceFunction=n,t.destFunction=s,t.opacity=o,t}return s(i,[{key:"set",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.GL20.GL_SRC_ALPHA,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.GL20.GL_ONE_MINUS_SRC_ALPHA,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.type=i.Type,this.typeBit=this.numberOfTrailingZeros(this.type),this.blended=t,this.sourceFunction=e,this.destFunction=n,this.opacity=r}}],[{key:"is",value:function(t){return(t&this.Type)===t}}]),i}(i(158).Attribute);e.BlendingAttribute=u,n=u,u.Alias="blended",u.Type=n.register(n.Alias)},4325:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ColorAttribute3D=void 0;var l=i(8637),u=function(t){a(i,t);var e=o(i);function i(t,n){var s;return r(this,i),(s=e.call(this)).color=new l.Color,s.setType(t),n&&s.color.set(n.r,n.g,n.b,n.a),s}return s(i,[{key:"copy",value:function(){return new i(this.type,this.color)}}],[{key:"is",value:function(t){return 0!==(t&this.Mask)}},{key:"createAmbient",value:function(t){return new i(i.Ambient,t)}},{key:"createDiffuse",value:function(t){return new i(i.Diffuse,t)}},{key:"createSpecular",value:function(t){return new i(i.Specular,t)}},{key:"createReflection",value:function(t){return new i(i.Reflection,t)}},{key:"createEmissive",value:function(t){return new i(i.Emissive,t)}},{key:"createAmbientLight",value:function(t){return new i(i.AmbientLight,t)}},{key:"createFog",value:function(t){return new i(i.Fog,t)}}]),i}(i(158).Attribute);e.ColorAttribute3D=u,n=u,u.DiffuseAlias="diffuseColor",u.Diffuse=n.register(u.DiffuseAlias),u.SpecularAlias="specularColor",u.Specular=n.register(u.SpecularAlias),u.AmbientAlias="ambientColor",u.Ambient=n.register(u.AmbientAlias),u.EmissiveAlias="emissiveColor",u.Emissive=n.register(u.EmissiveAlias),u.ReflectionAlias="reflectionColor",u.Reflection=n.register(u.ReflectionAlias),u.AmbientLightAlias="ambientLightColor",u.AmbientLight=n.register(u.AmbientLightAlias),u.FogAlias="fogColor",u.Fog=n.register(u.FogAlias),u.Mask=n.Ambient|n.Diffuse|n.Specular|n.Emissive|n.Reflection|n.AmbientLight|n.Fog},6730:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.DirectionalLightsAttribute=void 0;var l=function(t){a(i,t);var e=o(i);function i(){var t;return r(this,i),(t=e.call(this)).setType(i.Type),t.lights=new Array,t}return s(i,[{key:"set",value:function(t){for(var e=0;e<t.lights.length;e++)this.lights[e]=t.lights[e]}},{key:"copy",value:function(){var t=new i;return t.set(this),t}},{key:"compareTo",value:function(t){return this.type!==t.type?this.type<t.type?-1:1:0}}],[{key:"is",value:function(t){return(t&i.Type)===t}}]),i}(i(158).Attribute);e.DirectionalLightsAttribute=l,n=l,l.Alias="directionalLights",l.Type=n.register(l.Alias)},1759:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.FloatAttribute=void 0;var l=function(t){a(i,t);var e=o(i);function i(t,n){var s;return r(this,i),(s=e.call(this)).setType(t),s.value=n,s}return s(i,[{key:"copy",value:function(){return new i(this.type,this.value)}}],[{key:"createShininess",value:function(t){return new i(i.Shininess,t)}},{key:"createAlphaTest",value:function(t){return new i(i.AlphaTest,t)}}]),i}(i(158).Attribute);e.FloatAttribute=l,n=l,l.ShininessAlias="shininess",l.Shininess=n.register(n.ShininessAlias),l.AlphaTestAlias="alphaTest",l.AlphaTest=n.register(l.AlphaTestAlias)},737:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.IntAttribute=void 0;var l=function(t){a(i,t);var e=o(i);function i(t){var n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r(this,i),(n=e.call(this)).setType(t),n.value=s,n}return s(i,[{key:"copy",value:function(){return new i(this.type,this.value)}}],[{key:"createCullFace",value:function(t){return new i(i.CullFace,t)}}]),i}(i(158).Attribute);e.IntAttribute=l,n=l,l.CullFaceAlias="cullface",l.CullFace=n.register(l.CullFaceAlias)},1686:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.PointLightsAttribute=void 0;var l=function(t){a(i,t);var e=o(i);function i(){var t;return r(this,i),(t=e.call(this)).setType(i.Type),t.lights=new Array,t}return s(i,[{key:"set",value:function(t){for(var e=0;e<t.lights.length;e++)this.lights[e]=t.lights[e]}},{key:"copy",value:function(){var t=new i;return t.set(this),t}},{key:"compareTo",value:function(t){return this.type!==t.type?this.type<t.type?-1:1:0}}],[{key:"is",value:function(t){return(t&i.Type)===t}}]),i}(i(158).Attribute);e.PointLightsAttribute=l,n=l,l.Alias="pointLights",l.Type=n.register(l.Alias)},5362:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.SpotLightsAttribute=void 0;var l=function(t){a(i,t);var e=o(i);function i(){var t;return r(this,i),(t=e.call(this)).setType(i.Type),t.lights=new Array,t}return s(i,[{key:"set",value:function(t){for(var e=0;e<t.lights.length;e++)this.lights[e]=t.lights[e]}},{key:"copy",value:function(){var t=new i;return t.set(this),t}},{key:"compareTo",value:function(t){return this.type!==t.type?this.type<t.type?-1:1:0}}],[{key:"is",value:function(t){return(t&i.Type)===t}}]),i}(i(158).Attribute);e.SpotLightsAttribute=l,n=l,l.Alias="spotLights",l.Type=n.register(l.Alias)},8737:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.TextureAttribute=void 0;var l=function(t){a(i,t);var e=o(i);function i(t){var n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return r(this,i),(n=e.call(this)).offsetU=0,n.offsetV=0,n.scaleU=1,n.scaleV=1,n.uvIndex=0,n.offsetU=s,n.offsetV=a,n.scaleU=o,n.scaleV=l,n.setType(t),n}return s(i,[{key:"setTextureRegion",value:function(t){this.texture=t.texture,this.offsetU=t.u,this.offsetV=t.v,this.scaleU=t.u2-this.offsetU,this.scaleV=t.v2-this.offsetV}},{key:"setTexture",value:function(t){this.texture=t}},{key:"setOffset",value:function(t,e){this.offsetU=t,this.offsetV=e}},{key:"setScale",value:function(t,e){this.scaleU=t,this.scaleV=e}},{key:"copy",value:function(){var t=new i(this.type);return t.offsetU=this.offsetU,t.offsetV=this.offsetV,t.scaleU=this.scaleU,t.scaleV=this.scaleV,t.uvIndex=this.uvIndex,t.texture=this.texture,t}}],[{key:"is",value:function(t){return 0!==(t&i.Mask)}},{key:"createDiffuse",value:function(t){var e=new i(i.Diffuse);return e.setTextureRegion(t),e}},{key:"createSpecular",value:function(t){var e=new i(i.Specular);return e.setTextureRegion(t),e}},{key:"createNormal",value:function(t){var e=new i(i.Normal);return e.setTextureRegion(t),e}},{key:"createBump",value:function(t){var e=new i(i.Bump);return e.setTextureRegion(t),e}},{key:"createAmbient",value:function(t){var e=new i(i.Ambient);return e.setTextureRegion(t),e}},{key:"createEmissive",value:function(t){var e=new i(i.Emissive);return e.setTextureRegion(t),e}},{key:"createReflection",value:function(t){var e=new i(i.Reflection);return e.setTextureRegion(t),e}}]),i}(i(158).Attribute);e.TextureAttribute=l,n=l,l.DiffuseAlias="diffuseTexture",l.Diffuse=n.register(l.DiffuseAlias),l.SpecularAlias="specularTexture",l.Specular=n.register(l.SpecularAlias),l.BumpAlias="bumpTexture",l.Bump=n.register(l.BumpAlias),l.NormalAlias="normalTexture",l.Normal=n.register(l.NormalAlias),l.AmbientAlias="ambientTexture",l.Ambient=n.register(l.AmbientAlias),l.EmissiveAlias="emissiveTexture",l.Emissive=n.register(l.EmissiveAlias),l.ReflectionAlias="reflectionTexture",l.Reflection=n.register(l.ReflectionAlias),l.Mask=n.Diffuse|n.Specular|n.Bump|n.Normal|n.Ambient|n.Emissive|n.Reflection},2738:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.VertexAttribute3D=e.Usage=void 0;var s=i(6403),a=i(9203),o=n((function t(){r(this,t)}));e.Usage=o,o.Position=1,o.ColorUnpacked=2,o.ColorPacked=4,o.Normal=8,o.TextureCoordinates=16,o.Generic=32,o.BoneWeight=64,o.Tangent=128,o.BiNormal=256;var l=function(){function t(e,i,n,s,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;r(this,t),this.usage=e,this.numComponents=i,this.type=n,this.normalized=s,this.alias=a,this.unit=o,this.usageIndex=this.numberOfTrailingZeros(e)}return n(t,[{key:"copy",value:function(){return new t(this.usage,this.numComponents,this.type,this.normalized,this.alias,this.unit)}},{key:"getKey",value:function(){return(this.usageIndex<<8)+(255&this.unit)}},{key:"numberOfTrailingZeros",value:function(t){for(var e=0,i=5;i<=t;i+=5)for(var n=i;n%5===0;)n/=5,e++;return e}},{key:"getSizeInBytes",value:function(){switch(this.type){case a.GL20.GL_FLOAT:case a.GL20.GL_FIXED:return 4*this.numComponents;case a.GL20.GL_UNSIGNED_BYTE:case a.GL20.GL_BYTE:return this.numComponents;case a.GL20.GL_UNSIGNED_SHORT:case a.GL20.GL_SHORT:return 2*this.numComponents}return 0}},{key:"equals",value:function(t){return!!t&&this.usage===t.usage&&this.numComponents===t.numComponents&&this.type===t.type&&this.normalized===t.normalized&&this.alias===t.alias&&this.unit===t.unit}}],[{key:"Position",value:function(){return new t(o.Position,3,a.GL20.GL_FLOAT,!1,s.Shader.POSITION,0)}},{key:"TexCoords",value:function(e){return new t(o.TextureCoordinates,2,a.GL20.GL_FLOAT,!1,s.Shader.TEXCOORDS+e,e)}},{key:"Normal",value:function(){return new t(o.Normal,3,a.GL20.GL_FLOAT,!1,s.Shader.NORMAL)}},{key:"ColorPacked",value:function(){return new t(o.ColorPacked,4,a.GL20.GL_UNSIGNED_BYTE,!0,s.Shader.COLOR)}},{key:"ColorUnpacked",value:function(){return new t(o.ColorUnpacked,4,a.GL20.GL_FLOAT,!1,s.Shader.COLOR)}},{key:"Tangent",value:function(){return new t(o.Tangent,3,a.GL20.GL_FLOAT,!1,s.Shader.TANGENT)}},{key:"Binormal",value:function(){return new t(o.BiNormal,3,a.GL20.GL_FLOAT,!1,s.Shader.BINORMAL)}},{key:"BoneWeight",value:function(e){return new t(o.BoneWeight,2,a.GL20.GL_FLOAT,!1,s.Shader.BONEWEIGHT+e,e)}}]),t}();e.VertexAttribute3D=l},1116:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.VertexAttributes=void 0;var a=function(){function t(e){if(r(this,t),this.mask=-1,0===e.length)throw new Error("attributes must be >= 1");for(var i=[],n=0;n<e.length;n++)i[n]=e[n];this.attributes=i,this.vertexSize=this.calculateOffsets()}return s(t,[{key:"getOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.findByUsage(t);return i?i.offset/4:e}},{key:"findByUsage",value:function(t){var e,i=n(this.attributes);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r.usage===t)return r}}catch(s){i.e(s)}finally{i.f()}return null}},{key:"calculateOffsets",value:function(){for(var t=0,e=0;e<this.attributes.length;e++)this.attributes[e].offset=t,t+=this.attributes[e].getSizeInBytes();return t}},{key:"size",value:function(){return this.attributes.length}},{key:"get",value:function(t){return this.attributes[t]}},{key:"toString",value:function(){for(var t="[",e=0;e<this.attributes.length;e++)t+="(",t+=this.attributes[e].alias,t+=", ",t+=this.attributes[e].usage,t+=", ",t+=this.attributes[e].numComponents,t+=", ",t+=this.attributes[e].offset,t+=")",t+="\n";return t+="]"}},{key:"equals",value:function(t){if(t===this)return!0;if(this.attributes.length!==t.attributes.length)return!1;for(var e=0;e<this.attributes.length;e++)if(!this.attributes[e].equals(t.attributes[e]))return!1;return!0}},{key:"getMask",value:function(){if(-1===this.mask){for(var t=0,e=0;e<this.attributes.length;e++)t|=this.attributes[e].usage;this.mask=t}return this.mask}},{key:"getMaskWithSizePacked",value:function(){return this.getMask()|this.attributes.length<<32}}]),t}();e.VertexAttributes=a},1757:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(158),e),r(i(3497),e),r(i(8213),e),r(i(4325),e),r(i(6730),e),r(i(1759),e),r(i(737),e),r(i(1686),e),r(i(5362),e),r(i(8737),e),r(i(2738),e),r(i(1116),e)},3249:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.AmbientCubemap=void 0;var s=i(8637),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(n(this,t),e){if(e.length!==t.NUM_VALUES)throw new Error("Incorrect array size");this.data=new Array(e.length),s.Utils.arrayCopy(e,0,this.data,0,this.data.length)}else this.data=new Array(t.NUM_VALUES)}return r(t,[{key:"setData",value:function(t){for(var e=0;e<this.data.length;e++)this.data[e]=t[e];return this}},{key:"setColor",value:function(e,i,n){for(var r=0;r<t.NUM_VALUES;)this.data[r]=e,this.data[r+1]=i,this.data[r+2]=n,r+=3;return this}},{key:"getColor",value:function(t,e){return e*=3,t.set(this.data[e],this.data[e+1],this.data[e+2],1)}},{key:"clear",value:function(){for(var t=0;t<this.data.length;t++)this.data[t]=0;return this}},{key:"clamp",value:function(){for(var e=0;e<this.data.length;e++)this.data[e]=t.clamp(this.data[e]);return this}},{key:"addColor",value:function(t,e,i){for(var n=0;n<this.data.length;)this.data[n++]+=t,this.data[n++]+=e,this.data[n++]+=i;return this}},{key:"add",value:function(t,e,i,n,r,s){var a=n*n,o=r*r,l=s*s,u=a+o+l;if(0===u)return this;var h=t*(u=1/u*(u+1)),c=e*u,f=i*u,d=n>0?0:3;return this.data[d]+=a*h,this.data[d+1]+=a*c,this.data[d+2]+=a*f,d=r>0?6:9,this.data[d]+=o*h,this.data[d+1]+=o*c,this.data[d+2]+=o*f,d=s>0?12:15,this.data[d]+=l*h,this.data[d+1]+=l*c,this.data[d+2]+=l*f,this}},{key:"addWithColorAndDirection",value:function(t,e){return this.add(t.r,t.g,t.b,e.x,e.y,e.z)}},{key:"addWithPointTarget",value:function(t,e,i){return this.add(t.r,t.g,t.b,i.x-e.x,i.y-e.y,i.z-e.z)}},{key:"addWithPointTargetIntensity",value:function(t,e,i,n){var r=n/(1+i.distance(e));return this.add(t.r*r,t.g*r,t.b*r,i.x-e.x,i.y-e.y,i.z-e.z)}},{key:"toString",value:function(){for(var t="",e=0;e<this.data.length;e+=3)t+=this.data[e]+", "+this.data[e+1]+", "+this.data[e+2]+"\n";return t}}],[{key:"clamp",value:function(t){return t<0?0:t>1?1:t}}]),t}();e.AmbientCubemap=a,a.NUM_VALUES=18},5754:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BaseLight=void 0;var s=i(8637),a=function(){function t(){n(this,t),this.color=new s.Color(0,0,0,1)}return r(t,[{key:"setColor",value:function(t,e,i,n){return this.color.set(t,e,i,n),this}}]),t}();e.BaseLight=a},7903:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.DirectionalLight=void 0;var o=i(2668),l=function(t){s(i,t);var e=a(i);function i(){var t;return n(this,i),(t=e.apply(this,arguments)).direction=new o.Vector3,t}return r(i,[{key:"setDirection",value:function(t,e,i){return this.direction.set(t,e,i),this}},{key:"setFrom",value:function(t,e){return t&&this.color.set(t.r,t.g,t.b,t.a),e&&this.direction.setFrom(e).normalize(),this}},{key:"set",value:function(t,e,i,n,r,s){return this.color.set(t,e,i,1),this.direction.set(n,r,s).normalize(),this}},{key:"equals",value:function(t){return!!t&&(t===this||this.color.equals(t.color)&&this.direction.equals(t.direction))}}]),i}(i(5754).BaseLight);e.DirectionalLight=l},1401:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Environment=void 0;var l=i(3497),u=i(6730),h=i(1686),c=i(5362),f=i(7903),d=i(9671),v=i(7857),p=function(t){a(i,t);var e=o(i);function i(){return r(this,i),e.apply(this,arguments)}return s(i,[{key:"addLights",value:function(t){var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.addLight(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"addLight",value:function(t){if(t instanceof f.DirectionalLight)this.addDirectionalLight(t);else if(t instanceof d.PointLight)this.addPointLight(t);else{if(!(t instanceof v.SpotLight))throw new Error("Unknown light type");this.addSpotLight(t)}return this}},{key:"addDirectionalLight",value:function(t){var e=this.get(u.DirectionalLightsAttribute.Type);return e||this.set(e=new u.DirectionalLightsAttribute),e.lights.push(t),this}},{key:"addPointLight",value:function(t){var e=this.get(h.PointLightsAttribute.Type);return e||this.set(e=new h.PointLightsAttribute),e.lights.push(t),this}},{key:"addSpotLight",value:function(t){var e=this.get(c.SpotLightsAttribute.Type);return e||this.set(e=new c.SpotLightsAttribute),e.lights.push(t),this}},{key:"removeLights",value:function(t){var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.removeLight(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"removeLight",value:function(t){if(t instanceof f.DirectionalLight)this.removeDirectionalLight(t);else if(t instanceof d.PointLight)this.removePointLight(t);else{if(!(t instanceof v.SpotLight))throw new Error("Unknown light type");this.removeSpotLight(t)}return this}},{key:"removeDirectionalLight",value:function(t){if(this.has(u.DirectionalLightsAttribute.Type)){var e=this.get(u.DirectionalLightsAttribute.Type),i=e.lights.indexOf(t,0);i>-1&&e.lights.splice(i,1),0===e.lights.length&&this.remove(u.DirectionalLightsAttribute.Type)}return this}},{key:"removePointLight",value:function(t){if(this.has(h.PointLightsAttribute.Type)){var e=this.get(h.PointLightsAttribute.Type),i=e.lights.indexOf(t,0);i>-1&&e.lights.splice(i,1),0===e.lights.length&&this.remove(h.PointLightsAttribute.Type)}return this}},{key:"removeSpotLight",value:function(t){if(this.has(c.SpotLightsAttribute.Type)){var e=this.get(c.SpotLightsAttribute.Type),i=e.lights.indexOf(t,0);i>-1&&e.lights.splice(i,1),0===e.lights.length&&this.remove(c.SpotLightsAttribute.Type)}return this}}]),i}(l.Attributes);e.Environment=p},9671:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.PointLight=void 0;var o=i(2668),l=function(t){s(i,t);var e=a(i);function i(){var t;return n(this,i),(t=e.apply(this,arguments)).position=new o.Vector3,t}return r(i,[{key:"setPosition",value:function(t,e,i){return this.position.set(t,e,i),this}},{key:"setIntensity",value:function(t){return this.intensity=t,this}},{key:"setFrom",value:function(t){return this.set(t.color,t.position,t.intensity)}},{key:"set",value:function(t,e,i){return t&&this.color.setFromColor(t),e&&this.position.setFrom(e),this.intensity=i,this}},{key:"setFromValue",value:function(t,e,i,n,r,s,a){return this.color.set(t,e,i,1),this.position.set(n,r,s),this.intensity=a,this}},{key:"equals",value:function(t){return!!t&&(t===this||this.color.equals(t.color)&&this.position.equals(t.position)&&this.intensity===t.intensity)}}]),i}(i(5754).BaseLight);e.PointLight=l},7857:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.SpotLight=void 0;var o=i(8637),l=i(2668),u=function(t){s(i,t);var e=a(i);function i(){var t;return n(this,i),(t=e.apply(this,arguments)).position=new l.Vector3,t.direction=new l.Vector3,t}return r(i,[{key:"setPosition",value:function(t,e,i){return this.position.set(t,e,i),this}},{key:"setDirection",value:function(t,e,i){return this.direction.set(t,e,i),this}},{key:"setIntensity",value:function(t){return this.intensity=t,this}},{key:"setCutoffAngle",value:function(t){return this.cutoffAngle=t,this}},{key:"setExponent",value:function(t){return this.exponent=t,this}},{key:"set",value:function(t,e,i,n,r,s){return t&&this.color.setFromColor(t),e&&this.position.setFrom(e),i&&this.direction.setFrom(i).normalize(),this.intensity=n,this.cutoffAngle=r,this.exponent=s,this}},{key:"setFromValue",value:function(t,e,i,n,r,s,a,o,l,u,h,c){return this.color.set(t,e,i,1),this.position.set(n,r,s),this.direction.set(a,o,l).normalize(),this.intensity=u,this.cutoffAngle=h,this.exponent=c,this}},{key:"setFrom",value:function(t){return this.set(t.color,t.position,t.direction,t.intensity,t.cutoffAngle,t.exponent)}},{key:"setTarget",value:function(t){return this.direction.set(t.x,t.y,t.z).sub(this.position).normalize(),this}},{key:"equals",value:function(t){return!!t&&(t===this||this.color.equals(t.color)&&this.position.equals(t.position)&&this.direction.equals(t.direction)&&o.MathUtils.isEqual(this.intensity,t.intensity)&&o.MathUtils.isEqual(this.cutoffAngle,t.cutoffAngle)&&o.MathUtils.isEqual(this.exponent,t.exponent))}}]),i}(i(5754).BaseLight);e.SpotLight=u},2003:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(3249),e),r(i(5754),e),r(i(7903),e),r(i(1401),e),r(i(9671),e),r(i(7857),e)},8863:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(1757),e),r(i(4569),e),r(i(143),e),r(i(138),e),r(i(2003),e),r(i(9203),e),r(i(2136),e),r(i(6493),e),r(i(7503),e),r(i(8261),e),r(i(4424),e),r(i(6715),e),r(i(3250),e),r(i(9219),e),r(i(4485),e),r(i(5841),e),r(i(986),e),r(i(4850),e)},6578:function(t,e,i){"use strict";var n=i(4704).default,r=i(7061).default,s=i(6690).default,a=i(9728).default,o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.G3dModelLoader=void 0;var l=i(5474),u=i(4496),h=i(8637),c=i(3192),f=i(2668),d=i(2738),v=i(9203),p=i(4135),g=i(6696),m=i(1335),y=i(239),M=i(1416),x=i(768),b=i(9267),w=i(7232),_=i(3810),T=i(5698),A=i(2131),k=i(102),L=function(){function t(){s(this,t),this.tempQ=new u.Quaternion,this.reader=new k.UBJsonReader}return a(t,[{key:"load",value:function(t,e){return o(this,void 0,void 0,r().mark((function i(){var n,s,a,o;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=e.split(".").pop(),s="g3db"===n,i.next=4,this.parseModel(e,s);case 4:return a=i.sent,o=new A.Model(t),i.next=8,o.load(a);case 8:return i.abrupt("return",o);case 9:case"end":return i.stop()}}),i,this)})))}},{key:"parseModel",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return o(this,void 0,void 0,r().mark((function n(){var s,a,o,l,u,h;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=e.substring(0,e.lastIndexOf("/")),!i){n.next=8;break}return n.next=4,fetch(e).then((function(t){return t.arrayBuffer()}));case 4:o=n.sent,a=this.reader.parse(o),n.next=12;break;case 8:return n.next=10,fetch(e).then((function(t){return t.text()}));case 10:l=n.sent,a=JSON.parse(l);case 12:if(u=new g.ModelData,h=a.version,u.version[0]=h[0],u.version[1]=h[1],u.version[0]===t.VERSION_HI&&u.version[1]===t.VERSION_LO){n.next=18;break}throw new Error("Model version not supported");case 18:return u.id=this.getString(a.id,""),this.parseMeshes(u,a),this.parseMaterials(u,a,s),this.parseNodes(u,a),this.parseAnimations(u,a),n.abrupt("return",u);case 24:case"end":return n.stop()}}),n,this)})))}},{key:"parseMeshes",value:function(t,e){var i=e.meshes;if(void 0!==i){var r,s=n(i);try{for(s.s();!(r=s.n()).done;){var a=r.value,o=new y.ModelMesh,l=this.getString(a.id,"");o.id=l;var u=a.attributes;o.attributes=this.parseAttributes(u),o.vertices=a.vertices;var h,c=a.parts,f=new Array,d=n(c);try{for(d.s();!(h=d.n()).done;){var v=h.value,p=new M.ModelMeshPart,g=this.getString(v.id,null);if(!g)throw new Error("Not id given for mesh part");var m,x=n(f);try{for(x.s();!(m=x.n()).done;){if(m.value.id===g)throw new Error("Mesh part with id '"+g+"' already in defined")}}catch(w){x.e(w)}finally{x.f()}p.id=g;var b=this.getString(v.type,null);if(!b)throw new Error("No primitive type given for mesh part '"+g+"'");p.primitiveType=this.parseType(b),p.indices=v.indices,f.push(p)}}catch(w){d.e(w)}finally{d.f()}o.parts=f,t.meshes.push(o)}}catch(w){s.e(w)}finally{s.f()}}}},{key:"parseType",value:function(t){if("TRIANGLES"===t)return v.GL20.GL_TRIANGLES;if("LINES"===t)return v.GL20.GL_LINES;if("POINTS"===t)return v.GL20.GL_POINTS;if("TRIANGLE_STRIP"===t)return v.GL20.GL_TRIANGLE_STRIP;if("LINE_STRIP"===t)return v.GL20.GL_LINE_STRIP;throw new Error("Unknown primitive type '"+t+"', should be one of triangle, trianglestrip, line, linestrip, lineloop or point")}},{key:"parseAttributes",value:function(t){var e,i=new Array,r=0,s=0,a=n(t);try{for(a.s();!(e=a.n()).done;){var o=e.value;if("POSITION"===o)i.push(d.VertexAttribute3D.Position());else if("NORMAL"===o)i.push(d.VertexAttribute3D.Normal());else if("COLOR"===o)i.push(d.VertexAttribute3D.ColorUnpacked());else{if("COLORPACKED"===o)throw Error("ColorPacked currently not supported");if("TANGENT"===o)i.push(d.VertexAttribute3D.Tangent());else if("BINORMAL"===o)i.push(d.VertexAttribute3D.Binormal());else if(o.startsWith("TEXCOORD"))i.push(d.VertexAttribute3D.TexCoords(r++));else{if(!o.startsWith("BLENDWEIGHT"))throw new Error("Unknown vertex attribute '"+o+"', should be one of position, normal, uv, tangent or binormal");i.push(d.VertexAttribute3D.BoneWeight(s++))}}}}catch(l){a.e(l)}finally{a.f()}return i}},{key:"parseMaterials",value:function(t,e,i){var r=e.materials;if(void 0!==r){var s,a=n(r);try{for(a.s();!(s=a.n()).done;){var o=s.value,l=new m.ModelMaterial,u=this.getString(o.id,null);if(!u)throw new Error("Material needs an id.");l.id=u;var h=o.diffuse;void 0!==h&&(l.diffuse=this.parseColor(h));var c=o.ambient;void 0!==c&&(l.ambient=this.parseColor(c));var f=o.emissive;void 0!==f&&(l.emissive=this.parseColor(f));var d=o.specular;void 0!==d&&(l.specular=this.parseColor(d));var v=o.reflection;void 0!==v&&(l.reflection=this.parseColor(v)),l.shininess=this.getFloat(o.shininess,0),l.opacity=this.getFloat(o.opacity,1);var p=o.textures;if(void 0!==p){var g,y=n(p);try{for(y.s();!(g=y.n()).done;){var M=g.value,x=new T.ModelTexture,b=this.getString(M.id,null);if(!b)throw new Error("Texture has no id.");x.id=b;var w=this.getString(M.filename,null);if(!w)throw new Error("Texture needs filename.");x.fileName=i+(0===i.length||i.endsWith("/")?"":"/")+w,x.uvTranslation=this.readVector2(M.uvTranslation,0,0),x.uvScaling=this.readVector2(M.uvScaling,1,1);var _=this.getString(M.type,null);if(void 0===_)throw new Error("Texture needs type.");x.usage=this.parseTextureUsage(_),void 0===l.textures&&(l.textures=new Array),l.textures.push(x)}}catch(A){y.e(A)}finally{y.f()}}t.materials.push(l)}}catch(A){a.e(A)}finally{a.f()}}}},{key:"parseTextureUsage",value:function(t){return"AMBIENT"===t.toUpperCase()?T.ModelTexture.USAGE_AMBIENT:"BUMP"===t.toUpperCase()?T.ModelTexture.USAGE_BUMP:"DIFFUSE"===t.toUpperCase()?T.ModelTexture.USAGE_DIFFUSE:"EMISSIVE"===t.toUpperCase()?T.ModelTexture.USAGE_EMISSIVE:"NONE"===t.toUpperCase()?T.ModelTexture.USAGE_NONE:"NORMAL"===t.toUpperCase()?T.ModelTexture.USAGE_NORMAL:"REFLECTION"===t.toUpperCase()?T.ModelTexture.USAGE_REFLECTION:"SHININESS"===t.toUpperCase()?T.ModelTexture.USAGE_SHININESS:"SPECULAR"===t.toUpperCase()?T.ModelTexture.USAGE_SPECULAR:"TRANSPARENCY"===t.toUpperCase()?T.ModelTexture.USAGE_TRANSPARENCY:T.ModelTexture.USAGE_UNKNOWN}},{key:"parseColor",value:function(t){if(t.length>=3)return new h.Color(t[0],t[1],t[2],1);throw new Error("Expected Color values <> than three.")}},{key:"readVector2",value:function(t,e,i){if(void 0===t)return new c.Vector2(e,i);if(2===t.length)return new c.Vector2(t[0],t[1]);throw new Error("Expected Vector2 values <> than two.")}},{key:"parseNodes",value:function(t,e){var i=e.nodes;if(void 0!==i){var r,s=n(i);try{for(s.s();!(r=s.n()).done;){var a=r.value;t.nodes.push(this.parseNodesRecursively(a))}}catch(o){s.e(o)}finally{s.f()}}return t.nodes}},{key:"parseNodesRecursively",value:function(t){var e=new x.ModelNode,i=this.getString(t.id,null);if(!i)throw new Error("Node id missing.");e.id=i;var r=t.translation;if(void 0!==r&&3!==r.length)throw new Error("Node translation incomplete");e.translation=void 0===r?null:new f.Vector3(r[0],r[1],r[2]);var s=t.rotation;if(void 0!==s&&4!==s.length)throw new Error("Node rotation incomplete");e.rotation=void 0===s?null:new u.Quaternion(s[0],s[1],s[2],s[3]);var a=t.scale;if(void 0!==a&&3!==a.length)throw new Error("Node scale incomplete");e.scale=void 0===a?null:new f.Vector3(a[0],a[1],a[2]);var o=this.getString(t.mesh,null);o&&(e.meshId=o);var c=t.parts;if(void 0!==c){e.parts=new Array;var d,v=0,p=n(c);try{for(p.s();!(d=p.n()).done;){var g=d.value,m=new _.ModelNodePart,y=this.getString(g.meshpartid,null),M=this.getString(g.materialid,null);if(!y||!M)throw new Error("Node "+i+" part is missing meshPartId or materialId");m.materialId=M,m.meshPartId=y;var b=g.bones;if(void 0!==b){m.bones=new h.ArrayMap;var w,T=n(b);try{for(T.s();!(w=T.n()).done;){var A=w.value,k=this.getString(A.node,null);if(!k)throw new Error("Bone node ID missing");var L=new l.Matrix4,S=A.translation;S&&S.length>=3&&L.translate(S[0],S[1],S[2]),(S=A.rotation)&&S.length>=4&&L.rotate(this.tempQ.set(S[0],S[1],S[2],S[3])),(S=A.scale)&&S.length>=3&&L.scale(S[0],S[1],S[2]),m.bones.set(k,L)}}catch(F){T.e(F)}finally{T.f()}}e.parts[v]=m,v++}}catch(F){p.e(F)}finally{p.f()}}var E=t.children;if(void 0!==E){e.children=new Array;var C,P=0,R=n(E);try{for(R.s();!(C=R.n()).done;){var I=C.value;e.children[P]=this.parseNodesRecursively(I),P++}}catch(F){R.e(F)}finally{R.f()}}return e}},{key:"parseAnimations",value:function(t,e){var i=e.animations;if(i){var r,s=n(i);try{for(s.s();!(r=s.n()).done;){var a=r.value,o=a.bones;if(void 0!==o){var l=new p.ModelAnimation;t.animations.push(l),l.id=a.id;var h,c=n(o);try{for(c.s();!(h=c.n()).done;){var d=h.value,v=new b.ModelNodeAnimation;l.nodeAnimations.push(v),v.nodeId=d.boneId;var g=d.keyframes;if(void 0!==g&&Array.isArray(g)){var m,y=n(g);try{for(y.s();!(m=y.n()).done;){var M=m.value,x=this.getFloat(M.keytime,0)/1e3,_=M.translation;if(void 0!==_&&3===_.length){v.translation||(v.translation=new Array);var T=new w.ModelNodeKeyframe;T.keytime=x,T.value=new f.Vector3(_[0],_[1],_[2]),v.translation.push(T)}var A=M.rotation;if(void 0!==A&&4===A.length){v.rotation||(v.rotation=new Array);var k=new w.ModelNodeKeyframe;k.keytime=x,k.value=new u.Quaternion(A[0],A[1],A[2],A[3]),v.rotation.push(k)}var L=M.scale;if(void 0!==L&&3===L.length){v.scaling||(v.scaling=new Array);var S=new w.ModelNodeKeyframe;S.keytime=x,S.value=new f.Vector3(L[0],L[1],L[2]),v.scaling.push(S)}}}catch(Y){y.e(Y)}finally{y.f()}}else{var E=d.translation;if(void 0!==E&&Array.isArray(E)){v.translation=new Array;var C,P=n(E);try{for(P.s();!(C=P.n()).done;){var R=C.value,I=new w.ModelNodeKeyframe;v.translation.push(I),I.keytime=this.getFloat(R.keytime,0)/1e3;var F=R.value;void 0!==F&&F.length>=3&&(I.value=new f.Vector3(F[0],F[1],F[2]))}}catch(Y){P.e(Y)}finally{P.f()}}var G=d.rotation;if(G&&Array.isArray(G)){v.rotation=new Array;var B,O=n(G);try{for(O.s();!(B=O.n()).done;){var U=B.value,D=new w.ModelNodeKeyframe;v.rotation.push(D),D.keytime=this.getFloat(U.keytime,0)/1e3;var V=U.value;void 0!==V&&V.length>=4&&(D.value=new u.Quaternion(V[0],V[1],V[2],V[3]))}}catch(Y){O.e(Y)}finally{O.f()}}var N=d.scaling;if(N&&Array.isArray(N)){v.scaling=new Array;var z,j=n(N);try{for(j.s();!(z=j.n()).done;){var W=z.value,H=new w.ModelNodeKeyframe;v.scaling.push(H),H.keytime=this.getFloat(W.keytime,0)/1e3;var X=W.value;void 0!==X&&X.length>=3&&(H.value=new f.Vector3(X[0],X[1],X[2]))}}catch(Y){j.e(Y)}finally{j.f()}}}}}catch(Y){c.e(Y)}finally{c.f()}}}}catch(Y){s.e(Y)}finally{s.f()}}}},{key:"getString",value:function(t,e){return void 0!==t?t:e}},{key:"getFloat",value:function(t,e){return void 0!==t?t:e}}]),t}();e.G3dModelLoader=L,L.VERSION_HI=0,L.VERSION_LO=1},3608:function(t,e,i){"use strict";var n=i(4704).default,r=i(7061).default,s=i(9728).default,a=i(6690).default,o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ObjLoader=e.MtlLoader=e.ObjMaterial=void 0;var l=i(4496),u=i(6403),h=i(8637),c=i(2668),f=i(2738),d=i(9203),v=i(6493),p=i(6696),g=i(1335),m=i(239),y=i(1416),M=i(768),x=i(3810),b=i(5698),w=i(2131),_=s((function t(e){a(this,t),this.name=e,this.faces=[],this.numFaces=0,this.mat=new v.Material(""),this.materialName="default"})),T=function(){function t(){a(this,t),this.materialName="default",this.reset()}return s(t,[{key:"build",value:function(){var t=new g.ModelMaterial;return t.id=this.materialName,t.ambient=this.ambientColor?new h.Color(this.ambientColor.r,this.ambientColor.g,this.ambientColor.b,this.ambientColor.a):null,t.diffuse=new h.Color(this.diffuseColor.r,this.diffuseColor.g,this.diffuseColor.b,this.diffuseColor.a),t.specular=new h.Color(this.specularColor.r,this.specularColor.g,this.specularColor.b,this.specularColor.a),t.opacity=this.opacity,t.shininess=this.shininess,this.addTexture(t,this.alphaTexFilename,b.ModelTexture.USAGE_TRANSPARENCY),this.addTexture(t,this.ambientTexFilename,b.ModelTexture.USAGE_AMBIENT),this.addTexture(t,this.diffuseTexFilename,b.ModelTexture.USAGE_DIFFUSE),this.addTexture(t,this.specularTexFilename,b.ModelTexture.USAGE_SPECULAR),this.addTexture(t,this.shininessTexFilename,b.ModelTexture.USAGE_SHININESS),t}},{key:"addTexture",value:function(t,e,i){if(e){var n=new b.ModelTexture;n.usage=i,n.fileName=e,void 0===t.textures&&(t.textures=new Array),t.textures.push(n)}}},{key:"reset",value:function(){this.ambientColor=null,this.diffuseColor=h.Color.WHITE,this.specularColor=h.Color.WHITE,this.opacity=1,this.shininess=0,this.alphaTexFilename=null,this.ambientTexFilename=null,this.diffuseTexFilename=null,this.shininessTexFilename=null,this.specularTexFilename=null}}]),t}();e.ObjMaterial=T;var A=function(){function t(){a(this,t),this.materials=new Array}return s(t,[{key:"load",value:function(t){return o(this,void 0,void 0,r().mark((function e(){var i,n,s,a,o,l,u,h,c,f;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=new T,0!==t.length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,fetch(t);case 5:if((a=e.sent).ok){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,a.text();case 10:o=e.sent,l=o.split("\n").map((function(t){return t.trim()})),u=0,e.prev=13;case 14:if(void 0===(i=l[u])){e.next=30;break}if(u++,i.length>0&&"\t"===i.charAt(0)&&(i=i.substring(1).trim()),0!==(n=i.split(" "))[0].length){e.next=22;break}return e.abrupt("continue",14);case 22:if("#"!==n[0].charAt(0)){e.next=26;break}return e.abrupt("continue",14);case 26:"newmtl"===(h=n[0].toLowerCase())?(c=s.build(),this.materials.push(c),n.length>1?(s.materialName=n[1],s.materialName=s.materialName.replace(".","_")):s.materialName="default",s.reset()):"ka"===h?s.ambientColor=this.parseColor(n):"kd"===h?s.diffuseColor=this.parseColor(n):"ks"===h?s.specularColor=this.parseColor(n):"tr"===h||"d"===h?s.opacity=parseFloat(n[1]):"ns"===h?s.shininess=parseFloat(n[1]):"map_d"===h?s.alphaTexFilename=n[1]:"map_ka"===h?s.ambientTexFilename=n[1]:"map_kd"===h?s.diffuseTexFilename=n[1]:"map_ks"===h?s.specularTexFilename=n[1]:"map_ns"===h&&(s.shininessTexFilename=n[1]);case 28:e.next=14;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(13),console.error(e.t0);case 35:return f=s.build(),this.materials.push(f),e.abrupt("return");case 38:case"end":return e.stop()}}),e,this,[[13,32]])})))}},{key:"parseColor",value:function(t){var e=parseFloat(t[1]),i=parseFloat(t[2]),n=parseFloat(t[3]),r=1;return t.length>4&&(r=parseFloat(t[4])),new h.Color(e,i,n,r)}},{key:"getMaterial",value:function(t){var e,i=n(this.materials);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r.id===t)return r}}catch(a){i.e(a)}finally{i.f()}var s=new g.ModelMaterial;return s.id=t,s.diffuse=new h.Color(1,1,1,1),this.materials.push(s),s}}]),t}();e.MtlLoader=A;var k=function(){function t(){a(this,t),this.verts=[],this.norms=[],this.uvs=[],this.groups=[]}return s(t,[{key:"load",value:function(t,e){return o(this,void 0,void 0,r().mark((function i(){var n,s;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.loadModelData(e);case 2:return n=i.sent,s=new w.Model(t),i.next=6,s.load(n);case 6:return i.abrupt("return",s);case 7:case"end":return i.stop()}}),i,this)})))}},{key:"loadModelData",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return o(this,void 0,void 0,r().mark((function n(){var s,a,o,h,v,g,b,w,T,k,L,S,E,C,P,R,I,F,G,B,O,U,D,V,N,z,j,W,H,X,Y,q,K,Z,Q,J,$,tt,et,it,nt,rt;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.logWarning){n.next=2;break}throw Error("Wavefront (OBJ) is not fully supported, consult the documentation for more information");case 2:return h=new A,v=new _("default"),this.groups.push(v),n.next=7,fetch(e);case 7:if((g=n.sent).ok){n.next=10;break}return n.abrupt("return");case 10:return n.next=12,g.text();case 12:b=n.sent,w=b.split("\n").map((function(t){return t.trim()})),T=0,k=0,n.prev=16;case 17:if(void 0===(s=w[T])){n.next=52;break}if(T++,!((a=s.split(" ")).length<1)){n.next=22;break}return n.abrupt("break",52);case 22:if(0!==a[0].length){n.next=26;break}return n.abrupt("continue",17);case 26:if("#"!==(o=a[0].toLowerCase().charAt(0))){n.next=30;break}return n.abrupt("continue",17);case 30:if("v"!==o){n.next=34;break}1===a[0].length?(this.verts.push(parseFloat(a[1])),this.verts.push(parseFloat(a[2])),this.verts.push(parseFloat(a[3]))):"n"===a[0].charAt(1)?(this.norms.push(parseFloat(a[1])),this.norms.push(parseFloat(a[2])),this.norms.push(parseFloat(a[3]))):"t"===a[0].charAt(1)&&(this.uvs.push(parseFloat(a[1])),this.uvs.push(i?1-parseFloat(a[2]):parseFloat(a[2]))),n.next=50;break;case 34:if("f"!==o){n.next=40;break}for(L=void 0,S=v.faces,E=1;E<a.length-2;E--)L=a[1].split("/"),S.push(this.getIndex(L[0],this.verts.length)),L.length>2&&(1===E&&(v.hasNorms=!0),S.push(this.getIndex(L[2],this.norms.length))),L.length>1&&L[1].length>0&&(1===E&&(v.hasUVs=!0),S.push(this.getIndex(L[1],this.uvs.length))),L=a[++E].split("/"),S.push(this.getIndex(L[0],this.verts.length)),L.length>2&&S.push(this.getIndex(L[2],this.norms.length)),L.length>1&&L[1].length>0&&S.push(this.getIndex(L[1],this.uvs.length)),L=a[++E].split("/"),S.push(this.getIndex(L[0],this.verts.length)),L.length>2&&S.push(this.getIndex(L[2],this.norms.length)),L.length>1&&L[1].length>0&&S.push(this.getIndex(L[1],this.uvs.length)),v.numFaces++;n.next=50;break;case 40:if("o"!==o&&"g"!==o){n.next=44;break}v=a.length>1?this.setActiveGroup(a[1]):this.setActiveGroup("default"),n.next=50;break;case 44:if("mtllib"!==a[0]){n.next=49;break}return n.next=47,h.load(a[1]);case 47:n.next=50;break;case 49:"usemtl"===a[0]&&(1===a.length?v.materialName="default":v.materialName=a[1].replace(".","_"));case 50:n.next=17;break;case 52:n.next=57;break;case 54:n.prev=54,n.t0=n.catch(16),console.error(n.t0);case 57:for(C=0;C<this.groups.length;C++)this.groups[C].numFaces<1&&(this.groups.splice(C,1),C--);if(!(this.groups.length<1)){n.next=60;break}return n.abrupt("return",null);case 60:for(P=this.groups.length,R=new p.ModelData,I=0;I<P;I++){for(F=this.groups[I],G=F.faces,B=G.length,O=F.numFaces,U=F.hasNorms,D=F.hasUVs,V=[],N=0,z=0;N<B;)j=3*G[N++],V[z++]=this.verts[j++],V[z++]=this.verts[j++],V[z++]=this.verts[j],U&&(W=3*G[N++],V[z++]=this.norms[W++],V[z++]=this.norms[W++],V[z++]=this.norms[W]),D&&(H=2*G[N++],V[z++]=this.uvs[H++],V[z++]=this.uvs[H]);if(Y=[],(X=3*O>=32767?0:3*O)>0)for(q=0;q<X;q++)Y[q]=q;(K=new Array).push(new f.VertexAttribute3D(f.Usage.Position,3,d.GL20.GL_FLOAT,!1,u.Shader.POSITION)),U&&K.push(new f.VertexAttribute3D(f.Usage.Normal,3,d.GL20.GL_FLOAT,!1,u.Shader.NORMAL)),D&&K.push(new f.VertexAttribute3D(f.Usage.TextureCoordinates,2,d.GL20.GL_FLOAT,!1,u.Shader.TEXCOORDS+"0")),Z=(++k).toString(),Q="default"===F.name?"node"+Z:F.name,J="default"===F.name?"mesh"+Z:F.name,$="default"===F.name?"part"+Z:F.name,(tt=new M.ModelNode).id=Q,tt.meshId=J,tt.scale=new c.Vector3(1,1,1),tt.translation=new c.Vector3,tt.rotation=new l.Quaternion,(et=new x.ModelNodePart).meshPartId=$,et.materialId=F.materialName,tt.parts=[et],(it=new y.ModelMeshPart).id=$,it.indices=Y,it.primitiveType=d.GL20.GL_TRIANGLES,(nt=new m.ModelMesh).id=J,nt.attributes=K,nt.vertices=V,nt.parts=[it],R.nodes.push(tt),R.meshes.push(nt),rt=h.getMaterial(F.materialName),R.materials.push(rt)}return this.verts.length>0&&(this.verts.length=0),this.norms.length>0&&(this.norms.length=0),this.uvs.length>0&&(this.uvs.length=0),this.groups.length>0&&(this.groups.length=0),n.abrupt("return",R);case 68:case"end":return n.stop()}}),n,this,[[16,54]])})))}},{key:"setActiveGroup",value:function(t){var e,i=n(this.groups);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r.name===t)return r}}catch(a){i.e(a)}finally{i.f()}var s=new _(t);return this.groups.push(s),s}},{key:"getIndex",value:function(t,e){if(!t||0===t.length)return 0;var i=parseInt(t);return i<0?e+i:i-1}}]),t}();e.ObjLoader=k,k.logWarning=!1},102:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BinaryInput=e.UBJsonReader=void 0;var s=function(){function t(){n(this,t),this.oldFormat=!0}return r(t,[{key:"parse",value:function(t){var e=new a(t),i=e.readByte();return this.parseWithType(e,i)}},{key:"parseWithType",value:function(t,e){if(e==="[".charCodeAt(0))return this.parseArray(t);if(e==="{".charCodeAt(0))return this.parseObject(t);if(e==="Z".charCodeAt(0))return null;if(e==="T".charCodeAt(0))return!0;if(e==="F".charCodeAt(0))return!1;if(e==="B".charCodeAt(0))return this.readUChar(t);if(e==="U".charCodeAt(0))return this.readUChar(t);if(e==="i".charCodeAt(0))return this.oldFormat?t.readShort():t.readByte();if(e==="I".charCodeAt(0))return this.oldFormat?t.readInt(!0):t.readShort();if(e==="l".charCodeAt(0))return t.readInt(!0);if(e==="L".charCodeAt(0))return t.readLong();if(e==="d".charCodeAt(0))return t.readFloat();if(e==="D".charCodeAt(0))return t.readFloat();if(e==="s".charCodeAt(0)||e==="S".charCodeAt(0))return this.parseString(t,e);if(e==="a".charCodeAt(0)||e==="A".charCodeAt(0))return this.parseData(t,e);if(e==="C".charCodeAt(0))return t.readString();throw new Error("Unrecognized data type: "+e)}},{key:"parseObject",value:function(t){var e={},i=t.readByte(),n=0;i==="$".charCodeAt(0)&&(n=t.readByte(),i=t.readByte());var r=-1;if(i==="#".charCodeAt(0)){if((r=this.parseSize(t,t.readByte(),!1,-1))<0)throw new Error("Unrecognized data type: "+i);if(0===r)return e;i=t.readByte()}for(var s=0;i!=="}".charCodeAt(0);){var a=this.parseString(t,i,!0),o=this.parseWithType(t,0===n?t.readByte():n);if(e[a]=o,r>0&&++s>=r)break;i=t.readByte()}return e}},{key:"parseSize",value:function(t,e,i,n){if(e==="i".charCodeAt(0))return this.readUChar(t);if(e==="I".charCodeAt(0))return this.readUShort(t);if(e==="l".charCodeAt(0))return this.readUInt(t);if(e==="L".charCodeAt(0))return t.readLong();if(i){var r=(255&e)<<24;return r|=(255&t.readByte())<<16,r|=(255&t.readByte())<<8,r|=255&t.readByte()}return n}},{key:"parseArray",value:function(t){var e=[],i=t.readByte(),n=0;i==="$".charCodeAt(0)&&(n=t.readByte(),i=t.readByte());var r=-1;if(i==="#".charCodeAt(0)){if((r=this.parseSize(t,t.readByte(),!1,-1))<0)throw new Error("Unrecognized data type "+i);if(0===r)return e;i=0===n?t.readByte():n}for(var s=0;i!=="]".charCodeAt(0);){var a=this.parseWithType(t,i);if(e.push(a),r>0&&++s>=r)break;i=0===n?t.readByte():n}return e}},{key:"parseData",value:function(t,e){for(var i=t.readByte(),n=e==="A".charCodeAt(0)?this.readUInt(t):this.readUChar(t),r=[],s=0;s<n;s++){var a=this.parseWithType(t,i);r.push(a)}return r}},{key:"readUChar",value:function(t){return 255&t.readByte()}},{key:"parseString",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=-1;if(e==="S".charCodeAt(0)?n=this.parseSize(t,t.readByte(),!0,-1):e==="s".charCodeAt(0)?n=this.readUChar(t):i&&(n=this.parseSize(t,e,!1,-1)),n<0)throw new Error("Unrecognized data type: ".concat(e,", string expected"));return n>0?this.readString(t,n):""}},{key:"readUShort",value:function(t){return 65535&t.readShort()}},{key:"readUInt",value:function(t){return 4294967295&t.readInt(!0)}},{key:"readString",value:function(t,e){return t.readStringWithSize(e)}}]),t}();e.UBJsonReader=s;var a=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new DataView(e);n(this,t),this.strings=i,this.index=r,this.buffer=s}return r(t,[{key:"readByte",value:function(){return this.buffer.getInt8(this.index++)}},{key:"readUnsignedByte",value:function(){return this.buffer.getUint8(this.index++)}},{key:"readShort",value:function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t}},{key:"readInt32",value:function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t}},{key:"readLong",value:function(){var t=this.buffer.getInt32(this.index);return this.index+=8,t}},{key:"readInt",value:function(t){var e=(this.readUnsignedByte()<<24)+(this.readUnsignedByte()<<16)+(this.readUnsignedByte()<<8)+(this.readUnsignedByte()<<0);return t?e:e>>>1^-(1&e)}},{key:"readStringRef",value:function(){var t=this.readInt(!0);return 0===t?null:this.strings[t-1]}},{key:"readStringWithSize",value:function(t){switch(t){case 0:return null;case 1:return""}for(var e="",i=0;i<t;){var n=this.readUnsignedByte();switch(n>>4){case 12:case 13:e+=String.fromCharCode((31&n)<<6|63&this.readUnsignedByte()),i+=2;break;case 14:e+=String.fromCharCode((15&n)<<12|(63&this.readUnsignedByte())<<6|63&this.readUnsignedByte()),i+=3;break;default:e+=String.fromCharCode(n),i++}}return e}},{key:"readString",value:function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",i=0;i<t;){var n=this.readUnsignedByte();switch(n>>4){case 12:case 13:e+=String.fromCharCode((31&n)<<6|63&this.readUnsignedByte()),i+=2;break;case 14:e+=String.fromCharCode((15&n)<<12|(63&this.readUnsignedByte())<<6|63&this.readUnsignedByte()),i+=3;break;default:e+=String.fromCharCode(n),i++}}return e}},{key:"readFloat",value:function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t}},{key:"readBoolean",value:function(){return 0!==this.readByte()}}]),t}();e.BinaryInput=a},2136:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(6578),e),r(i(3608),e),r(i(102),e)},365:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Frustum=void 0;var a=i(5474),o=i(8637),l=i(2668),u=i(7468),h=function(){function t(){r(this,t),this.planes=new Array(6),this.planePoints=[new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3],this.planePointsArray=new Array(24);for(var e=0;e<6;e++)this.planes[e]=new u.Plane(new l.Vector3,0)}return s(t,[{key:"update",value:function(e){o.Utils.arrayCopy(t.clipSpacePlanePointsArray,0,this.planePointsArray,0,t.clipSpacePlanePointsArray.length),a.Matrix4.prj(e,this.planePointsArray,0,8,3);for(var i=0,n=0;i<8;i++){var r=this.planePoints[i];r.x=this.planePointsArray[n++],r.y=this.planePointsArray[n++],r.z=this.planePointsArray[n++]}this.planes[0].set(this.planePoints[1],this.planePoints[0],this.planePoints[2]),this.planes[1].set(this.planePoints[4],this.planePoints[5],this.planePoints[7]),this.planes[2].set(this.planePoints[0],this.planePoints[4],this.planePoints[3]),this.planes[3].set(this.planePoints[5],this.planePoints[1],this.planePoints[6]),this.planes[4].set(this.planePoints[2],this.planePoints[3],this.planePoints[6]),this.planes[5].set(this.planePoints[4],this.planePoints[0],this.planePoints[1])}},{key:"pointInFrustum",value:function(t){for(var e=0;e<this.planes.length;e++){if(this.planes[e].testPoint(t.x,t.y,t.z)===u.PlaneSide.Back)return!1}return!0}},{key:"sphereInFrustum",value:function(t,e){for(var i=0;i<6;i++)if(this.planes[i].normal.x*t.x+this.planes[i].normal.y*t.y+this.planes[i].normal.z*t.z<-e-this.planes[i].d)return!1;return!0}},{key:"sphereInFrustumWithoutNearFar",value:function(t,e){for(var i=2;i<6;i++)if(this.planes[i].normal.x*t.x+this.planes[i].normal.y*t.y+this.planes[i].normal.z*t.z<-e-this.planes[i].d)return!1;return!0}},{key:"boundsInFrustrum",value:function(t,e){for(var i=0,n=this.planes.length;i<n;i++)if(this.planes[i].testPoint(t.x+e.x/2,t.y+e.y/2,t.z+e.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(t.x+e.x/2,t.y+e.y/2,t.z-e.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(t.x+e.x/2,t.y-e.y/2,t.z+e.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(t.x+e.x/2,t.y-e.y/2,t.z-e.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(t.x-e.x/2,t.y+e.y/2,t.z+e.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(t.x-e.x/2,t.y+e.y/2,t.z-e.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(t.x-e.x/2,t.y-e.y/2,t.z+e.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(t.x-e.x/2,t.y-e.y/2,t.z-e.z/2)===u.PlaneSide.Back)return!1;return!0}}]),t}();e.Frustum=h,h.clipSpacePlanePoints=[new l.Vector3(-1,-1,-1),new l.Vector3(1,-1,-1),new l.Vector3(1,1,-1),new l.Vector3(-1,1,-1),new l.Vector3(-1,-1,1),new l.Vector3(1,-1,1),new l.Vector3(1,1,1),new l.Vector3(-1,1,1)],h.clipSpacePlanePointsArray=new Array(24),function(){var t,e=0,i=n(h.clipSpacePlanePoints);try{for(i.s();!(t=i.n()).done;){var r=t.value;h.clipSpacePlanePointsArray[e++]=r.x,h.clipSpacePlanePointsArray[e++]=r.y,h.clipSpacePlanePointsArray[e++]=r.z}}catch(s){i.e(s)}finally{i.f()}}(),h.tmpV=new l.Vector3},7468:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=e.PlaneSide=void 0;var s,a=i(2668);!function(t){t[t.OnPlane=0]="OnPlane",t[t.Back=1]="Back",t[t.Front=2]="Front"}(s=e.PlaneSide||(e.PlaneSide={}));var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,t),this.normal=new a.Vector3,this.d=0,e&&(this.normal.setFrom(e).normalize(),this.d=i)}return r(t,[{key:"set",value:function(t,e,i){this.normal.set(t.x,t.y,t.z).sub(e).cross(new a.Vector3(e.x-i.x,e.y-i.y,e.z-i.z)).normalize(),this.d=-t.dot(this.normal)}},{key:"setByValue",value:function(t,e,i,n,r,s){this.normal.set(n,r,s),this.d=-(t*n+e*r+i*s)}},{key:"distance",value:function(t){return this.normal.dot(t)+this.d}},{key:"testPoint",value:function(t,e,i){var n=this.normal.dotWithValue(t,e,i)+this.d;return 0===n?s.OnPlane:n<0?s.Back:s.Front}},{key:"isFrontFacing",value:function(t){return this.normal.dot(t)<=0}},{key:"getNormal",value:function(){return this.normal}},{key:"getD",value:function(){return this.d}},{key:"setFromPlane",value:function(t){this.normal.setFrom(t.normal),this.d=t.d}},{key:"toString",value:function(){return this.normal.toString()+", "+this.d}}]),t}();e.Plane=o},7503:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(365),e),r(i(7468),e)},8497:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Animation3D=void 0;var s=n((function t(){r(this,t),this.duration=0,this.nodeAnimations=[]}));e.Animation3D=s},685:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.MeshPart=void 0;var s=i(2691),a=i(2668),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n(this,t),this.id="",this.primitiveType=0,this.offset=0,this.size=0,this.mesh=null,this.center=new a.Vector3,this.halfExtents=new a.Vector3,this.radius=-1,this.bounds=new s.BoundingBox,e&&this.setByMeshPart(e)}return r(t,[{key:"dispose",value:function(){}},{key:"setByMeshPart",value:function(t){return this.id=t.id,this.mesh=t.mesh,this.offset=t.offset,this.size=t.size,this.primitiveType=t.primitiveType,this.center.set(t.center.x,t.center.y,t.center.z),this.halfExtents.set(t.halfExtents.x,t.halfExtents.y,t.halfExtents.z),this.radius=t.radius,this}},{key:"set",value:function(t,e,i,n,r){return this.id=t,this.mesh=e,this.offset=i,this.size=n,this.primitiveType=r,this.center.set(0,0,0),this.halfExtents.set(0,0,0),this.radius=-1,this}},{key:"update",value:function(){this.mesh.extendBoundingBox(this.bounds,this.offset,this.size,null),this.bounds.getCenter(this.center),this.bounds.getDimensions(this.halfExtents).scale(.5),this.radius=this.halfExtents.length()}},{key:"equals",value:function(t){return t===this||!!t&&t.mesh===this.mesh&&t.primitiveType===this.primitiveType&&t.offset===this.offset&&t.size===this.size}},{key:"render",value:function(t,e){this.mesh.render(t,this.primitiveType,this.offset,this.size,e)}}]),t}();e.MeshPart=o},2131:function(t,e,i){"use strict";var n=i(7424).default,r=i(4704).default,s=i(7061).default,a=i(6690).default,o=i(9728).default,l=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var u=i(5474),h=i(4496),c=i(8637),f=i(2668),d=i(8213),v=i(4325),p=i(1759),g=i(8737),m=i(1116),y=i(9203),M=i(6493),x=i(8261),b=i(2196),w=i(8497),_=i(5698),T=i(685),A=i(9862),k=i(1195),L=i(1589),S=i(5975),E=function(){function t(e){a(this,t),this.gl=e,this.materials=[],this.nodes=[],this.animations=[],this.meshes=[],this.meshParts=[],this.disposables=[],this.nodePartBones=new Map}return o(t,[{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new b.FileTextureProvider;return l(this,void 0,void 0,s().mark((function i(){return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.loadMeshes(t.meshes),i.next=3,this.loadMaterials(t.materials,e);case 3:this.loadNodes(t.nodes),this.loadAnimations(t.animations),this.calculateTransforms();case 6:case"end":return i.stop()}}),i,this)})))}},{key:"loadAnimations",value:function(t){var e,i=r(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,s=new w.Animation3D;s.id=n.id;var a,o=r(n.nodeAnimations);try{for(o.s();!(a=o.n()).done;){var l=a.value,u=this.getNode(l.nodeId);if(u){var c=new k.NodeAnimation;if(c.node=u,l.translation){c.translation=new Array;var d,v=r(l.translation);try{for(v.s();!(d=v.n()).done;){var p=d.value;p.keytime>s.duration&&(s.duration=p.keytime),c.translation.push(new L.NodeKeyframe(p.keytime,(new f.Vector3).setFrom(p.value?p.value:u.translation)))}}catch(_){v.e(_)}finally{v.f()}}if(l.rotation){c.rotation=new Array;var g,m=r(l.rotation);try{for(m.s();!(g=m.n()).done;){var y=g.value;y.keytime>s.duration&&(s.duration=y.keytime),c.rotation.push(new L.NodeKeyframe(y.keytime,(new h.Quaternion).setFrom(y.value?y.value:u.rotation)))}}catch(_){m.e(_)}finally{m.f()}}if(l.scaling){c.scaling=new Array;var M,x=r(l.scaling);try{for(x.s();!(M=x.n()).done;){var b=M.value;b.keytime>s.duration&&(s.duration=b.keytime),c.scaling.push(new L.NodeKeyframe(b.keytime,(new f.Vector3).setFrom(b.value?b.value:u.scale)))}}catch(_){x.e(_)}finally{x.f()}}(c.translation&&c.translation.length>0||c.rotation&&c.rotation.length>0||c.scaling&&c.scaling.length>0)&&s.nodeAnimations.push(c)}}}catch(_){o.e(_)}finally{o.f()}s.nodeAnimations.length>0&&this.animations.push(s)}}catch(_){i.e(_)}finally{i.f()}}},{key:"loadNodes",value:function(t){this.nodePartBones.clear();var e,i=r(t);try{for(i.s();!(e=i.n()).done;){var s=e.value;this.nodes.push(this.loadNode(s))}}catch(g){i.e(g)}finally{i.f()}var a,o=r(this.nodePartBones);try{for(o.s();!(a=o.n()).done;){var l=n(a.value,2),h=l[0],f=l[1];h.invBoneBindTransforms||(h.invBoneBindTransforms=new c.ArrayMap),h.invBoneBindTransforms.clear();for(var d=0;d<f.size;d++){var v=f.keys[d],p=f.values[d];h.invBoneBindTransforms.set(this.getNode(v),(new u.Matrix4).set(p.values).invert())}}}catch(g){o.e(g)}finally{o.f()}}},{key:"loadNode",value:function(t){var e=new A.Node;if(e.id=t.id,t.translation&&e.translation.set(t.translation.x,t.translation.y,t.translation.z),t.rotation&&e.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z,t.rotation.w),t.scale&&e.scale.set(t.scale.x,t.scale.y,t.scale.z),t.parts){var i,n=r(t.parts);try{for(n.s();!(i=n.n()).done;){var s=i.value,a=null,o=null;if(s.meshPartId){var l,u=r(this.meshParts);try{for(u.s();!(l=u.n()).done;){var h=l.value;if(s.meshPartId===h.id){a=h;break}}}catch(y){u.e(y)}finally{u.f()}}if(s.materialId){var c,f=r(this.materials);try{for(f.s();!(c=f.n()).done;){var d=c.value;if(s.materialId===d.id){o=d;break}}}catch(y){f.e(y)}finally{f.f()}}if(!a||!o)throw new Error("Invalid node: "+e.id);var v=new S.NodePart;v.meshPart=a,v.material=o,e.parts.push(v),s.bones&&this.nodePartBones.set(v,s.bones)}}catch(y){n.e(y)}finally{n.f()}}if(t.children){var p,g=r(t.children);try{for(g.s();!(p=g.n()).done;){var m=p.value;e.addChild(this.loadNode(m))}}catch(y){g.e(y)}finally{g.f()}}return e}},{key:"loadMeshes",value:function(t){var e,i=r(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;this.convertMesh(n)}}catch(s){i.e(s)}finally{i.f()}}},{key:"convertMesh",value:function(t){var e,i=0,n=r(t.parts);try{for(n.s();!(e=n.n()).done;){i+=e.value.indices.length}}catch(y){n.e(y)}finally{n.f()}var s=i>0,a=new m.VertexAttributes(t.attributes),o=t.vertices.length/(a.vertexSize/4),l=new x.Mesh3D(this.gl,!0,!0,o,i,a);this.meshes.push(l),this.disposables.push(l),l.vertices.updateVertices(0,t.vertices,0,t.vertices.length);var u,h=0,c=0,f=r(t.parts);try{for(f.s();!(u=f.n()).done;){var d=u.value,v=new T.MeshPart;v.id=d.id,v.primitiveType=d.primitiveType,v.offset=h,v.size=s?d.indices.length:o,v.mesh=l,s&&(l.indices.updateIndices(c,d.indices,0,d.indices.length),c+=d.indices.length),h+=v.size,this.meshParts.push(v)}}catch(y){f.e(y)}finally{f.f()}var p,g=r(this.meshParts);try{for(g.s();!(p=g.n()).done;){p.value.update()}}catch(y){g.e(y)}finally{g.f()}}},{key:"loadMaterials",value:function(t,e){return l(this,void 0,void 0,s().mark((function i(){var n,a,o;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=r(t),i.prev=1,n.s();case 3:if((a=n.n()).done){i.next=12;break}return o=a.value,i.t0=this.materials,i.next=8,this.convertMaterial(o,e);case 8:i.t1=i.sent,i.t0.push.call(i.t0,i.t1);case 10:i.next=3;break;case 12:i.next=17;break;case 14:i.prev=14,i.t2=i.catch(1),n.e(i.t2);case 17:return i.prev=17,n.f(),i.finish(17);case 20:case"end":return i.stop()}}),i,this,[[1,14,17,20]])})))}},{key:"convertMaterial",value:function(t,e){return l(this,void 0,void 0,s().mark((function i(){var n,a,o,l,u,h,c,f,m,x,b;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((n=new M.Material).id=t.id,void 0!==t.ambient&&n.set(new v.ColorAttribute3D(v.ColorAttribute3D.Ambient,t.ambient)),void 0!==t.diffuse&&n.set(new v.ColorAttribute3D(v.ColorAttribute3D.Diffuse,t.diffuse)),void 0!==t.specular&&n.set(new v.ColorAttribute3D(v.ColorAttribute3D.Specular,t.specular)),void 0!==t.emissive&&n.set(new v.ColorAttribute3D(v.ColorAttribute3D.Emissive,t.emissive)),void 0!==t.reflection&&n.set(new v.ColorAttribute3D(v.ColorAttribute3D.Reflection,t.reflection)),t.shininess>0&&n.set(new p.FloatAttribute(p.FloatAttribute.Shininess,t.shininess)),1!==t.opacity&&n.set(new d.BlendingAttribute(y.GL20.GL_SRC_ALPHA,y.GL20.GL_ONE_MINUS_SRC_ALPHA,!0,t.opacity)),a=new Map,void 0===t.textures){i.next=62;break}o=r(t.textures),i.prev=12,o.s();case 14:if((l=o.n()).done){i.next=54;break}if(u=l.value,h=void 0,!a.has(u.fileName)){i.next=21;break}h=a.get(u.fileName),i.next=26;break;case 21:return i.next=23,e.load(this.gl,u.fileName);case 23:h=i.sent,a.set(u.fileName,h),this.disposables.push(h);case 26:c=u.uvTranslation?u.uvTranslation.x:0,f=u.uvTranslation?u.uvTranslation.y:0,m=u.uvScaling?u.uvScaling.x:1,x=u.uvScaling?u.uvScaling.y:1,b=void 0,i.t0=u.usage,i.next=i.t0===_.ModelTexture.USAGE_DIFFUSE?34:i.t0===_.ModelTexture.USAGE_SPECULAR?36:i.t0===_.ModelTexture.USAGE_BUMP?38:i.t0===_.ModelTexture.USAGE_NORMAL?40:i.t0===_.ModelTexture.USAGE_AMBIENT?42:i.t0===_.ModelTexture.USAGE_EMISSIVE?44:i.t0===_.ModelTexture.USAGE_REFLECTION?46:48;break;case 34:return b=new g.TextureAttribute(g.TextureAttribute.Diffuse,c,f,m,x),i.abrupt("break",48);case 36:return b=new g.TextureAttribute(g.TextureAttribute.Specular,c,f,m,x),i.abrupt("break",48);case 38:return b=new g.TextureAttribute(g.TextureAttribute.Bump,c,f,m,x),i.abrupt("break",48);case 40:return b=new g.TextureAttribute(g.TextureAttribute.Normal,c,f,m,x),i.abrupt("break",48);case 42:return b=new g.TextureAttribute(g.TextureAttribute.Ambient,c,f,m,x),i.abrupt("break",48);case 44:return b=new g.TextureAttribute(g.TextureAttribute.Emissive,c,f,m,x),i.abrupt("break",48);case 46:return b=new g.TextureAttribute(g.TextureAttribute.Reflection,c,f,m,x),i.abrupt("break",48);case 48:b.setTexture(h),b.setOffset(c,f),b.setScale(m,x),n.set(b);case 52:i.next=14;break;case 54:i.next=59;break;case 56:i.prev=56,i.t1=i.catch(12),o.e(i.t1);case 59:return i.prev=59,o.f(),i.finish(59);case 62:return i.abrupt("return",n);case 63:case"end":return i.stop()}}),i,this,[[12,56,59,62]])})))}},{key:"manageDisposable",value:function(t){this.disposables.indexOf(t)<0&&this.disposables.push(t)}},{key:"getManagedDisposables",value:function(){return this.disposables}},{key:"dispose",value:function(){var t,e=r(this.disposables);try{for(e.s();!(t=e.n()).done;){t.value.dispose()}}catch(i){e.e(i)}finally{e.f()}}},{key:"calculateTransforms",value:function(){for(var t=this.nodes.length,e=0;e<t;e++)this.nodes[e].calculateTransforms(!0);for(var i=0;i<t;i++)this.nodes[i].calculateBoneTransforms(!0)}},{key:"calculateBoundingBox",value:function(t){return t.inf(),this.extendBoundingBox(t)}},{key:"extendBoundingBox",value:function(t){for(var e=this.nodes.length,i=0;i<e;i++)this.nodes[i].extendBoundingBox(t);return t}},{key:"getAnimation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.animations.length;if(e){for(var n=0;n<i;n++)if(this.animations[n].id.toUpperCase()===t.toUpperCase())return this.animations[n]}else for(var r=0;r<i;r++)if(this.animations[r].id===t)return this.animations[r];return null}},{key:"getMaterial",value:function(t){var e,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.materials.length;if(i){for(var r=0;r<n;r++)if((e=this.materials[r]).id.toUpperCase()===t.toUpperCase())return e}else for(var s=0;s<n;s++)if((e=this.materials[s]).id===t)return e;return null}},{key:"getNode",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A.Node.getNode(this.nodes,t,e,i)}}]),t}();e.Model=E},9862:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Node=void 0;var a=i(5474),o=i(4496),l=i(2668),u=function(){function t(){r(this,t),this.inheritTransform=!0,this.isAnimated=!1,this.translation=new l.Vector3,this.rotation=new o.Quaternion(0,0,0,1),this.scale=new l.Vector3(1,1,1),this.localTransform=new a.Matrix4,this.globalTransform=new a.Matrix4,this.parts=new Array,this.parent=null,this.children=new Array}return s(t,[{key:"calculateLocalTransform",value:function(){return this.isAnimated||this.localTransform.setFromTranslationRotation(this.translation,this.rotation,this.scale),this.localTransform}},{key:"calculateWorldTransform",value:function(){return this.inheritTransform&&this.parent?this.globalTransform.set(this.parent.globalTransform.values).multiply(this.localTransform):this.globalTransform.set(this.localTransform.values),this.globalTransform}},{key:"calculateTransforms",value:function(t){if(this.calculateLocalTransform(),this.calculateWorldTransform(),t){var e,i=n(this.children);try{for(i.s();!(e=i.n()).done;){e.value.calculateTransforms(!0)}}catch(r){i.e(r)}finally{i.f()}}}},{key:"calculateBoneTransforms",value:function(t){var e,i=n(this.parts);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r.invBoneBindTransforms&&r.bones&&r.invBoneBindTransforms.size===r.bones.length)for(var s=0;s<r.invBoneBindTransforms.size;s++)r.bones[s].set(r.invBoneBindTransforms.keys[s].globalTransform.values).multiply(r.invBoneBindTransforms.values[s])}}catch(l){i.e(l)}finally{i.f()}if(t){var a,o=n(this.children);try{for(o.s();!(a=o.n()).done;){a.value.calculateBoneTransforms(!0)}}catch(l){o.e(l)}finally{o.f()}}}},{key:"calculateBoundingBox",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.inf(),this.extendBoundingBox(t,e)}},{key:"extendBoundingBox",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.parts.length,n=0;n<i;n++){var r=this.parts[n];if(r.enabled){var s=r.meshPart;e?s.mesh.extendBoundingBox(t,s.offset,s.size,this.globalTransform):s.mesh.extendBoundingBox(t,s.offset,s.size,null)}}for(var a=this.children.length,o=0;o<a;o++)this.children[o].extendBoundingBox(t);return t}},{key:"attachTo",value:function(t){t.addChild(this)}},{key:"detach",value:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)}},{key:"hasChildren",value:function(){return!!this.children&&this.children.length>0}},{key:"getChildCount",value:function(){return this.children.length}},{key:"getChildByIndex",value:function(t){return this.children[t]}},{key:"getChild",value:function(e,i,n){return t.getNode(this.children,e,i,n)}},{key:"addChild",value:function(t){return this.insertChild(-1,t)}},{key:"insertChild",value:function(t,e){for(var i=this;i;i=i.getParent())if(i===e)throw new Error("Cannot add a parent as a child");var n=e.getParent();if(n&&!n.removeChild(e))throw new Error("Could not remove child from its current parent");return t<0||t>=this.children.length?(t=this.children.length,this.children.push(e)):this.children.splice(t,0,e),e.parent=this,t}},{key:"removeChild",value:function(t){var e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),!0)}},{key:"getChildren",value:function(){return this.children}},{key:"getParent",value:function(){return this.parent}},{key:"hasParent",value:function(){return!!this.parent}},{key:"copy",value:function(){return(new t).set(this)}},{key:"set",value:function(t){this.detach(),this.id=t.id,this.isAnimated=t.isAnimated,this.inheritTransform=t.inheritTransform,this.translation.setFrom(t.translation),this.rotation.setFrom(t.rotation),this.scale.setFrom(t.scale),this.localTransform.set(t.localTransform.values),this.globalTransform.set(t.globalTransform.values),this.parts.length=0;var e,i=n(t.parts);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.parts.push(r.copy())}}catch(l){i.e(l)}finally{i.f()}this.children.length=0;var s,a=n(t.getChildren());try{for(a.s();!(s=a.n()).done;){var o=s.value;this.addChild(o.copy())}}catch(l){a.e(l)}finally{a.f()}return this}}],[{key:"getNode",value:function(t,e,i,n){var r,s=t.length;if(n){for(var a=0;a<s;a++)if((r=t[a]).id.toUpperCase()===e.toUpperCase())return r}else for(var o=0;o<s;o++)if((r=t[o]).id===e)return r;if(i)for(var l=0;l<s;l++)if(r=this.getNode(t[l].children,e,!0,n))return r;return null}}]),t}();e.Node=u},1195:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.NodeAnimation=void 0;var s=n((function t(){r(this,t),this.translation=null,this.rotation=null,this.scaling=null}));e.NodeAnimation=s},1589:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.NodeKeyframe=void 0;var s=n((function t(e,i){r(this,t),this.value=null,this.keytime=e,this.value=i}));e.NodeKeyframe=s},5975:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.NodePart=void 0;var s=i(5474),a=i(8637),o=i(685),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n(this,t),this.invBoneBindTransforms=null,this.bones=null,this.enabled=!0,this.meshPart=e,this.material=i}return r(t,[{key:"copy",value:function(){return(new t).set(this)}},{key:"setRenderable",value:function(t){return t.material=this.material,t.meshPart.setByMeshPart(this.meshPart),t.bones=this.bones,t}},{key:"set",value:function(t){if(this.meshPart=new o.MeshPart(t.meshPart),this.material=t.material,this.enabled=t.enabled,t.invBoneBindTransforms){this.invBoneBindTransforms||(this.invBoneBindTransforms=new a.ArrayMap),this.invBoneBindTransforms.clear();for(var e=0;e<t.invBoneBindTransforms.size;e++)this.invBoneBindTransforms.set(t.invBoneBindTransforms.keys[e],t.invBoneBindTransforms.values[e]);this.bones&&this.bones.length===this.invBoneBindTransforms.size||(this.bones=new Array);for(var i=0;i<this.invBoneBindTransforms.size;i++)void 0===this.bones[i]&&(this.bones[i]=new s.Matrix4)}else this.invBoneBindTransforms=null,this.bones=null;return this}}]),t}();e.NodePart=l},4135:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelAnimation=void 0;var s=n((function t(){r(this,t),this.nodeAnimations=[]}));e.ModelAnimation=s},6696:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelData=void 0;var a=function(){function t(){r(this,t),this.version=[],this.meshes=[],this.materials=[],this.nodes=[],this.animations=[]}return s(t,[{key:"addMesh",value:function(t){var e,i=n(this.meshes);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r.id===t.id)throw new Error("Mesh with id '"+r.id+"' already in model")}}catch(s){i.e(s)}finally{i.f()}this.meshes.push(t)}}]),t}();e.ModelData=a},1335:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelMaterial=e.MaterialType=void 0,function(t){t[t.Lambert=0]="Lambert",t[t.Phong=1]="Phong"}(e.MaterialType||(e.MaterialType={}));var s=n((function t(){r(this,t),this.opacity=1}));e.ModelMaterial=s},239:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelMesh=void 0;var s=n((function t(){r(this,t)}));e.ModelMesh=s},1416:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelMeshPart=void 0;var s=n((function t(){r(this,t)}));e.ModelMeshPart=s},768:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelNode=void 0;var s=n((function t(){r(this,t)}));e.ModelNode=s},9267:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelNodeAnimation=void 0;var s=n((function t(){r(this,t),this.translation=null,this.rotation=null,this.scaling=null}));e.ModelNodeAnimation=s},7232:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelNodeKeyframe=void 0;var s=n((function t(){r(this,t),this.value=null}));e.ModelNodeKeyframe=s},3810:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelNodePart=void 0;var s=n((function t(){r(this,t)}));e.ModelNodePart=s},5698:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelTexture=void 0;var s=n((function t(){r(this,t)}));e.ModelTexture=s,s.USAGE_UNKNOWN=0,s.USAGE_NONE=1,s.USAGE_DIFFUSE=2,s.USAGE_EMISSIVE=3,s.USAGE_AMBIENT=4,s.USAGE_SPECULAR=5,s.USAGE_SHININESS=6,s.USAGE_NORMAL=7,s.USAGE_BUMP=8,s.USAGE_TRANSPARENCY=9,s.USAGE_REFLECTION=10},4073:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(4135),e),r(i(6696),e),r(i(1335),e),r(i(239),e),r(i(1416),e),r(i(768),e),r(i(9267),e),r(i(7232),e),r(i(3810),e),r(i(5698),e)},4424:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(8497),e),r(i(4073),e),r(i(685),e),r(i(2131),e),r(i(9862),e),r(i(1195),e),r(i(1589),e),r(i(5975),e)},6973:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BaseShader=e.Uniform=e.LocalSetter=e.GlobalSetter=void 0;var s=i(3497),a=function(){function t(){n(this,t)}return r(t,[{key:"isGlobal",value:function(t,e){return!0}}]),t}();e.GlobalSetter=a;var o=function(){function t(){n(this,t)}return r(t,[{key:"isGlobal",value:function(t,e){return!1}}]),t}();e.LocalSetter=o;var l=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(this,t),this.alias=e,this.materialMask=i,this.environmentMask=r,this.overallMask=s}return r(t,[{key:"validate",value:function(t,e,i){var n=i&&i.material?i.material.getMask():0,r=i&&i.environment?i.environment.getMask():0;return(n&this.materialMask)===this.materialMask&&(r&this.environmentMask)===this.environmentMask&&((n|r)&this.overallMask)===this.overallMask}}]),t}();e.Uniform=l;var u=function(){function t(){n(this,t),this.uniforms=[],this.validators=[],this.setters=[],this.globalUniforms=[],this.localUniforms=[],this.attributes=new Map,this.combinedAttributes=new s.Attributes,this.tempArray=[]}return r(t,[{key:"canRender",value:function(t){return!0}},{key:"init",value:function(){}},{key:"compareTo",value:function(t){}},{key:"register",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.getUniformID(t);return n>=0?(this.validators.splice(n,0,e),this.setters.splice(n,0,i),n):(this.uniforms.push(t),this.validators.push(e),this.setters.push(i),this.uniforms.length-1)}},{key:"getUniformID",value:function(t){for(var e=this.uniforms.length,i=0;i<e;i++)if(this.uniforms[i]===t)return i;return-1}},{key:"getUniformAlias",value:function(t){return this.uniforms[t]}},{key:"initWithVariables",value:function(t,e){if(this.locations)throw new Error("Already initialized");this.program=t;var i=this.uniforms.length;this.locations=new Array(i);for(var n=0;n<i;n++){var r=this.uniforms[n],s=this.validators[n],a=this.setters[n];s&&!s.validate(this,n,e)?this.locations[n]=null:(this.locations[n]=t.getUniformLocation(r,!1),this.locations[n]&&a&&(a.isGlobal(this,n)?this.globalUniforms.push(n):this.localUniforms.push(n))),this.locations[n]||this.validators.splice(n,0,null)}if(e)for(var o=e.meshPart.mesh.getVertexAttributes(),l=o.size(),u=0;u<l;u++){var h=o.get(u),c=t.getAttributeLocation(h.alias);c>=0&&this.attributes.set(h.getKey(),c)}}},{key:"begin",value:function(t,e){this.camera=t,this.context=e,this.program.bind(),this.currentMesh=null;for(var i=0;i<this.globalUniforms.length;++i){var n=this.globalUniforms[i];this.setters[n]&&this.setters[n].set(this,n,null,null)}}},{key:"render",value:function(t){0!==t.worldTransform.det3x3()&&(this.combinedAttributes.clear(),t.environment&&this.combinedAttributes.setAttributes(t.environment.getAttributes()),t.material&&this.combinedAttributes.setAttributes(t.material.getAttributes()),this.renderWithCombinedAttributes(t,this.combinedAttributes))}},{key:"renderWithCombinedAttributes",value:function(t,e){for(var i,n=0;n<this.localUniforms.length;++n)this.setters[i=this.localUniforms[n]]&&this.setters[i].set(this,i,t,e);this.currentMesh!==t.meshPart.mesh&&(this.currentMesh&&this.currentMesh.unbind(this.program),this.currentMesh=t.meshPart.mesh,this.currentMesh.bind(this.program,this.getAttributeLocations(t.meshPart.mesh.getVertexAttributes()))),t.meshPart.render(this.program,!1)}},{key:"getAttributeLocations",value:function(t){this.tempArray.length=0;for(var e=t.size(),i=0;i<e;i++){var n=this.attributes.get(t.get(i).getKey());void 0!==n&&null!==n||(n=-1),this.tempArray.push(n)}return this.tempArray}},{key:"end",value:function(){this.currentMesh&&(this.currentMesh.unbind(this.program),this.currentMesh=null)}},{key:"dispose",value:function(){this.program=null,this.uniforms.length=0,this.validators.length=0,this.setters.length=0,this.localUniforms.length=0,this.globalUniforms.length=0,this.locations=null}},{key:"has",value:function(t){return t>=0&&t<this.locations.length&&!!this.locations[t]}},{key:"loc",value:function(t){return t>=0&&t<this.locations.length?this.locations[t]:null}},{key:"setMatrix4",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniform4x4f(this.uniforms[t],e.values),!0)}},{key:"setMatrix3",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniform3x3f(this.uniforms[t],e.getValues()),!0)}},{key:"setVector3",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniform3f(this.uniforms[t],e.x,e.y,e.z),!0)}},{key:"setVector2",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniform2f(this.uniforms[t],e.x,e.y),!0)}},{key:"setColor",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniform4f(this.uniforms[t],e.r,e.g,e.b,e.a),!0)}},{key:"setF",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniformf(this.uniforms[t],e),!0)}},{key:"set2f",value:function(t,e,i){return!!this.uniforms[t]&&(this.program.setUniform2f(this.uniforms[t],e,i),!0)}},{key:"set3f",value:function(t,e,i,n){return!!this.uniforms[t]&&(this.program.setUniform3f(this.uniforms[t],e,i,n),!0)}},{key:"set4f",value:function(t,e,i,n,r){return!!this.uniforms[t]&&(this.program.setUniform4f(this.uniforms[t],e,i,n,r),!0)}},{key:"setI",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniformi(this.uniforms[t],e),!0)}},{key:"setTexture",value:function(t,e){return!!this.uniforms[t]&&(this.program.setUniformi(this.uniforms[t],this.context.textureBinder.bindTexture(e)),!0)}}]),t}();e.BaseShader=u},375:function(t,e,i){"use strict";var n=i(4704).default,r=i(1588).default,s=i(3808).default,a=i(1655).default,o=i(6389).default,l=i(9728).default,u=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultShader=e.Setters=e.Inputs=e.Bones=e.ACubemap=e.Config=void 0;var h=i(176),c=i(5474),f=i(6403),d=i(8637),v=i(2668),p=i(3497),g=i(8213),m=i(4325),y=i(6730),M=i(1759),x=i(737),b=i(1686),w=i(5362),_=i(8737),T=i(2738),A=i(3249),k=i(7903),L=i(9671),S=i(7857),E=i(9203),C=i(6973),P=l((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";u(this,t),this.vertexShader=null,this.fragmentShader=null,this.numDirectionalLights=2,this.numPointLights=5,this.numSpotLights=0,this.numBones=12,this.ignoreUnimplemented=!0,this.defaultCullFace=-1,this.defaultDepthFunc=-1,this.vertexShader=e,this.fragmentShader=i}));e.Config=P;var R=function(t){a(i,t);var e=o(i);function i(t,n){var r;return u(this,i),(r=e.call(this)).cacheAmbientCubemap=new A.AmbientCubemap,r.dirLightsOffset=t,r.pointLightsOffset=n,r}return l(i,[{key:"set",value:function(t,e,n,r){if(n.environment){if(n.worldTransform.getTranslation(i.tmpV1),r.has(m.ColorAttribute3D.AmbientLight)){var s=r.get(m.ColorAttribute3D.AmbientLight).color;this.cacheAmbientCubemap.setColor(s.r,s.g,s.b)}if(r.has(y.DirectionalLightsAttribute.Type))for(var a=r.get(y.DirectionalLightsAttribute.Type).lights,o=this.dirLightsOffset;o<a.length;o++)this.cacheAmbientCubemap.addWithColorAndDirection(a[o].color,a[o].direction);this.cacheAmbientCubemap.clamp(),t.program.setUniform3fv(t.getUniformAlias(e),this.cacheAmbientCubemap.data)}else t.program.setUniform3fv(t.getUniformAlias(e),i.ones)}}]),i}(C.LocalSetter);e.ACubemap=R,R.ones=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],R.tmpV1=new v.Vector3;var I=function(t){a(i,t);var e=o(i);function i(t){var n;return u(this,i),(n=e.call(this)).bones=new Array(16*t),n}return l(i,[{key:"set",value:function(t,e,n,r){for(var s=0;s<this.bones.length;s+=16){var a=s/16;!n.bones||a>=n.bones.length||!n.bones[a]?d.Utils.arrayCopy(i.idtMatrix.values,0,this.bones,s,16):d.Utils.arrayCopy(n.bones[a].values,0,this.bones,s,16)}t.program.setUniform4x4fWithLocation(t.loc(e),this.bones)}}]),i}(C.LocalSetter);e.Bones=I,I.idtMatrix=new c.Matrix4;var F=l((function t(){u(this,t)}));e.Inputs=F,F.projTrans=new C.Uniform("u_projTrans"),F.viewTrans=new C.Uniform("u_viewTrans"),F.projViewTrans=new C.Uniform("u_projViewTrans"),F.cameraPosition=new C.Uniform("u_cameraPosition"),F.cameraDirection=new C.Uniform("u_cameraDirection"),F.cameraUp=new C.Uniform("u_cameraUp"),F.cameraNearFar=new C.Uniform("u_cameraNearFar"),F.worldTrans=new C.Uniform("u_worldTrans"),F.viewWorldTrans=new C.Uniform("u_viewWorldTrans"),F.projViewWorldTrans=new C.Uniform("u_projViewWorldTrans"),F.normalMatrix=new C.Uniform("u_normalMatrix"),F.bones=new C.Uniform("u_bones"),F.shininess=new C.Uniform("u_shininess",M.FloatAttribute.Shininess),F.opacity=new C.Uniform("u_opacity",g.BlendingAttribute.Type),F.diffuseColor=new C.Uniform("u_diffuseColor",m.ColorAttribute3D.Diffuse),F.diffuseTexture=new C.Uniform("u_diffuseTexture",_.TextureAttribute.Diffuse),F.diffuseUVTransform=new C.Uniform("u_diffuseUVTransform",_.TextureAttribute.Diffuse),F.specularColor=new C.Uniform("u_specularColor",m.ColorAttribute3D.Specular),F.specularTexture=new C.Uniform("u_specularTexture",_.TextureAttribute.Specular),F.specularUVTransform=new C.Uniform("u_specularUVTransform",_.TextureAttribute.Specular),F.emissiveColor=new C.Uniform("u_emissiveColor",m.ColorAttribute3D.Emissive),F.emissiveTexture=new C.Uniform("u_emissiveTexture",_.TextureAttribute.Emissive),F.emissiveUVTransform=new C.Uniform("u_emissiveUVTransform",_.TextureAttribute.Emissive),F.reflectionColor=new C.Uniform("u_reflectionColor",m.ColorAttribute3D.Reflection),F.reflectionTexture=new C.Uniform("u_reflectionTexture",_.TextureAttribute.Reflection),F.reflectionUVTransform=new C.Uniform("u_reflectionUVTransform",_.TextureAttribute.Reflection),F.normalTexture=new C.Uniform("u_normalTexture",_.TextureAttribute.Normal),F.normalUVTransform=new C.Uniform("u_normalUVTransform",_.TextureAttribute.Normal),F.ambientTexture=new C.Uniform("u_ambientTexture",_.TextureAttribute.Ambient),F.ambientUVTransform=new C.Uniform("u_ambientUVTransform",_.TextureAttribute.Ambient),F.alphaTest=new C.Uniform("u_alphaTest"),F.ambientCube=new C.Uniform("u_ambientCubemap"),F.dirLights=new C.Uniform("u_dirLights"),F.pointLights=new C.Uniform("u_pointLights"),F.spotLights=new C.Uniform("u_spotLights"),F.environmentCubemap=new C.Uniform("u_environmentCubemap");var G=l((function t(){u(this,t)}));e.Setters=G,G.projTrans=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setMatrix4(e,t.camera.projection)}}]),i}(C.GlobalSetter)),G.viewTrans=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setMatrix4(e,t.camera.view)}}]),i}(C.GlobalSetter)),G.projViewTrans=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setMatrix4(e,t.camera.combined)}}]),i}(C.GlobalSetter)),G.cameraPosition=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.set4f(e,t.camera.position.x,t.camera.position.y,t.camera.position.y,1.1881/(t.camera.far*t.camera.far))}}]),i}(C.GlobalSetter)),G.cameraDirection=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setVector3(e,t.camera.direction)}}]),i}(C.GlobalSetter)),G.cameraUp=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setVector3(e,t.camera.up)}}]),i}(C.GlobalSetter)),G.cameraNearFar=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.set2f(e,t.camera.near,t.camera.far)}}]),i}(C.GlobalSetter)),G.worldTrans=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setMatrix4(e,i.worldTransform)}}]),i}(C.LocalSetter)),G.viewWorldTrans=new(function(t){a(i,t);var e=o(i);function i(){var t;return u(this,i),(t=e.apply(this,arguments)).temp=new c.Matrix4,t}return l(i,[{key:"set",value:function(t,e,i,n){t.setMatrix4(e,this.temp.set(t.camera.view.values).multiply(i.worldTransform))}}]),i}(C.LocalSetter)),G.projViewWorldTrans=new(function(t){a(i,t);var e=o(i);function i(){var t;return u(this,i),(t=e.apply(this,arguments)).temp=new c.Matrix4,t}return l(i,[{key:"set",value:function(t,e,i,n){t.setMatrix4(e,this.temp.set(t.camera.combined.values).multiply(i.worldTransform))}}]),i}(C.LocalSetter)),G.normalMatrix=new(function(t){a(i,t);var e=o(i);function i(){var t;return u(this,i),(t=e.apply(this,arguments)).tmpM=new h.Matrix3,t}return l(i,[{key:"set",value:function(t,e,i,n){t.setMatrix3(e,this.tmpM.setByMatrix4(i.worldTransform).inv().transpose())}}]),i}(C.LocalSetter)),G.shininess=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setF(e,n.get(M.FloatAttribute.Shininess).value)}}]),i}(C.LocalSetter)),G.diffuseColor=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setColor(e,n.get(m.ColorAttribute3D.Diffuse).color)}}]),i}(C.LocalSetter)),G.diffuseTexture=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=t.context.textureBinder.bindTexture(n.get(_.TextureAttribute.Diffuse).texture);t.setI(e,r)}}]),i}(C.LocalSetter)),G.diffuseUVTransform=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=n.get(_.TextureAttribute.Diffuse);t.set4f(e,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(C.LocalSetter)),G.specularColor=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setColor(e,n.get(m.ColorAttribute3D.Specular).color)}}]),i}(C.LocalSetter)),G.specularTexture=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=t.context.textureBinder.bindTexture(n.get(_.TextureAttribute.Specular).texture);t.setI(e,r)}}]),i}(C.LocalSetter)),G.specularUVTransform=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=n.get(_.TextureAttribute.Specular);t.set4f(e,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(C.LocalSetter)),G.emissiveColor=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setColor(e,n.get(m.ColorAttribute3D.Emissive).color)}}]),i}(C.LocalSetter)),G.emissiveTexture=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=t.context.textureBinder.bindTexture(n.get(_.TextureAttribute.Emissive).texture);t.setI(e,r)}}]),i}(C.LocalSetter)),G.emissiveUVTransform=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=n.get(_.TextureAttribute.Emissive);t.set4f(e,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(C.LocalSetter)),G.reflectionColor=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){t.setColor(e,n.get(m.ColorAttribute3D.Reflection).color)}}]),i}(C.LocalSetter)),G.reflectionTexture=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=t.context.textureBinder.bindTexture(n.get(_.TextureAttribute.Reflection).texture);t.setI(e,r)}}]),i}(C.LocalSetter)),G.reflectionUVTransform=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=n.get(_.TextureAttribute.Reflection);t.set4f(e,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(C.LocalSetter)),G.normalTexture=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=t.context.textureBinder.bindTexture(n.get(_.TextureAttribute.Normal).texture);t.setI(e,r)}}]),i}(C.LocalSetter)),G.normalUVTransform=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=n.get(_.TextureAttribute.Normal);t.set4f(e,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(C.LocalSetter)),G.ambientTexture=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=t.context.textureBinder.bindTexture(n.get(_.TextureAttribute.Ambient).texture);t.setI(e,r)}}]),i}(C.LocalSetter)),G.ambientUVTransform=new(function(t){a(i,t);var e=o(i);function i(){return u(this,i),e.apply(this,arguments)}return l(i,[{key:"set",value:function(t,e,i,n){var r=n.get(_.TextureAttribute.Ambient);t.set4f(e,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(C.LocalSetter));var B=function(t){a(i,t);var e=o(i);function i(t,n){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return u(this,i),(r=e.call(this)).gl=t,r.u_dirLights0color=r.register("u_dirLights[0].color"),r.u_dirLights0direction=r.register("u_dirLights[0].direction"),r.u_dirLights1color=r.register("u_dirLights[1].color"),r.u_pointLights0color=r.register("u_pointLights[0].color"),r.u_pointLights0position=r.register("u_pointLights[0].position"),r.u_pointLights0intensity=r.register("u_pointLights[0].intensity"),r.u_pointLights1color=r.register("u_pointLights[1].color"),r.u_spotLights0color=r.register("u_spotLights[0].color"),r.u_spotLights0position=r.register("u_spotLights[0].position"),r.u_spotLights0intensity=r.register("u_spotLights[0].intensity"),r.u_spotLights0direction=r.register("u_spotLights[0].direction"),r.u_spotLights0cutoffAngle=r.register("u_spotLights[0].cutoffAngle"),r.u_spotLights0exponent=r.register("u_spotLights[0].exponent"),r.u_spotLights1color=r.register("u_spotLights[1].color"),r.u_fogColor=r.register("u_fogColor"),r.u_shadowMapProjViewTrans=r.register("u_shadowMapProjViewTrans"),r.u_shadowTexture=r.register("u_shadowTexture"),r.u_shadowPCFOffset=r.register("u_shadowPCFOffset"),r.lightLocs=new Array,r.ambientCubemap=new A.AmbientCubemap,r.tmpV1=new v.Vector3,0===o.length&&(o=i.defaultVertexShader),0===l.length&&(l=i.defaultFragmentShader),s?a=i.createPrefix(n,s):s=new P,r.createShader(n,s,new f.Shader(r.gl,a+o,a+l)),r}return l(i,[{key:"createShader",value:function(t,e,n){var r=i.combineAttributes(t);this.config=e,this.program=n,this.lighting=!!t.environment,this.environmentCubemap=!1,this.shadowMap=!1,this.renderable=t,this.attributesMask=r.getMask()|i.optionalAttributes,this.vertexMask=t.meshPart.mesh.getVertexAttributes().getMaskWithSizePacked(),this.directionalLights=new Array(this.lighting&&e.numDirectionalLights>0?e.numDirectionalLights:0);for(var s=0;s<this.directionalLights.length;s++)this.directionalLights[s]=new k.DirectionalLight;this.pointLights=new Array(this.lighting&&e.numPointLights>0?e.numPointLights:0);for(var a=0;a<this.pointLights.length;a++)this.pointLights[a]=new L.PointLight;this.spotLights=new Array(this.lighting&&e.numSpotLights>0?e.numSpotLights:0);for(var o=0;o<this.spotLights.length;o++)this.spotLights[o]=new S.SpotLight;if(!e.ignoreUnimplemented&&(i.implementedFlags&this.attributesMask)!==this.attributesMask)throw new Error("Some attributes not implemented yet ("+this.attributesMask+")");if(t.bones&&t.bones.length>e.numBones)throw new Error("too many bones: "+t.bones.length+", max configured: "+e.numBones);this.u_projTrans=this.register(F.projTrans.alias,null,G.projTrans),this.u_viewTrans=this.register(F.viewTrans.alias,null,G.viewTrans),this.u_projViewTrans=this.register(F.projViewTrans.alias,null,G.projViewTrans),this.u_cameraPosition=this.register(F.cameraPosition.alias,null,G.cameraPosition),this.u_cameraDirection=this.register(F.cameraDirection.alias,null,G.cameraDirection),this.u_cameraUp=this.register(F.cameraUp.alias,null,G.cameraUp),this.u_cameraNearFar=this.register(F.cameraNearFar.alias,null,G.cameraNearFar);var l=new C.Uniform("u_time");this.u_time=this.register(l.alias,l),this.u_worldTrans=this.register(F.worldTrans.alias,null,G.worldTrans),this.u_viewWorldTrans=this.register(F.viewWorldTrans.alias,null,G.viewWorldTrans),this.u_projViewWorldTrans=this.register(F.projViewWorldTrans.alias,null,G.projViewWorldTrans),this.u_normalMatrix=this.register(F.normalMatrix.alias,null,G.normalMatrix),this.u_bones=t.bones&&e.numBones>0?this.register(F.bones.alias,null,new I(e.numBones)):-1,this.u_shininess=this.register(F.shininess.alias,null,G.shininess),this.u_opacity=this.register(F.opacity.alias),this.u_diffuseColor=this.register(F.diffuseColor.alias,null,G.diffuseColor),this.u_diffuseTexture=this.register(F.diffuseTexture.alias,null,G.diffuseTexture),this.u_diffuseUVTransform=this.register(F.diffuseUVTransform.alias,null,G.diffuseUVTransform),this.u_specularColor=this.register(F.specularColor.alias,null,G.specularColor),this.u_specularTexture=this.register(F.specularTexture.alias,null,G.specularTexture),this.u_specularUVTransform=this.register(F.specularUVTransform.alias,null,G.specularUVTransform),this.u_emissiveColor=this.register(F.emissiveColor.alias,null,G.emissiveColor),this.u_emissiveTexture=this.register(F.emissiveTexture.alias,null,G.emissiveTexture),this.u_emissiveUVTransform=this.register(F.emissiveUVTransform.alias,null,G.emissiveUVTransform),this.u_reflectionColor=this.register(F.reflectionColor.alias,null,G.reflectionColor),this.u_reflectionTexture=this.register(F.reflectionTexture.alias,null,G.reflectionTexture),this.u_reflectionUVTransform=this.register(F.reflectionUVTransform.alias,null,G.reflectionUVTransform),this.u_normalTexture=this.register(F.normalTexture.alias,null,G.normalTexture),this.u_normalUVTransform=this.register(F.normalUVTransform.alias,null,G.normalUVTransform),this.u_ambientTexture=this.register(F.ambientTexture.alias,null,G.ambientTexture),this.u_ambientUVTransform=this.register(F.ambientUVTransform.alias,null,G.ambientUVTransform),this.u_alphaTest=this.register(F.alphaTest.alias),this.u_ambientCubemap=this.lighting?this.register(F.ambientCube.alias,null,new R(e.numDirectionalLights,e.numPointLights)):-1}},{key:"init",value:function(){var t=this.program;this.program=null,this.initWithVariables(t,this.renderable),this.renderable=null,this.dirLightsLoc=this.getLightLoc(this.u_dirLights0color),this.dirLightsColorOffset=this.getLightLoc(this.u_dirLights0color)-this.dirLightsLoc,this.dirLightsDirectionOffset=this.getLightLoc(this.u_dirLights0direction)-this.dirLightsLoc,this.dirLightsSize=this.getLightLoc(this.u_dirLights1color)-this.dirLightsLoc,this.dirLightsSize<0&&(this.dirLightsSize=0),this.pointLightsLoc=this.getLightLoc(this.u_pointLights0color),this.pointLightsColorOffset=this.getLightLoc(this.u_pointLights0color)-this.pointLightsLoc,this.pointLightsPositionOffset=this.getLightLoc(this.u_pointLights0position)-this.pointLightsLoc,this.pointLightsIntensityOffset=this.has(this.u_pointLights0intensity)?this.getLightLoc(this.u_pointLights0intensity)-this.pointLightsLoc:-1,this.pointLightsSize=this.getLightLoc(this.u_pointLights1color)-this.pointLightsLoc,this.pointLightsSize<0&&(this.pointLightsSize=0),this.spotLightsLoc=this.getLightLoc(this.u_spotLights0color),this.spotLightsColorOffset=this.getLightLoc(this.u_spotLights0color)-this.spotLightsLoc,this.spotLightsPositionOffset=this.getLightLoc(this.u_spotLights0position)-this.spotLightsLoc,this.spotLightsDirectionOffset=this.getLightLoc(this.u_spotLights0direction)-this.spotLightsLoc,this.spotLightsIntensityOffset=this.has(this.u_spotLights0intensity)?this.getLightLoc(this.u_spotLights0intensity)-this.spotLightsLoc:-1,this.spotLightsCutoffAngleOffset=this.getLightLoc(this.u_spotLights0cutoffAngle)-this.spotLightsLoc,this.spotLightsExponentOffset=this.getLightLoc(this.u_spotLights0exponent)-this.spotLightsLoc,this.spotLightsSize=this.getLightLoc(this.u_spotLights1color)-this.spotLightsLoc,this.spotLightsSize<0&&(this.spotLightsSize=0)}},{key:"canRender",value:function(t){if(t.bones&&t.bones.length>this.config.numBones)return!1;var e=i.combineAttributeMasks(t);return this.attributesMask===(e|i.optionalAttributes)&&this.vertexMask===t.meshPart.mesh.getVertexAttributes().getMaskWithSizePacked()&&!!t.environment===this.lighting}},{key:"begin",value:function(t,e){r(s(i.prototype),"begin",this).call(this,t,e);var a,o=n(this.directionalLights);try{for(o.s();!(a=o.n()).done;){a.value.set(0,0,0,0,-1,0)}}catch(f){o.e(f)}finally{o.f()}var l,u=n(this.pointLights);try{for(u.s();!(l=u.n()).done;){l.value.setFromValue(0,0,0,0,0,0,0)}}catch(f){u.e(f)}finally{u.f()}var h,c=n(this.spotLights);try{for(c.s();!(h=c.n()).done;){h.value.setFromValue(0,0,0,0,0,0,0,-1,0,0,1,0)}}catch(f){c.e(f)}finally{c.f()}this.lightsSet=!1}},{key:"renderWithCombinedAttributes",value:function(t,e){e.has(g.BlendingAttribute.Type)||this.context.setBlending(!1,E.GL20.GL_SRC_ALPHA,E.GL20.GL_ONE_MINUS_SRC_ALPHA),this.bindMaterial(e),this.lighting&&this.bindLights(t,e),r(s(i.prototype),"renderWithCombinedAttributes",this).call(this,t,e)}},{key:"end",value:function(){r(s(i.prototype),"end",this).call(this)}},{key:"bindMaterial",value:function(t){var e,r=-1===this.config.defaultCullFace?i.defaultCullFace:this.config.defaultCullFace,s=-1===this.config.defaultDepthFunc?i.defaultDepthFunc:this.config.defaultDepthFunc,a=n(t.getAttributes());try{for(a.s();!(e=a.n()).done;){var o=e.value,l=o.type;if(g.BlendingAttribute.is(l))this.context.setBlending(!0,o.sourceFunction,o.destFunction),this.setF(this.u_opacity,o.opacity);else if((l&x.IntAttribute.CullFace)===x.IntAttribute.CullFace)r=o.value;else if((l&M.FloatAttribute.AlphaTest)===M.FloatAttribute.AlphaTest)this.setF(this.u_alphaTest,o.value);else if(!this.config.ignoreUnimplemented)throw new Error("Unknown material attribute: "+o.toString())}}catch(u){a.e(u)}finally{a.f()}this.context.setCullFace(r),this.context.setDepthTest(s,0,1),this.context.setDepthMask(!0)}},{key:"bindLights",value:function(t,e){var i=e.get(y.DirectionalLightsAttribute.Type),n=i?i.lights:null,r=e.get(b.PointLightsAttribute.Type),s=r?r.lights:null,a=e.get(w.SpotLightsAttribute.Type),o=a?a.lights:null;if(this.dirLightsLoc>=0)for(var l=0;l<this.directionalLights.length;l++){if(!n||l>=n.length){if(this.lightsSet&&0===this.directionalLights[l].color.r&&0===this.directionalLights[l].color.g&&0===this.directionalLights[l].color.b)continue;this.directionalLights[l].color.set(0,0,0,1)}else{if(this.lightsSet&&this.directionalLights[l].equals(n[l]))continue;this.directionalLights[l].setFrom(n[l].color,n[l].direction)}var u=this.dirLightsLoc+l*this.dirLightsSize;if(this.program.setUniform3fWithLocation(this.lightLocs[u+this.dirLightsColorOffset],this.directionalLights[l].color.r,this.directionalLights[l].color.g,this.directionalLights[l].color.b),this.program.setUniform3fWithLocation(this.lightLocs[u+this.dirLightsDirectionOffset],this.directionalLights[l].direction.x,this.directionalLights[l].direction.y,this.directionalLights[l].direction.z),this.dirLightsSize<=0)break}if(this.pointLightsLoc>=0)for(var h=0;h<this.pointLights.length;h++){if(!s||h>=s.length){if(this.lightsSet&&0===this.pointLights[h].intensity)continue;this.pointLights[h].intensity=0}else{if(this.lightsSet&&this.pointLights[h].equals(s[h]))continue;this.pointLights[h].setFrom(s[h])}var c=this.pointLightsLoc+h*this.pointLightsSize;if(this.program.setUniform3fWithLocation(this.lightLocs[c+this.pointLightsColorOffset],this.pointLights[h].color.r*this.pointLights[h].intensity,this.pointLights[h].color.g*this.pointLights[h].intensity,this.pointLights[h].color.b*this.pointLights[h].intensity),this.program.setUniform3fWithLocation(this.lightLocs[c+this.pointLightsPositionOffset],this.pointLights[h].position.x,this.pointLights[h].position.y,this.pointLights[h].position.z),this.pointLightsIntensityOffset>=0&&this.program.setUniform1fWithLocation(this.lightLocs[c+this.pointLightsIntensityOffset],this.pointLights[h].intensity),this.pointLightsSize<=0)break}if(this.spotLightsLoc>=0)for(var f=0;f<this.spotLights.length;f++){if(!o||f>=o.length){if(this.lightsSet&&0===this.spotLights[f].intensity)continue;this.spotLights[f].intensity=0}else{if(this.lightsSet&&this.spotLights[f].equals(o[f]))continue;this.spotLights[f].setFrom(o[f])}var d=this.spotLightsLoc+f*this.spotLightsSize;if(this.program.setUniform3fWithLocation(this.lightLocs[d+this.spotLightsColorOffset],this.spotLights[f].color.r*this.spotLights[f].intensity,this.spotLights[f].color.g*this.spotLights[f].intensity,this.spotLights[f].color.b*this.spotLights[f].intensity),this.program.setUniform3fWithLocation(this.lightLocs[d+this.spotLightsPositionOffset],this.spotLights[f].position.x,this.spotLights[f].position.y,this.spotLights[f].position.z),this.program.setUniform3fWithLocation(this.lightLocs[d+this.spotLightsDirectionOffset],this.spotLights[f].direction.x,this.spotLights[f].direction.y,this.spotLights[f].direction.z),this.program.setUniform1fWithLocation(this.lightLocs[d+this.spotLightsCutoffAngleOffset],this.spotLights[f].cutoffAngle),this.program.setUniform1fWithLocation(this.lightLocs[d+this.spotLightsExponentOffset],this.spotLights[f].exponent),this.spotLightsIntensityOffset>=0&&this.program.setUniform1fWithLocation(this.lightLocs[d+this.spotLightsIntensityOffset],this.spotLights[f].intensity),this.spotLightsSize<=0)break}this.lightsSet=!0}},{key:"getLightLoc",value:function(t){var e=this.loc(t),i=this.lightLocs.indexOf(e);return e?i<0?(this.lightLocs.push(e),this.lightLocs.length-1):i:-1}},{key:"dispose",value:function(){this.program.dispose(),r(s(i.prototype),"dispose",this).call(this)}},{key:"getDefaultCullFace",value:function(){return-1===this.config.defaultCullFace?i.defaultCullFace:this.config.defaultCullFace}},{key:"setDefaultCullFace",value:function(t){this.config.defaultCullFace=t}},{key:"getDefaultDepthFunc",value:function(){return-1===this.config.defaultDepthFunc?i.defaultDepthFunc:this.config.defaultDepthFunc}},{key:"setDefaultDepthFunc",value:function(t){this.config.defaultDepthFunc=t}}],[{key:"and",value:function(t,e){return(t&e)===e}},{key:"or",value:function(t,e){return 0!==(t&e)}},{key:"combineAttributes",value:function(t){return this.tmpAttributes.clear(),t.environment&&this.tmpAttributes.setAttributes(t.environment.getAttributes()),t.material&&this.tmpAttributes.setAttributes(t.material.getAttributes()),this.tmpAttributes}},{key:"combineAttributeMasks",value:function(t){var e=0;return t.environment&&(e|=t.environment.getMask()),t.material&&(e|=t.material.getMask()),e}},{key:"createPrefix",value:function(t,e){var i=this.combineAttributes(t),n="",r=i.getMask(),s=t.meshPart.mesh.getVertexAttributes().getMask();this.and(s,T.Usage.Position)&&(n+="#define positionFlag\n"),this.or(s,T.Usage.ColorUnpacked|T.Usage.ColorPacked)&&(n+="#define colorFlag\n"),this.and(s,T.Usage.BiNormal)&&(n+="#define binormalFlag\n"),this.and(s,T.Usage.Tangent)&&(n+="#define tangentFlag\n"),this.and(s,T.Usage.Normal)&&(n+="#define normalFlag\n"),(this.and(s,T.Usage.Normal)||this.and(s,T.Usage.Tangent|T.Usage.BiNormal))&&t.environment&&(n+="#define lightingFlag\n",n+="#define ambientCubemapFlag\n",n+="#define numDirectionalLights "+e.numDirectionalLights+"\n",n+="#define numPointLights "+e.numPointLights+"\n",n+="#define numSpotLights "+e.numSpotLights+"\n",i.has(m.ColorAttribute3D.Fog)&&(n+="#define fogFlag\n"));for(var a=t.meshPart.mesh.getVertexAttributes().size(),o=0;o<a;o++){var l=t.meshPart.mesh.getVertexAttributes().get(o);l.usage===T.Usage.BoneWeight?n+="#define boneWeight"+l.unit+"Flag\n":l.usage===T.Usage.TextureCoordinates&&(n+="#define texCoords"+l.unit+"Flag\n")}return(r&g.BlendingAttribute.Type)===g.BlendingAttribute.Type&&(n+="#define "+g.BlendingAttribute.Alias+"Flag\n"),(r&_.TextureAttribute.Diffuse)===_.TextureAttribute.Diffuse&&(n+="#define "+_.TextureAttribute.DiffuseAlias+"Flag\n",n+="#define "+_.TextureAttribute.DiffuseAlias+"Coord texCoords0\n"),(r&_.TextureAttribute.Specular)===_.TextureAttribute.Specular&&(n+="#define "+_.TextureAttribute.SpecularAlias+"Flag\n",n+="#define "+_.TextureAttribute.SpecularAlias+"Coord texCoords0\n"),(r&_.TextureAttribute.Normal)===_.TextureAttribute.Normal&&(n+="#define "+_.TextureAttribute.NormalAlias+"Flag\n",n+="#define "+_.TextureAttribute.NormalAlias+"Coord texCoords0\n"),(r&_.TextureAttribute.Emissive)===_.TextureAttribute.Emissive&&(n+="#define "+_.TextureAttribute.EmissiveAlias+"Flag\n",n+="#define "+_.TextureAttribute.EmissiveAlias+"Coord texCoords0\n"),(r&_.TextureAttribute.Reflection)===_.TextureAttribute.Reflection&&(n+="#define "+_.TextureAttribute.ReflectionAlias+"Flag\n",n+="#define "+_.TextureAttribute.ReflectionAlias+"Coord texCoords0\n"),(r&_.TextureAttribute.Ambient)===_.TextureAttribute.Ambient&&(n+="#define "+_.TextureAttribute.AmbientAlias+"Flag\n",n+="#define "+_.TextureAttribute.AmbientAlias+"Coord texCoords0\n"),(r&m.ColorAttribute3D.Diffuse)===m.ColorAttribute3D.Diffuse&&(n+="#define "+m.ColorAttribute3D.DiffuseAlias+"Flag\n"),(r&m.ColorAttribute3D.Specular)===m.ColorAttribute3D.Specular&&(n+="#define "+m.ColorAttribute3D.SpecularAlias+"Flag\n"),(r&m.ColorAttribute3D.Emissive)===m.ColorAttribute3D.Emissive&&(n+="#define "+m.ColorAttribute3D.EmissiveAlias+"Flag\n"),(r&m.ColorAttribute3D.Reflection)===m.ColorAttribute3D.Reflection&&(n+="#define "+m.ColorAttribute3D.ReflectionAlias+"Flag\n"),(r&M.FloatAttribute.Shininess)===M.FloatAttribute.Shininess&&(n+="#define "+M.FloatAttribute.ShininessAlias+"Flag\n"),(r&M.FloatAttribute.AlphaTest)===M.FloatAttribute.AlphaTest&&(n+="#define "+M.FloatAttribute.AlphaTestAlias+"Flag\n"),t.bones&&e.numBones>0&&(n+="#define numBones "+e.numBones+"\n"),n}}]),i}(C.BaseShader);e.DefaultShader=B,B.defaultVertexShader="\n  #if defined(diffuseTextureFlag) || defined(specularTextureFlag) || defined(emissiveTextureFlag)\n  #define textureFlag\n  #endif\n\n  #if defined(specularTextureFlag) || defined(specularColorFlag)\n  #define specularFlag\n  #endif\n\n  #if defined(specularFlag) || defined(fogFlag)\n  #define cameraPositionFlag\n  #endif\n\n  attribute vec3 a_position;\n  uniform mat4 u_projViewTrans;\n\n  #if defined(colorFlag)\n  varying vec4 v_color;\n  attribute vec4 a_color;\n  #endif // colorFlag\n\n  #ifdef normalFlag\n  attribute vec3 a_normal;\n  uniform mat3 u_normalMatrix;\n  varying vec3 v_normal;\n  #endif // normalFlag\n\n  #ifdef textureFlag\n  attribute vec2 a_texCoords0;\n  #endif // textureFlag\n\n  #ifdef diffuseTextureFlag\n  uniform vec4 u_diffuseUVTransform;\n  varying vec2 v_diffuseUV;\n  #endif\n\n  #ifdef emissiveTextureFlag\n  uniform vec4 u_emissiveUVTransform;\n  varying vec2 v_emissiveUV;\n  #endif\n\n  #ifdef specularTextureFlag\n  uniform vec4 u_specularUVTransform;\n  varying vec2 v_specularUV;\n  #endif\n\n  #ifdef boneWeight0Flag\n  #define boneWeightsFlag\n  attribute vec2 a_boneWeight0;\n  #endif //boneWeight0Flag\n\n  #ifdef boneWeight1Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight1;\n  #endif //boneWeight1Flag\n\n  #ifdef boneWeight2Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight2;\n  #endif //boneWeight2Flag\n\n  #ifdef boneWeight3Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight3;\n  #endif //boneWeight3Flag\n\n  #ifdef boneWeight4Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight4;\n  #endif //boneWeight4Flag\n\n  #ifdef boneWeight5Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight5;\n  #endif //boneWeight5Flag\n\n  #ifdef boneWeight6Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight6;\n  #endif //boneWeight6Flag\n\n  #ifdef boneWeight7Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight7;\n  #endif //boneWeight7Flag\n\n  #if defined(numBones) && defined(boneWeightsFlag)\n  #if (numBones > 0) \n  #define skinningFlag\n  #endif\n  #endif\n\n  uniform mat4 u_worldTrans;\n\n  #if defined(numBones)\n  #if numBones > 0\n  uniform mat4 u_bones[numBones];\n  #endif //numBones\n  #endif\n\n  #ifdef shininessFlag\n  uniform float u_shininess;\n  #else\n  const float u_shininess = 20.0;\n  #endif // shininessFlag\n\n  #ifdef blendedFlag\n  uniform float u_opacity;\n  varying float v_opacity;\n\n  #ifdef alphaTestFlag\n  uniform float u_alphaTest;\n  varying float v_alphaTest;\n  #endif //alphaTestFlag\n  #endif // blendedFlag\n\n  #ifdef lightingFlag\n  varying vec3 v_lightDiffuse;\n\n  #ifdef ambientLightFlag\n  uniform vec3 u_ambientLight;\n  #endif // ambientLightFlag\n\n  #ifdef ambientCubemapFlag\n  uniform vec3 u_ambientCubemap[6];\n  #endif // ambientCubemapFlag \n\n  #ifdef sphericalHarmonicsFlag\n  uniform vec3 u_sphericalHarmonics[9];\n  #endif //sphericalHarmonicsFlag\n\n  #ifdef specularFlag\n  varying vec3 v_lightSpecular;\n  #endif // specularFlag\n\n  #ifdef cameraPositionFlag\n  uniform vec4 u_cameraPosition;\n  #endif // cameraPositionFlag\n\n  #ifdef fogFlag\n  varying float v_fog;\n  #endif // fogFlag\n\n\n  #if numDirectionalLights > 0\n  struct DirectionalLight\n  {\n    vec3 color;\n    vec3 direction;\n  };\n  uniform DirectionalLight u_dirLights[numDirectionalLights];\n  #endif // numDirectionalLights\n\n  #if numPointLights > 0\n  struct PointLight\n  {\n    vec3 color;\n    vec3 position;\n  };\n  uniform PointLight u_pointLights[numPointLights];\n  #endif // numPointLights\n\n  #if\tdefined(ambientLightFlag) || defined(ambientCubemapFlag) || defined(sphericalHarmonicsFlag)\n  #define ambientFlag\n  #endif //ambientFlag\n\n  #ifdef shadowMapFlag\n  uniform mat4 u_shadowMapProjViewTrans;\n  varying vec3 v_shadowMapUv;\n  #define separateAmbientFlag\n  #endif //shadowMapFlag\n\n  #if defined(ambientFlag) && defined(separateAmbientFlag)\n  varying vec3 v_ambientLight;\n  #endif //separateAmbientFlag\n\n  #endif // lightingFlag\n\n  void main() {\n    #ifdef diffuseTextureFlag\n      v_diffuseUV = u_diffuseUVTransform.xy + a_texCoords0 * u_diffuseUVTransform.zw;\n    #endif //diffuseTextureFlag\n    \n    #ifdef emissiveTextureFlag\n      v_emissiveUV = u_emissiveUVTransform.xy + a_texCoords0 * u_emissiveUVTransform.zw;\n    #endif //emissiveTextureFlag\n\n    #ifdef specularTextureFlag\n      v_specularUV = u_specularUVTransform.xy + a_texCoords0 * u_specularUVTransform.zw;\n    #endif //specularTextureFlag\n    \n    #if defined(colorFlag)\n      v_color = a_color;\n    #endif // colorFlag\n      \n    #ifdef blendedFlag\n      v_opacity = u_opacity;\n      #ifdef alphaTestFlag\n        v_alphaTest = u_alphaTest;\n      #endif //alphaTestFlag\n    #endif // blendedFlag\n    \n    #ifdef skinningFlag\n      mat4 skinning = mat4(0.0);\n      #ifdef boneWeight0Flag\n        skinning += (a_boneWeight0.y) * u_bones[int(a_boneWeight0.x)];\n      #endif //boneWeight0Flag\n      #ifdef boneWeight1Flag\t\t\t\t\n        skinning += (a_boneWeight1.y) * u_bones[int(a_boneWeight1.x)];\n      #endif //boneWeight1Flag\n      #ifdef boneWeight2Flag\t\t\n        skinning += (a_boneWeight2.y) * u_bones[int(a_boneWeight2.x)];\n      #endif //boneWeight2Flag\n      #ifdef boneWeight3Flag\n        skinning += (a_boneWeight3.y) * u_bones[int(a_boneWeight3.x)];\n      #endif //boneWeight3Flag\n      #ifdef boneWeight4Flag\n        skinning += (a_boneWeight4.y) * u_bones[int(a_boneWeight4.x)];\n      #endif //boneWeight4Flag\n      #ifdef boneWeight5Flag\n        skinning += (a_boneWeight5.y) * u_bones[int(a_boneWeight5.x)];\n      #endif //boneWeight5Flag\n      #ifdef boneWeight6Flag\n        skinning += (a_boneWeight6.y) * u_bones[int(a_boneWeight6.x)];\n      #endif //boneWeight6Flag\n      #ifdef boneWeight7Flag\n        skinning += (a_boneWeight7.y) * u_bones[int(a_boneWeight7.x)];\n      #endif //boneWeight7Flag\n    #endif //skinningFlag\n\n    #ifdef skinningFlag\n      vec4 pos = u_worldTrans * skinning * vec4(a_position, 1.0);\n    #else\n      vec4 pos = u_worldTrans * vec4(a_position, 1.0);\n    #endif\n      \n    gl_Position = u_projViewTrans * pos;\n      \n    #ifdef shadowMapFlag\n      vec4 spos = u_shadowMapProjViewTrans * pos;\n      v_shadowMapUv.xyz = (spos.xyz / spos.w) * 0.5 + 0.5;\n      v_shadowMapUv.z = min(v_shadowMapUv.z, 0.998);\n    #endif //shadowMapFlag\n    \n    #if defined(normalFlag)\n      #if defined(skinningFlag)\n        vec3 normal = normalize((u_worldTrans * skinning * vec4(a_normal, 0.0)).xyz);\n      #else\n        vec3 normal = normalize(u_normalMatrix * a_normal);\n      #endif\n      v_normal = normal;\n    #endif // normalFlag\n\n      #ifdef fogFlag\n          vec3 flen = u_cameraPosition.xyz - pos.xyz;\n          float fog = dot(flen, flen) * u_cameraPosition.w;\n          v_fog = min(fog, 1.0);\n      #endif\n\n    #ifdef lightingFlag\n      #if\tdefined(ambientLightFlag)\n            vec3 ambientLight = u_ambientLight;\n      #elif defined(ambientFlag)\n            vec3 ambientLight = vec3(0.0);\n      #endif\n        \n      #ifdef ambientCubemapFlag \t\t\n        vec3 squaredNormal = normal * normal;\n        vec3 isPositive  = step(0.0, normal);\n        ambientLight += squaredNormal.x * mix(u_ambientCubemap[0], u_ambientCubemap[1], isPositive.x) +\n            squaredNormal.y * mix(u_ambientCubemap[2], u_ambientCubemap[3], isPositive.y) +\n            squaredNormal.z * mix(u_ambientCubemap[4], u_ambientCubemap[5], isPositive.z);\n      #endif // ambientCubemapFlag\n\n      #ifdef sphericalHarmonicsFlag\n        ambientLight += u_sphericalHarmonics[0];\n        ambientLight += u_sphericalHarmonics[1] * normal.x;\n        ambientLight += u_sphericalHarmonics[2] * normal.y;\n        ambientLight += u_sphericalHarmonics[3] * normal.z;\n        ambientLight += u_sphericalHarmonics[4] * (normal.x * normal.z);\n        ambientLight += u_sphericalHarmonics[5] * (normal.z * normal.y);\n        ambientLight += u_sphericalHarmonics[6] * (normal.y * normal.x);\n        ambientLight += u_sphericalHarmonics[7] * (3.0 * normal.z * normal.z - 1.0);\n        ambientLight += u_sphericalHarmonics[8] * (normal.x * normal.x - normal.y * normal.y);\t\t\t\n      #endif // sphericalHarmonicsFlag\n\n      #ifdef ambientFlag\n        #ifdef separateAmbientFlag\n          v_ambientLight = ambientLight;\n          v_lightDiffuse = vec3(0.0);\n        #else\n          v_lightDiffuse = ambientLight;\n        #endif //separateAmbientFlag\n      #else\n            v_lightDiffuse = vec3(0.0);\n      #endif //ambientFlag\n\n        \n      #ifdef specularFlag\n        v_lightSpecular = vec3(0.0);\n        vec3 viewVec = normalize(u_cameraPosition.xyz - pos.xyz);\n      #endif // specularFlag\n        \n      #if (numDirectionalLights > 0) && defined(normalFlag)\n        for (int i = 0; i < numDirectionalLights; i++) {\n          vec3 lightDir = -u_dirLights[i].direction;\n          float NdotL = clamp(dot(normal, lightDir), 0.0, 1.0);\n          vec3 value = u_dirLights[i].color * NdotL;\n          v_lightDiffuse += value;\n          #ifdef specularFlag\n            float halfDotView = max(0.0, dot(normal, normalize(lightDir + viewVec)));\n            v_lightSpecular += value * pow(halfDotView, u_shininess);\n          #endif // specularFlag\n        }\n      #endif // numDirectionalLights\n\n      #if (numPointLights > 0) && defined(normalFlag)\n        for (int i = 0; i < numPointLights; i++) {\n          vec3 lightDir = u_pointLights[i].position - pos.xyz;\n          float dist2 = dot(lightDir, lightDir);\n          lightDir *= inversesqrt(dist2);\n          float NdotL = clamp(dot(normal, lightDir), 0.0, 1.0);\n          vec3 value = u_pointLights[i].color * (NdotL / (1.0 + dist2));\n          v_lightDiffuse += value;\n          #ifdef specularFlag\n            float halfDotView = max(0.0, dot(normal, normalize(lightDir + viewVec)));\n            v_lightSpecular += value * pow(halfDotView, u_shininess);\n          #endif // specularFlag\n        }\n      #endif // numPointLights\n    #endif // lightingFlag\n  }\n  ",B.defaultFragmentShader="\n  #ifdef GL_ES\n  #define LOWP lowp\n  #define MED mediump\n  #define HIGH highp\n  precision mediump float;\n  #else\n  #define MED\n  #define LOWP\n  #define HIGH\n  #endif\n\n  #if defined(specularTextureFlag) || defined(specularColorFlag)\n  #define specularFlag\n  #endif\n\n  #ifdef normalFlag\n  varying vec3 v_normal;\n  #endif //normalFlag\n\n  #if defined(colorFlag)\n  varying vec4 v_color;\n  #endif\n\n  #ifdef blendedFlag\n  varying float v_opacity;\n  #ifdef alphaTestFlag\n  varying float v_alphaTest;\n  #endif //alphaTestFlag\n  #endif //blendedFlag\n\n  #if defined(diffuseTextureFlag) || defined(specularTextureFlag) || defined(emissiveTextureFlag)\n  #define textureFlag\n  #endif\n\n  #ifdef diffuseTextureFlag\n  varying MED vec2 v_diffuseUV;\n  #endif\n\n  #ifdef specularTextureFlag\n  varying MED vec2 v_specularUV;\n  #endif\n\n  #ifdef emissiveTextureFlag\n  varying MED vec2 v_emissiveUV;\n  #endif\n\n  #ifdef diffuseColorFlag\n  uniform vec4 u_diffuseColor;\n  #endif\n\n  #ifdef diffuseTextureFlag\n  uniform sampler2D u_diffuseTexture;\n  #endif\n\n  #ifdef specularColorFlag\n  uniform vec4 u_specularColor;\n  #endif\n\n  #ifdef specularTextureFlag\n  uniform sampler2D u_specularTexture;\n  #endif\n\n  #ifdef normalTextureFlag\n  uniform sampler2D u_normalTexture;\n  #endif\n\n  #ifdef emissiveColorFlag\n  uniform vec4 u_emissiveColor;\n  #endif\n\n  #ifdef emissiveTextureFlag\n  uniform sampler2D u_emissiveTexture;\n  #endif\n\n  #ifdef lightingFlag\n  varying vec3 v_lightDiffuse;\n\n  #if\tdefined(ambientLightFlag) || defined(ambientCubemapFlag) || defined(sphericalHarmonicsFlag)\n  #define ambientFlag\n  #endif //ambientFlag\n\n  #ifdef specularFlag\n  varying vec3 v_lightSpecular;\n  #endif //specularFlag\n\n  #ifdef shadowMapFlag\n  uniform sampler2D u_shadowTexture;\n  uniform float u_shadowPCFOffset;\n  varying vec3 v_shadowMapUv;\n  #define separateAmbientFlag\n\n  float getShadowness(vec2 offset)\n  {\n      const vec4 bitShifts = vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0);\n      return step(v_shadowMapUv.z, dot(texture2D(u_shadowTexture, v_shadowMapUv.xy + offset), bitShifts));//+(1.0/255.0));\n  }\n\n  float getShadow()\n  {\n    return (//getShadowness(vec2(0,0)) +\n        getShadowness(vec2(u_shadowPCFOffset, u_shadowPCFOffset)) +\n        getShadowness(vec2(-u_shadowPCFOffset, u_shadowPCFOffset)) +\n        getShadowness(vec2(u_shadowPCFOffset, -u_shadowPCFOffset)) +\n        getShadowness(vec2(-u_shadowPCFOffset, -u_shadowPCFOffset))) * 0.25;\n  }\n  #endif //shadowMapFlag\n\n  #if defined(ambientFlag) && defined(separateAmbientFlag)\n  varying vec3 v_ambientLight;\n  #endif //separateAmbientFlag\n\n  #endif //lightingFlag\n\n  #ifdef fogFlag\n  uniform vec4 u_fogColor;\n  varying float v_fog;\n  #endif // fogFlag\n\n  void main() {\n    #if defined(normalFlag)\n      vec3 normal = v_normal;\n    #endif // normalFlag\n\n    #if defined(diffuseTextureFlag) && defined(diffuseColorFlag) && defined(colorFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV) * u_diffuseColor * v_color;\n    #elif defined(diffuseTextureFlag) && defined(diffuseColorFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV) * u_diffuseColor;\n    #elif defined(diffuseTextureFlag) && defined(colorFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV) * v_color;\n    #elif defined(diffuseTextureFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV);\n    #elif defined(diffuseColorFlag) && defined(colorFlag)\n      vec4 diffuse = u_diffuseColor * v_color;\n    #elif defined(diffuseColorFlag)\n      vec4 diffuse = u_diffuseColor;\n    #elif defined(colorFlag)\n      vec4 diffuse = v_color;\n    #else\n      vec4 diffuse = vec4(1.0);\n    #endif\n\n    #if defined(emissiveTextureFlag) && defined(emissiveColorFlag)\n      vec4 emissive = texture2D(u_emissiveTexture, v_emissiveUV) * u_emissiveColor;\n    #elif defined(emissiveTextureFlag)\n      vec4 emissive = texture2D(u_emissiveTexture, v_emissiveUV);\n    #elif defined(emissiveColorFlag)\n      vec4 emissive = u_emissiveColor;\n    #else\n      vec4 emissive = vec4(0.0);\n    #endif\n\n    #if (!defined(lightingFlag))\n      gl_FragColor.rgb = diffuse.rgb + emissive.rgb;\n    #elif (!defined(specularFlag))\n      #if defined(ambientFlag) && defined(separateAmbientFlag)\n        #ifdef shadowMapFlag\n          gl_FragColor.rgb = (diffuse.rgb * (v_ambientLight + getShadow() * v_lightDiffuse)) + emissive.rgb;\n          //gl_FragColor.rgb = texture2D(u_shadowTexture, v_shadowMapUv.xy);\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * (v_ambientLight + v_lightDiffuse)) + emissive.rgb;\n        #endif //shadowMapFlag\n      #else\n        #ifdef shadowMapFlag\n          gl_FragColor.rgb = getShadow() * (diffuse.rgb * v_lightDiffuse) + emissive.rgb;\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * v_lightDiffuse) + emissive.rgb;\n        #endif //shadowMapFlag\n      #endif\n    #else\n      #if defined(specularTextureFlag) && defined(specularColorFlag)\n        vec3 specular = texture2D(u_specularTexture, v_specularUV).rgb * u_specularColor.rgb * v_lightSpecular;\n      #elif defined(specularTextureFlag)\n        vec3 specular = texture2D(u_specularTexture, v_specularUV).rgb * v_lightSpecular;\n      #elif defined(specularColorFlag)\n        vec3 specular = u_specularColor.rgb * v_lightSpecular;\n      #else\n        vec3 specular = v_lightSpecular;\n      #endif\n\n      #if defined(ambientFlag) && defined(separateAmbientFlag)\n        #ifdef shadowMapFlag\n        gl_FragColor.rgb = (diffuse.rgb * (getShadow() * v_lightDiffuse + v_ambientLight)) + specular + emissive.rgb;\n          //gl_FragColor.rgb = texture2D(u_shadowTexture, v_shadowMapUv.xy);\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * (v_lightDiffuse + v_ambientLight)) + specular + emissive.rgb;\n        #endif //shadowMapFlag\n      #else\n        #ifdef shadowMapFlag\n          gl_FragColor.rgb = getShadow() * ((diffuse.rgb * v_lightDiffuse) + specular) + emissive.rgb;\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * v_lightDiffuse) + specular + emissive.rgb;\n        #endif //shadowMapFlag\n      #endif\n    #endif //lightingFlag\n\n    #ifdef fogFlag\n      gl_FragColor.rgb = mix(gl_FragColor.rgb, u_fogColor.rgb, v_fog);\n    #endif // end fogFlag\n\n    #ifdef blendedFlag\n      gl_FragColor.a = diffuse.a * v_opacity;\n      #ifdef alphaTestFlag\n        if (gl_FragColor.a <= v_alphaTest)\n          discard;\n      #endif\n    #else\n      gl_FragColor.a = 1.0;\n    #endif\n  }\n  ",B.implementedFlags=g.BlendingAttribute.Type|_.TextureAttribute.Diffuse|m.ColorAttribute3D.Diffuse|m.ColorAttribute3D.Specular|M.FloatAttribute.Shininess,B.defaultCullFace=E.GL20.GL_BACK,B.defaultDepthFunc=E.GL20.GL_LEQUAL,B.optionalAttributes=x.IntAttribute.CullFace,B.tmpAttributes=new p.Attributes},6716:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},986:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(6973),e),r(i(375),e),r(i(6716),e)},849:function(t,e,i){"use strict";var n=i(1655).default,r=i(6389).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationController=e.AnimationDesc=void 0;var o=i(8637),l=i(6520),u=function(){function t(){s(this,t),this.listener=null,this.animation=null,this.speed=0,this.time=0,this.offset=0,this.duration=0,this.loopCount=0}return a(t,[{key:"update",value:function(t){if(0!==this.loopCount&&this.animation){var e,i=this.speed*t;if(o.MathUtils.isZero(this.duration))e=1;else if(this.time+=i,this.speed<0){var n=this.duration-this.time;e=Math.floor(Math.abs(n/this.duration)),n=Math.abs(n%this.duration),this.time=this.duration-n}else e=Math.floor(Math.abs(this.time/this.duration)),this.time=Math.abs(this.time%this.duration);for(var r=0;r<e;r++)if(this.loopCount>0&&this.loopCount--,0!==this.loopCount&&this.listener&&this.listener.onLoop(this),0===this.loopCount){var s=(e-1-r)*this.duration+(i<0?this.duration-this.time:this.time);return this.time=i<0?0:this.duration,this.listener&&this.listener.onEnd(this),s}return-1}return t}}]),t}();e.AnimationDesc=u;var h=function(t){n(i,t);var e=r(i);function i(){var t;return s(this,i),(t=e.apply(this,arguments)).animationPool=new o.Pool((function(){return new u})),t.current=null,t.queued=null,t.queuedTransitionTime=0,t.previous=null,t.transitionCurrentTime=0,t.transitionTargetTime=0,t.inAction=!1,t.paused=!1,t.allowSameAnimation=!1,t.justChangedAnimation=!1,t}return a(i,[{key:"obtainAnimation",value:function(t,e,i,n,r,s){if(!t)return null;var a=this.animationPool.obtain();return a.animation=t,a.listener=s,a.loopCount=n,a.speed=r,a.offset=e,a.duration=i<0?t.duration-e:i,a.time=r<0?a.duration:0,a}},{key:"obtain",value:function(t,e,i,n,r,s){if(!t)return null;var a=this.target.getAnimation(t);if(!a)throw new Error("Unknown animation: "+t);return this.obtainAnimation(a,e,i,n,r,s)}},{key:"obtainAnimationDesc",value:function(t){return this.obtainAnimation(t.animation,t.offset,t.duration,t.loopCount,t.speed,t.listener)}},{key:"update",value:function(t){if(!this.paused&&(this.previous&&(this.transitionCurrentTime+=t)>=this.transitionTargetTime&&(this.removeAnimation(this.previous.animation),this.justChangedAnimation=!0,this.animationPool.free(this.previous),this.previous=null),this.justChangedAnimation&&(this.target.calculateTransforms(),this.justChangedAnimation=!1),this.current&&0!==this.current.loopCount&&this.current.animation)){var e=this.current.update(t);if(e>=0&&this.queued)return this.inAction=!1,this.actionWithAnimationDesc(this.queued,this.queuedTransitionTime),this.queued=null,void(e>0&&this.update(e));this.previous?this.applyAnimations(this.previous.animation,this.previous.offset+this.previous.time,this.current.animation,this.current.offset+this.current.time,this.transitionCurrentTime/this.transitionTargetTime):this.applyAnimation(this.current.animation,this.current.offset+this.current.time)}}},{key:"setAnimation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.setAnimationWithOffset(t,0,-1,e,i,n)}},{key:"setAnimationWithOffset",value:function(t,e,i,n,r,s){return this.setAnimationWithAnimationDesc(this.obtain(t,e,i,n,r,s))}},{key:"setAnimationWithAnimation",value:function(t,e,i,n,r,s){return this.setAnimationWithAnimationDesc(this.obtainAnimation(t,e,i,n,r,s))}},{key:"setAnimationWithAnimationDesc",value:function(t){return this.current?(!this.allowSameAnimation&&t&&this.current.animation===t.animation?t.time=this.current.time:this.removeAnimation(this.current.animation),this.animationPool.free(this.current),this.current=t):this.current=t,this.justChangedAnimation=!0,t}},{key:"animate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0;return this.animateWithOffset(t,0,-1,e,i,n,r)}},{key:"animateWithOffset",value:function(t,e,i,n,r,s,a){return this.animateWithAnimationDesc(this.obtain(t,e,i,n,r,s),a)}},{key:"animateWithAnimation",value:function(t,e,i,n,r,s,a){return this.animateWithAnimationDesc(this.obtainAnimation(t,e,i,n,r,s),a)}},{key:"animateWithAnimationDesc",value:function(t,e){return this.current&&0!==this.current.loopCount?this.inAction?this.queueWithAnimationDesc(t,e):!this.allowSameAnimation&&t&&this.current.animation===t.animation?(t.time=this.current.time,this.animationPool.free(this.current),this.current=t):(this.previous&&(this.removeAnimation(this.previous.animation),this.animationPool.free(this.previous)),this.previous=this.current,this.current=t,this.transitionCurrentTime=0,this.transitionTargetTime=e):this.current=t,t}},{key:"queue",value:function(t,e,i,n,r){return this.queueWithOffset(t,0,-1,e,i,n,r)}},{key:"queueWithOffset",value:function(t,e,i,n,r,s,a){return this.queueWithAnimationDesc(this.obtain(t,e,i,n,r,s),a)}},{key:"queueWithAnimation",value:function(t,e,i,n,r,s,a){return this.queueWithAnimationDesc(this.obtainAnimation(t,e,i,n,r,s),a)}},{key:"queueWithAnimationDesc",value:function(t,e){return this.current&&0!==this.current.loopCount?(this.queued&&this.animationPool.free(this.queued),this.queued=t,this.queuedTransitionTime=e,this.current.loopCount<0&&(this.current.loopCount=1)):this.animateWithAnimationDesc(t,e),t}},{key:"action",value:function(t,e,i,n,r){return this.actionWithOffset(t,0,-1,e,i,n,r)}},{key:"actionWithOffset",value:function(t,e,i,n,r,s,a){return this.actionWithAnimationDesc(this.obtain(t,e,i,n,r,s),a)}},{key:"actionWithAnimation",value:function(t,e,i,n,r,s,a){return this.actionWithAnimationDesc(this.obtainAnimation(t,e,i,n,r,s),a)}},{key:"actionWithAnimationDesc",value:function(t,e){if(t.loopCount<0)throw new Error("An action cannot be continuous");if(this.current&&0!==this.current.loopCount){var i=this.inAction?null:this.obtainAnimationDesc(this.current);this.inAction=!1,this.animateWithAnimationDesc(t,e),this.inAction=!0,i&&this.queueWithAnimationDesc(i,e)}else this.animateWithAnimationDesc(t,e);return t}}]),i}(l.BaseAnimationController);e.AnimationController=h},6520:function(t,e,i){"use strict";var n=i(7424).default,r=i(4704).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BaseAnimationController=e.Transform=void 0;var o=i(4496),l=i(8637),u=i(2668),h=function(){function t(){s(this,t),this.translation=new u.Vector3,this.rotation=new o.Quaternion,this.scale=new u.Vector3(1,1,1)}return a(t,[{key:"idt",value:function(){return this.translation.set(0,0,0),this.rotation.idt(),this.scale.set(1,1,1),this}},{key:"set",value:function(t,e,i){return this.translation.setFrom(t),this.rotation.setFrom(e),this.scale.setFrom(i),this}},{key:"setFrom",value:function(t){return this.set(t.translation,t.rotation,t.scale)}},{key:"lerpWithTranform",value:function(t,e){return this.lerp(t.translation,t.rotation,t.scale,e)}},{key:"lerp",value:function(t,e,i,n){return this.translation.lerp(t,n),this.rotation.slerp(e,n),this.scale.lerp(i,n),this}},{key:"toMatrix4",value:function(t){return t.setFromTranslationRotation(this.translation,this.rotation,this.scale)}},{key:"reset",value:function(){this.idt()}},{key:"toString",value:function(){return this.translation.toString()+" - "+this.rotation.toString()+" - "+this.scale.toString()}}]),t}();e.Transform=h;var c=function(){function t(e){s(this,t),this.transformPool=new l.Pool((function(){return new h})),this.applying=!1,this.target=e}return a(t,[{key:"begin",value:function(){if(this.applying)throw new Error("You must call end() after each call to being()");this.applying=!0}},{key:"apply",value:function(e,i,n){if(!this.applying)throw new Error("You must call begin() before adding an animation");t.applyAnimation(t.transforms,this.transformPool,n,e,i)}},{key:"end",value:function(){if(!this.applying)throw new Error("You must call begin() first");var e,i=r(t.transforms);try{for(i.s();!(e=i.n()).done;){var s=n(e.value,2),a=s[0],o=s[1];o.toMatrix4(a.localTransform),this.transformPool.free(o)}}catch(l){i.e(l)}finally{i.f()}t.transforms.clear(),this.target.calculateTransforms(),this.applying=!1}},{key:"applyAnimation",value:function(e,i){if(this.applying)throw new Error("Call end() first");t.applyAnimation(null,null,1,e,i),this.target.calculateTransforms()}},{key:"applyAnimations",value:function(t,e,i,n,r){if(i&&0!==r)if(t&&1!==r){if(this.applying)throw new Error("Call end() first");this.begin(),this.apply(t,e,1),this.apply(i,n,r),this.end()}else this.applyAnimation(i,n);else this.applyAnimation(t,e)}},{key:"removeAnimation",value:function(t){var e,i=r(t.nodeAnimations);try{for(i.s();!(e=i.n()).done;){e.value.node.isAnimated=!1}}catch(n){i.e(n)}finally{i.f()}}}],[{key:"getFirstKeyframeIndexAtTime",value:function(t,e){var i=t.length-1;if(i<=0||e<t[0].keytime||e>t[i].keytime)return 0;for(var n=0,r=i;n<r;){var s=Math.floor((n+r)/2);if(e>t[s+1].keytime)n=s+1;else{if(!(e<t[s].keytime))return s;r=s-1}}return n}},{key:"getTranslationAtTime",value:function(t,e,i){if(!t.translation)return i.setFrom(t.node.translation);if(1===t.translation.length)return i.setFrom(t.translation[0].value);var n=this.getFirstKeyframeIndexAtTime(t.translation,e),r=t.translation[n];if(i.setFrom(r.value),++n<t.translation.length){var s=t.translation[n],a=(e-r.keytime)/(s.keytime-r.keytime);i.lerp(s.value,a)}return i}},{key:"getRotationAtTime",value:function(t,e,i){if(!t.rotation)return i.setFrom(t.node.rotation);if(1===t.rotation.length)return i.setFrom(t.rotation[0].value);var n=this.getFirstKeyframeIndexAtTime(t.rotation,e),r=t.rotation[n];if(i.setFrom(r.value),++n<t.rotation.length){var s=t.rotation[n],a=(e-r.keytime)/(s.keytime-r.keytime);i.slerp(s.value,a)}return i}},{key:"getScalingAtTime",value:function(t,e,i){if(!t.scaling)return i.setFrom(t.node.scale);if(1===t.scaling.length)return i.setFrom(t.scaling[0].value);var n=this.getFirstKeyframeIndexAtTime(t.scaling,e),r=t.scaling[n];if(i.setFrom(r.value),++n<t.scaling.length){var s=t.scaling[n],a=(e-r.keytime)/(s.keytime-r.keytime);i.lerp(s.value,a)}return i}},{key:"getNodeAnimationTransform",value:function(t,e){var i=this.tmpT;return this.getTranslationAtTime(t,e,i.translation),this.getRotationAtTime(t,e,i.rotation),this.getScalingAtTime(t,e,i.scale),i}},{key:"applyNodeAnimationDirectly",value:function(t,e){var i=t.node;i.isAnimated=!0,this.getNodeAnimationTransform(t,e).toMatrix4(i.localTransform)}},{key:"applyNodeAnimationBlending",value:function(t,e,i,n,r){var s=t.node;s.isAnimated=!0;var a=this.getNodeAnimationTransform(t,r),o=e.get(s);o?n>.999999?o.setFrom(a):o.lerpWithTranform(a,n):n>.999999?e.set(s,i.obtain().setFrom(a)):e.set(s,i.obtain().set(s.translation,s.rotation,s.scale).lerpWithTranform(a,n))}},{key:"applyAnimation",value:function(t,e,i,n,s){if(t){var a,o=r(t.keys());try{for(o.s();!(a=o.n()).done;){a.value.isAnimated=!1}}catch(m){o.e(m)}finally{o.f()}var l,u=r(n.nodeAnimations);try{for(u.s();!(l=u.n()).done;){var h=l.value;this.applyNodeAnimationBlending(h,t,e,i,s)}}catch(m){u.e(m)}finally{u.f()}var c,f=r(t.entries());try{for(f.s();!(c=f.n()).done;){var d=c.value;d[0].isAnimated||(d[0].isAnimated=!0,d[1].lerp(d[0].translation,d[0].rotation,d[0].scale,i))}}catch(m){f.e(m)}finally{f.f()}}else{var v,p=r(n.nodeAnimations);try{for(p.s();!(v=p.n()).done;){var g=v.value;this.applyNodeAnimationDirectly(g,s)}}catch(m){p.e(m)}finally{p.f()}}}}]),t}();e.BaseAnimationController=c,c.transforms=new Map,c.tmpT=new h},8194:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BoxShapeBuilder=void 0;var s=i(8637),a=i(2668),o=i(322),l=i(9203),u=i(2738),h=function(){function t(){n(this,t)}return r(t,null,[{key:"obtainV3",value:function(){return t.vectorPool.obtain()}},{key:"freeAll",value:function(){t.vectorPool.flush()}},{key:"buildWithWidthHeight",value:function(t,e,i,n){this.buildWithRect(t,0,0,0,e,i,n)}},{key:"buildWithVertexInfo",value:function(t,e,i,n,r,s,a,o,u){var h=t.vertex(e),c=t.vertex(n),f=t.vertex(r),d=t.vertex(i),v=t.vertex(s),p=t.vertex(o),g=t.vertex(a),m=t.vertex(u),y=t.getPrimitiveType();y===l.GL20.GL_LINES?(t.rect(h,c,f,d),t.rect(p,v,g,m),t.index8Values(h,v,d,g,f,m,c,p)):y===l.GL20.GL_POINTS?(t.rect(h,c,f,d),t.rect(p,v,g,m)):(t.rect(h,c,f,d),t.rect(p,v,g,m),t.rect(h,d,g,v),t.rect(p,m,f,c),t.rect(p,c,h,v),t.rect(f,m,g,d))}},{key:"buildWithVectorCorner",value:function(t,e,i,n,r,s,a,o,l){if(0===(t.getAttributes().getMask()&(u.Usage.Normal|u.Usage.BiNormal|u.Usage.Tangent|u.Usage.TextureCoordinates)))this.buildWithVertexInfo(t,this.vertTmp1.set(e,null,null,null),this.vertTmp2.set(i,null,null,null),this.vertTmp3.set(n,null,null,null),this.vertTmp4.set(r,null,null,null),this.vertTmp5.set(s,null,null,null),this.vertTmp6.set(a,null,null,null),this.vertTmp7.set(o,null,null,null),this.vertTmp8.set(l,null,null,null));else{var h=this.tmpV1.set(e.x,e.y,e.z).lerp(r,.5).sub(this.tmpV2.set(s.x,s.y,s.z).lerp(l,.5)).normalize();t.rectWithVectorCorner(e,i,r,n,h),t.rectWithVectorCorner(a,s,o,l,h.scale(-1)),h=this.tmpV1.set(e.x,e.y,e.z).lerp(o,.5).sub(this.tmpV2.set(i.x,i.y,i.z).lerp(l,.5)).normalize(),t.rectWithVectorCorner(s,e,n,o,h),t.rectWithVectorCorner(i,a,l,r,h.scale(-1)),h=this.tmpV1.set(e.x,e.y,e.z).lerp(a,.5).sub(this.tmpV2.set(n.x,n.y,n.z).lerp(l,.5)).normalize(),t.rectWithVectorCorner(s,a,i,e,h),t.rectWithVectorCorner(n,r,l,o,h.scale(-1))}}},{key:"buildWithRect",value:function(t,e,i,n,r,s,a){var o=.5*r,l=.5*s,u=.5*a,h=e-o,c=i-l,f=n-u,d=e+o,v=i+l,p=n+u;this.buildWithVectorCorner(t,this.obtainV3().set(h,c,f),this.obtainV3().set(h,v,f),this.obtainV3().set(d,c,f),this.obtainV3().set(d,v,f),this.obtainV3().set(h,c,p),this.obtainV3().set(h,v,p),this.obtainV3().set(d,c,p),this.obtainV3().set(d,v,p)),this.freeAll()}}]),t}();e.BoxShapeBuilder=h,h.tmpV0=new a.Vector3,h.tmpV1=new a.Vector3,h.tmpV2=new a.Vector3,h.tmpV3=new a.Vector3,h.tmpV4=new a.Vector3,h.tmpV5=new a.Vector3,h.tmpV6=new a.Vector3,h.tmpV7=new a.Vector3,h.vertTmp0=new o.VertexInfo,h.vertTmp1=new o.VertexInfo,h.vertTmp2=new o.VertexInfo,h.vertTmp3=new o.VertexInfo,h.vertTmp4=new o.VertexInfo,h.vertTmp5=new o.VertexInfo,h.vertTmp6=new o.VertexInfo,h.vertTmp7=new o.VertexInfo,h.vertTmp8=new o.VertexInfo,h.vectorPool=new s.FlushablePool((function(){return new a.Vector3}))},4955:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.IndexBufferObject=void 0;var s=i(9203),a=function(){function t(e,i){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n(this,t),this.isDirty=!0,this.isBound=!1,this.indicesLength=0,this.gl=e,this.empty=0===i,this.empty&&(i=1),this.byteBuffer=new Uint16Array(i),this.isDirect=!0,this.ownsBuffer=!0,this.indicesLength=0,this.bufferHandle=this.gl.createBuffer(),this.usage=r?s.GL20.GL_STATIC_DRAW:s.GL20.GL_DYNAMIC_DRAW}return r(t,[{key:"getNumIndices",value:function(){return this.indicesLength}},{key:"getNumMaxIndices",value:function(){return this.byteBuffer.length}},{key:"setIndices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length;this.isDirty=!0,this.byteBuffer.set(t.slice(e,e+i),0),this.indicesLength=i,this.isBound&&(this.gl.bufferData(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.byteBuffer,this.usage),this.isDirty=!1)}},{key:"updateIndices",value:function(t,e,i,n){this.isDirty=!0,this.byteBuffer.set(e.slice(i,i+n),t),this.indicesLength=t+n,this.isBound&&(this.gl.bufferData(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.byteBuffer.subarray(0,this.indicesLength),this.usage),this.isDirty=!1)}},{key:"getBuffer",value:function(){return this.isDirty=!0,this.byteBuffer}},{key:"bind",value:function(){if(0===this.bufferHandle)throw new Error("No buffer allocated!");this.gl.bindBuffer(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.bufferHandle),this.isDirty&&(this.gl.bufferData(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.byteBuffer,this.usage),this.isDirty=!1),this.isBound=!0}},{key:"unbind",value:function(){this.gl.bindBuffer(s.GL20.GL_ELEMENT_ARRAY_BUFFER,null),this.isBound=!1}},{key:"invalidate",value:function(){this.bufferHandle=this.gl.createBuffer(),this.isDirty=!0}},{key:"dispose",value:function(){this.gl.bindBuffer(s.GL20.GL_ELEMENT_ARRAY_BUFFER,null),this.gl.deleteBuffer(this.bufferHandle),this.bufferHandle=new WebGLBuffer}}]),t}();e.IndexBufferObject=a},3400:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.MeshBuilder=void 0;var a=i(2691),o=i(176),l=i(5474),u=i(2226),h=i(6403),c=i(8637),f=i(2668),d=i(2738),v=i(1116),p=i(9203),g=i(8261),m=i(685),y=i(8194),M=i(322),x=function(){function t(e){r(this,t),this.gl=e,this.vertTmp1=new M.VertexInfo,this.vertTmp2=new M.VertexInfo,this.vertTmp3=new M.VertexInfo,this.vertTmp4=new M.VertexInfo,this.tempC1=new c.Color,this.vertices=[],this.indices=[],this.parts=[],this.color=c.Color.WHITE,this.hasColor=!1,this.uOffset=0,this.uScale=1,this.vOffset=0,this.vScale=1,this.hasUVTransform=!1,this.vertexTransformationEnabled=!1,this.positionTransform=new l.Matrix4,this.normalTransform=new o.Matrix3,this.bounds=new a.BoundingBox,this.lastIndex=-1,this.tmpNormal=new f.Vector3}return s(t,[{key:"begin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(this.attributes)throw new Error("Call end() first");this.attributes=t,this.parts.length=0,this.vindex=0,this.lastIndex=-1,this.istart=0,this.meshPart=null,this.stride=t.vertexSize/4,(!this._vertex||this.vertex.length<this.stride)&&(this._vertex=new Array(this.stride));var i=t.findByUsage(d.Usage.Position);if(!i)throw new Error("Cannot build mesh without position attribute");this.posOffset=i.offset/4,this.posSize=i.numComponents,i=t.findByUsage(d.Usage.Normal),this.norOffset=i?i.offset/4:-1,i=t.findByUsage(d.Usage.BiNormal),this.biNorOffset=i?i.offset/4:-1,i=t.findByUsage(d.Usage.Tangent),this.tangentOffset=i?i.offset/4:-1,i=t.findByUsage(d.Usage.ColorUnpacked),this.colOffset=i?i.offset/4:-1,this.colSize=i?i.numComponents:0,i=t.findByUsage(d.Usage.ColorPacked),this.cpOffset=i?i.offset/4:-1,i=t.findByUsage(d.Usage.TextureCoordinates),this.uvOffset=i?i.offset/4:-1,this.setColor(null),this.setVertexTransform(null),this.setUVRangeByRegion(null),this.primitiveType=e,this.bounds.inf()}},{key:"setColor",value:function(t){this.hasColor=!!t;var e=this.hasColor?t:c.Color.WHITE;this.color.set(e.r,e.g,e.b,e.a)}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getLastIndex",value:function(){return this.lastIndex}},{key:"endpart",value:function(){this.meshPart&&(this.bounds.getCenter(this.meshPart.center),this.bounds.getDimensions(this.meshPart.halfExtents).scale(.5),this.meshPart.radius=this.meshPart.halfExtents.length(),this.bounds.inf(),this.meshPart.offset=this.istart,this.meshPart.size=this.indices.length-this.istart,this.istart=this.indices.length,this.meshPart=null)}},{key:"part",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.attributes)throw new Error("Call begin() first");return i||(i=new m.MeshPart),this.endpart(),this.meshPart=i,this.meshPart.id=t,this.primitiveType=this.meshPart.primitiveType=e,this.parts.push(this.meshPart),this.setColor(null),this.setVertexTransform(null),this.setUVRangeByRegion(null),this.meshPart}},{key:"end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e||(e=new g.Mesh3D(this.gl,!0,!0,Math.min(this.vertices.length/this.stride,t.MAX_VERTICES),this.indices.length,this.attributes)),this.endpart(),!this.attributes)throw new Error("Call begin() first");if(!this.attributes.equals(e.getVertexAttributes()))throw new Error("Mesh attributes don't match");if(e.getMaxVertices()*this.stride<this.vertices.length)throw new Error("Mesh can't hold enough vertices: "+e.getMaxVertices()+" * "+this.stride+" < "+this.vertices.length);if(e.getMaxIndices()<this.indices.length)throw new Error("Mesh can't hold enough indices: "+e.getMaxIndices()+" < "+this.indices.length);e.setVertices(this.vertices,0,this.vertices.length),e.setIndices(this.indices,0,this.indices.length);var i,r=n(this.parts);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.mesh=e}}catch(a){r.e(a)}finally{r.f()}return this.parts.length=0,this.attributes=null,this.vertices.length=0,this.indices.length=0,e}},{key:"clear",value:function(){this.vertices.length=0,this.indices.length=0,this.parts.length=0,this.vindex=0,this.lastIndex=-1,this.istart=0,this.meshPart=null}},{key:"getFloatsPerVertex",value:function(){return this.stride}},{key:"setUVRange",value:function(t,e,i,n){this.uOffset=t,this.vOffset=e,this.uScale=i-t,this.vScale=n-e,this.hasUVTransform=!(c.MathUtils.isZero(t)&&c.MathUtils.isZero(e)&&c.MathUtils.isEqual(i,1)&&c.MathUtils.isEqual(n,1))}},{key:"setUVRangeByRegion",value:function(t){t?(this.hasUVTransform=!0,this.setUVRange(t.u,t.v,t.u2,t.v2)):(this.hasUVTransform=!1,this.uOffset=this.vOffset=0,this.uScale=this.vScale=1)}},{key:"setVertexTransform",value:function(t){this.vertexTransformationEnabled=!!t,this.vertexTransformationEnabled?(this.positionTransform.set(t.values),this.normalTransform.setByMatrix4(t).inv().transpose()):(this.positionTransform.idt(),this.normalTransform.idt())}},{key:"addVertex",value:function(e,i){var n=this.vertices.length;c.Utils.arrayCopy(e,i,this.vertices,this.vertices.length,this.stride),this.lastIndex=this.vindex++,this.vertexTransformationEnabled&&(t.transformPosition(this.vertices,n+this.posOffset,this.posSize,this.positionTransform),this.norOffset>=0&&t.transformNormal(this.vertices,n+this.norOffset,3,this.normalTransform),this.biNorOffset>=0&&t.transformNormal(this.vertices,n+this.biNorOffset,3,this.normalTransform),this.tangentOffset>=0&&t.transformNormal(this.vertices,n+this.tangentOffset,3,this.normalTransform));var r=this.vertices[n+this.posOffset],s=this.posSize>1?this.vertices[n+this.posOffset+1]:0,a=this.posSize>2?this.vertices[n+this.posOffset+2]:0;if(this.bounds.ext(r,s,a),this.hasColor)if(this.colOffset>=0)this.vertices[n+this.colOffset]*=this.color.r,this.vertices[n+this.colOffset+1]*=this.color.g,this.vertices[n+this.colOffset+2]*=this.color.b,this.colSize>3&&(this.vertices[n+this.colOffset+3]*=this.color.a);else if(this.cpOffset>=0){c.Color.rgba8888ToColor(this.tempC1,this.vertices[n+this.cpOffset]);var o=this.tempC1.mul(this.color.r,this.color.g,this.color.b,this.color.a);u.NumberUtil.colorToFloat(o.r,o.g,o.b,o.a),this.vertices[n+this.cpOffset]=u.NumberUtil.colorToFloat(o.r,o.g,o.b,o.a)}this.hasUVTransform&&this.uvOffset>=0&&(this.vertices[n+this.uvOffset]=this.uOffset+this.uScale*this.vertices[n+this.uvOffset],this.vertices[n+this.uvOffset+1]=this.vOffset+this.vScale*this.vertices[n+this.uvOffset+1])}},{key:"box",value:function(t,e,i){y.BoxShapeBuilder.buildWithWidthHeight(this,t,e,i)}},{key:"vertexWithData",value:function(e,i,n,r){if(this.vindex>t.MAX_INDEX)throw new Error("Too many vertices used");return this._vertex[this.posOffset]=e.x,this.posSize>1&&(this._vertex[this.posOffset+1]=e.y),this.posSize>2&&(this._vertex[this.posOffset+2]=e.z),this.norOffset>=0&&(i||(i=this.tmpNormal.set(e.x,e.y,e.z).normalize()),this._vertex[this.norOffset]=i.x,this._vertex[this.norOffset+1]=i.y,this._vertex[this.norOffset+2]=i.z),this.colOffset>=0?(n||(n=c.Color.WHITE),this._vertex[this.colOffset]=n.r,this._vertex[this.colOffset+1]=n.g,this._vertex[this.colOffset+2]=n.b,this.colSize>3&&(this._vertex[this.colOffset+3]=n.a)):this.cpOffset>0&&(n||(n=c.Color.WHITE),this._vertex[this.cpOffset]=u.NumberUtil.colorToFloat(n.r,n.g,n.b,n.a)),r&&this.uvOffset>=0&&(this._vertex[this.uvOffset]=r.x,this._vertex[this.uvOffset+1]=r.y),this.addVertex(this._vertex,0),this.lastIndex}},{key:"vertex",value:function(t){return this.vertexWithData(t.hasPosition?t.position:null,t.hasNormal?t.normal:null,t.hasColor?t.color:null,t.hasUV?t.uv:null)}},{key:"index",value:function(t){this.indices.push(t)}},{key:"index2Values",value:function(t,e,i){this.indices.push(t),this.indices.push(e)}},{key:"index3Values",value:function(t,e,i){this.indices.push(t),this.indices.push(e),this.indices.push(i)}},{key:"index4Values",value:function(t,e,i,n){this.indices.push(t),this.indices.push(e),this.indices.push(i),this.indices.push(n)}},{key:"index6Values",value:function(t,e,i,n,r,s){this.indices.push(t),this.indices.push(e),this.indices.push(i),this.indices.push(n),this.indices.push(r),this.indices.push(s)}},{key:"index8Values",value:function(t,e,i,n,r,s,a,o){this.indices.push(t),this.indices.push(e),this.indices.push(i),this.indices.push(n),this.indices.push(r),this.indices.push(s),this.indices.push(a),this.indices.push(o)}},{key:"rect",value:function(t,e,i,n){if(this.primitiveType===p.GL20.GL_TRIANGLES)this.index6Values(t,e,i,i,n,t);else if(this.primitiveType===p.GL20.GL_LINES)this.index8Values(t,e,e,i,i,n,n,t);else{if(this.primitiveType!==p.GL20.GL_POINTS)throw new Error("Incorrect primitive type");this.index4Values(t,e,i,n)}}},{key:"rectWithVertexInfo",value:function(t,e,i,n){this.rect(this.vertex(t),this.vertex(e),this.vertex(i),this.vertex(n))}},{key:"rectWithVectorCorner",value:function(t,e,i,n,r){this.rectWithVertexInfo(this.vertTmp1.set(t,r,null,null).setUV(0,1),this.vertTmp2.set(e,r,null,null).setUV(1,1),this.vertTmp3.set(i,r,null,null).setUV(1,0),this.vertTmp4.set(n,r,null,null).setUV(0,0))}},{key:"rectWithValue",value:function(t,e,i,n,r,s,a,o,l,u,h,c,f,d,v){this.rectWithVertexInfo(this.vertTmp1.set(null,null,null,null).setPos(t,e,i).setNor(f,d,v).setUV(0,1),this.vertTmp2.set(null,null,null,null).setPos(n,r,s).setNor(f,d,v).setUV(1,1),this.vertTmp3.set(null,null,null,null).setPos(a,o,l).setNor(f,d,v).setUV(1,0),this.vertTmp4.set(null,null,null,null).setPos(u,h,c).setNor(f,d,v).setUV(0,0))}},{key:"getVertexTransform",value:function(t){return t.set(this.positionTransform.values)}},{key:"getPrimitiveType",value:function(){return this.primitiveType}}],[{key:"createAttributes",value:function(t){var e=[];return(t&d.Usage.Position)===d.Usage.Position&&e.push(d.VertexAttribute3D.Position()),(t&d.Usage.ColorUnpacked)===d.Usage.ColorUnpacked&&e.push(d.VertexAttribute3D.ColorUnpacked()),(t&d.Usage.ColorPacked)===d.Usage.ColorPacked&&e.push(d.VertexAttribute3D.ColorPacked()),(t&d.Usage.Normal)===d.Usage.Normal&&e.push(d.VertexAttribute3D.Normal()),(t&d.Usage.TextureCoordinates)===d.Usage.TextureCoordinates&&e.push(new d.VertexAttribute3D(d.Usage.TextureCoordinates,2,p.GL20.GL_FLOAT,!1,h.Shader.TEXCOORDS+"0")),new v.VertexAttributes(e)}},{key:"transformPosition",value:function(t,e,i,n){i>2?(this.vTmp.set(t[e],t[e+1],t[e+2]).multiply(n),t[e]=this.vTmp.x,t[e+1]=this.vTmp.y,t[e+2]=this.vTmp.z):i>1?(this.vTmp.set(t[e],t[e+1],0).multiply(n),t[e]=this.vTmp.x,t[e+1]=this.vTmp.y):t[e]=this.vTmp.set(t[e],0,0).multiply(n).x}},{key:"transformNormal",value:function(t,e,i,n){i>2?(this.vTmp.set(t[e],t[e+1],t[e+2]).multiplyMat3(n).normalize(),t[e]=this.vTmp.x,t[e+1]=this.vTmp.y,t[e+2]=this.vTmp.z):i>1?(this.vTmp.set(t[e],t[e+1],0).multiplyMat3(n).normalize(),t[e]=this.vTmp.x,t[e+1]=this.vTmp.y):t[e]=this.vTmp.set(t[e],0,0).multiplyMat3(n).normalize().x}}]),t}();e.MeshBuilder=x,x.MAX_VERTICES=65536,x.MAX_INDEX=x.MAX_VERTICES-1,x.vTmp=new f.Vector3,x.indicesMap=null},5057:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ModelBuilder=void 0;var a=i(5474),o=i(9203),l=i(2131),u=i(9862),h=i(5975),c=i(3400),f=function(){function t(e){r(this,t),this.gl=e,this.builders=[],this.tmpTransform=new a.Matrix4}return s(t,[{key:"getBuilder",value:function(t){var e,i=n(this.builders);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r.getAttributes().equals(t)&&r.getLastIndex()<16383.5)return r}}catch(a){i.e(a)}finally{i.f()}var s=new c.MeshBuilder(this.gl);return s.begin(t),this.builders.push(s),s}},{key:"begin",value:function(){if(this.model)throw new Error("Call end() first");this.node=null,this.model=new l.Model(this.gl),this.builders.length=0}},{key:"end",value:function(){if(!this.model)throw new Error("Call begin() first");var e=this.model;this.endnode(),this.model=null;var i,r=n(this.builders);try{for(r.s();!(i=r.n()).done;){i.value.end()}}catch(s){r.e(s)}finally{r.f()}return this.builders.length=0,t.rebuildReferencesWithModel(e),e}},{key:"createNode",value:function(){var t=new u.Node;return this.addNode(t),t.id="node"+this.model.nodes.length,t}},{key:"addNode",value:function(t){if(!this.model)throw new Error("Call begin() first");return this.endnode(),this.model.nodes.push(t),this.node=t,t}},{key:"endnode",value:function(){this.node&&(this.node=null)}},{key:"manage",value:function(t){if(!this.model)throw new Error("Call begin() first");this.model.manageDisposable(t)}},{key:"partByMeshPart",value:function(t,e){this.node||this.createNode(),this.node.parts.push(new h.NodePart(t,e))}},{key:"createBox",value:function(t,e,i,n,r){return this.begin(),this.part("box",o.GL20.GL_TRIANGLES,r,n).box(t,e,i),this.end()}},{key:"part",value:function(t,e,i,n){var r=this.getBuilder(c.MeshBuilder.createAttributes(i));return this.node||this.createNode(),this.node.parts.push(new h.NodePart(r.part(t,e),n)),r}}],[{key:"rebuildReferencesWithModel",value:function(e){e.materials.length=0,e.meshes.length=0,e.meshParts.length=0;var i,r=n(e.nodes);try{for(r.s();!(i=r.n()).done;){var s=i.value;t.rebuildReferences(e,s)}}catch(a){r.e(a)}finally{r.f()}}},{key:"rebuildReferences",value:function(t,e){var i,r=n(e.parts);try{for(r.s();!(i=r.n()).done;){var s=i.value;t.materials.includes(s.material)||t.materials.push(s.material),t.meshParts.includes(s.meshPart)||(t.meshParts.push(s.meshPart),t.meshes.includes(s.meshPart.mesh)||t.meshes.push(s.meshPart.mesh),t.manageDisposable(s.meshPart.mesh))}}catch(u){r.e(u)}finally{r.f()}var a,o=n(e.getChildren());try{for(o.s();!(a=o.n()).done;){var l=a.value;this.rebuildReferences(t,l)}}catch(u){o.e(u)}finally{o.f()}}}]),t}();e.ModelBuilder=f},2196:function(t,e,i){"use strict";var n=i(7061).default,r=i(6690).default,s=i(9728).default,a=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.FileTextureProvider=void 0;var o=i(3432),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.TextureFilter.Linear,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.TextureFilter.Linear,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.TextureWrap.Repeat,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.TextureWrap.Repeat,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];r(this,t),this.minFilter=e,this.magFilter=i,this.uWrap=n,this.vWrap=s,this.useMipMaps=a}return s(t,[{key:"load",value:function(t,e){return a(this,void 0,void 0,n().mark((function i(){var r;return n().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.Texture.load(t,e);case 2:return(r=i.sent).setFilters(this.minFilter,this.magFilter),r.setWraps(this.uWrap,this.vWrap),i.abrupt("return",r);case 6:case"end":return i.stop()}}),i,this)})))}}]),t}();e.FileTextureProvider=l},8877:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.VertexBufferObject=void 0;var s=i(9203),a=function(){function t(e,i,r,a){n(this,t),this.gl=e,this.verticesLength=0,this.isDirty=!1,this.isBound=!1,this.bufferHandle=this.gl.createBuffer();var o=new Float32Array(a.vertexSize*r);this.setBuffer(o,!0,a),this.setUsage(i?s.GL20.GL_STATIC_DRAW:s.GL20.GL_DYNAMIC_DRAW)}return r(t,[{key:"getAttributes",value:function(){return this.attributes}},{key:"getNumVertices",value:function(){return this.buffer.length/this.attributes.vertexSize}},{key:"getNumMaxVertices",value:function(){return this.buffer.length}},{key:"getBuffer",value:function(){return this.isDirty=!0,this.buffer}},{key:"setBuffer",value:function(t,e,i){if(this.isBound)throw new Error("Cannot change attributes while VBO is bound");this.attributes=i,this.ownsBuffer=e,this.buffer=t}},{key:"bufferChanged",value:function(){this.isBound&&(this.gl.bufferData(s.GL20.GL_ARRAY_BUFFER,this.buffer.subarray(0,this.verticesLength),this.usage),this.isDirty=!1)}},{key:"setVertices",value:function(t,e,i){this.isDirty=!0,this.buffer.set(t.slice(e,e+i),0),this.verticesLength<i&&(this.verticesLength=i),this.bufferChanged()}},{key:"updateVertices",value:function(t,e,i,n){this.isDirty=!0,this.buffer.set(e.slice(i,i+n),t),this.verticesLength=t+n,this.bufferChanged()}},{key:"getUsage",value:function(){return this.usage}},{key:"setUsage",value:function(t){if(this.isBound)throw new Error("Cannot change usage while VBO is bound");this.usage=t}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.gl.bindBuffer(s.GL20.GL_ARRAY_BUFFER,this.bufferHandle),this.isDirty&&(this.gl.bufferData(s.GL20.GL_ARRAY_BUFFER,this.buffer.subarray(0,this.verticesLength),this.usage),this.isDirty=!1);var i=this.attributes.size();if(e)for(var n=0;n<i;n++){var r=this.attributes.get(n),a=e[n];a<0||(this.gl.enableVertexAttribArray(a),this.gl.vertexAttribPointer(a,r.numComponents,r.type,r.normalized,this.attributes.vertexSize,r.offset))}else for(var o=0;o<i;o++){var l=this.attributes.get(o),u=t.getAttributeLocation(l.alias);u<0||(this.gl.enableVertexAttribArray(u),this.gl.vertexAttribPointer(u,l.numComponents,l.type,l.normalized,this.attributes.vertexSize,l.offset))}this.isBound=!0}},{key:"unbind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.attributes.size();if(e)for(var n=0;n<i;n++){var r=e[n];r>=0&&this.gl.disableVertexAttribArray(r)}else for(var a=0;a<i;a++){var o=this.attributes.get(a).alias,l=t.getAttributeLocation(o);l>=0&&this.gl.disableVertexAttribArray(l)}this.gl.bindBuffer(s.GL20.GL_ARRAY_BUFFER,null),this.isBound=!1}},{key:"invalidate",value:function(){this.bufferHandle=this.gl.createBuffer(),this.isDirty=!0}},{key:"dispose",value:function(){this.gl.bindBuffer(s.GL20.GL_ARRAY_BUFFER,null),this.gl.deleteBuffer(this.bufferHandle)}}]),t}();e.VertexBufferObject=a},344:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},322:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.VertexInfo=void 0;var s=i(8637),a=i(3192),o=i(2668),l=function(){function t(){n(this,t),this.position=new o.Vector3,this.normal=new o.Vector3(0,1,0),this.color=new s.Color(1,1,1,1),this.uv=new a.Vector2}return r(t,[{key:"reset",value:function(){this.position.set(0,0,0),this.normal.set(0,1,0),this.color.set(1,1,1,1),this.uv.set(0,0)}},{key:"set",value:function(t,e,i,n){return this.reset(),this.hasPosition=!!t,this.hasPosition&&this.position.set(t.x,t.y,t.z),this.hasNormal=!!e,this.hasNormal&&this.normal.set(e.x,e.y,e.z),this.hasColor=!!i,this.hasColor&&this.color.set(i.r,i.g,i.b,i.a),this.hasUV=!!n,this.hasUV&&this.uv.set(n.x,n.y),this}},{key:"setWithVertextInfo",value:function(t){return t?(this.hasPosition=t.hasPosition,this.position.set(t.position.x,t.position.y,t.position.z),this.hasNormal=t.hasNormal,this.normal.set(t.normal.x,t.normal.y,t.normal.z),this.hasColor=t.hasColor,this.color.set(t.color.r,t.color.g,t.color.b,t.color.a),this.hasUV=t.hasUV,this.uv.set(t.uv.x,t.uv.y),this):this.set(null,null,null,null)}},{key:"setPos",value:function(t,e,i){return this.position.set(t,e,i),this.hasPosition=!0,this}},{key:"setNor",value:function(t,e,i){return this.normal.set(t,e,i),this.hasNormal=!0,this}},{key:"setCol",value:function(t,e,i,n){return this.color.set(t,e,i,n),this.hasColor=!0,this}},{key:"setUV",value:function(t,e){return this.uv.set(t,e),this.hasUV=!0,this}},{key:"lerp",value:function(t,e){return this.hasPosition&&t.hasPosition&&this.position.lerp(t.position,e),this.hasNormal&&t.hasNormal&&this.normal.lerp(t.normal,e),this.hasColor&&t.hasColor&&this.color.lerp(t.color,e),this.hasUV&&t.hasUV&&this.uv.lerp(t.uv,e),this}}]),t}();e.VertexInfo=l},4850:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(849),e),r(i(6520),e),r(i(8194),e),r(i(4955),e),r(i(3400),e),r(i(5057),e),r(i(2196),e),r(i(8877),e),r(i(344),e),r(i(322),e)},9416:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Affine2=void 0;var s=i(176),a=i(5474),o=function(){function t(){n(this,t),this.m00=1,this.m01=0,this.m02=0,this.m10=0,this.m11=1,this.m12=0}return r(t,[{key:"idt",value:function(){return this.m00=1,this.m01=0,this.m02=0,this.m10=0,this.m11=1,this.m12=0,this}},{key:"set",value:function(t){return this.m00=t.m00,this.m01=t.m01,this.m02=t.m02,this.m10=t.m10,this.m11=t.m11,this.m12=t.m12,this}},{key:"setMatrix3",value:function(t){var e=t.val;return this.m00=e[s.Matrix3.M00],this.m01=e[s.Matrix3.M01],this.m02=e[s.Matrix3.M02],this.m10=e[s.Matrix3.M10],this.m11=e[s.Matrix3.M11],this.m12=e[s.Matrix3.M12],this}},{key:"setMatrix4",value:function(t){var e=t.values;return this.m00=e[a.Matrix4.M00],this.m01=e[a.Matrix4.M01],this.m02=e[a.Matrix4.M03],this.m10=e[a.Matrix4.M10],this.m11=e[a.Matrix4.M11],this.m12=e[a.Matrix4.M13],this}},{key:"setToTranslation",value:function(t,e){return this.m00=1,this.m01=0,this.m02=t,this.m10=0,this.m11=1,this.m12=e,this}},{key:"setToScaling",value:function(t,e){return this.m00=t,this.m01=0,this.m02=0,this.m10=0,this.m11=e,this.m12=0,this}},{key:"setToRotation",value:function(t){var e=Math.cos(t*(180/Math.PI)),i=Math.sin(t*(180/Math.PI));return this.m00=e,this.m01=-i,this.m02=0,this.m10=i,this.m11=e,this.m12=0,this}},{key:"setToRotationRad",value:function(t){var e=Math.cos(t),i=Math.sin(t);return this.m00=e,this.m01=-i,this.m02=0,this.m10=i,this.m11=e,this.m12=0,this}},{key:"setToShearing",value:function(t,e){return this.m00=1,this.m01=t,this.m02=0,this.m10=e,this.m11=1,this.m12=0,this}},{key:"setToTrnRotScl",value:function(t,e,i,n,r){if(this.m02=t,this.m12=e,0===i)this.m00=n,this.m01=0,this.m10=0,this.m11=r;else{var s=Math.sin(i*(180/Math.PI)),a=Math.cos(i*(180/Math.PI));this.m00=a*n,this.m01=-s*r,this.m10=s*n,this.m11=a*r}return this}},{key:"setToTrnRotRadScl",value:function(t,e,i,n,r){if(this.m02=t,this.m12=e,0===i)this.m00=n,this.m01=0,this.m10=0,this.m11=r;else{var s=Math.sin(i),a=Math.cos(i);this.m00=a*n,this.m01=-s*r,this.m10=s*n,this.m11=a*r}return this}},{key:"setToTrnScl",value:function(t,e,i,n){return this.m00=i,this.m01=0,this.m02=t,this.m10=0,this.m11=n,this.m12=e,this}},{key:"setToProduct",value:function(t,e){return this.m00=t.m00*e.m00+t.m01*e.m10,this.m01=t.m00*e.m01+t.m01*e.m11,this.m02=t.m00*e.m02+t.m01*e.m12+t.m02,this.m10=t.m10*e.m00+t.m11*e.m10,this.m11=t.m10*e.m01+t.m11*e.m11,this.m12=t.m10*e.m02+t.m11*e.m12+t.m12,this}},{key:"inv",value:function(){var t=this.det();if(0===t)throw new Error("Can't invert a singular affine matrix");var e=1/t,i=this.m11,n=-this.m01,r=this.m01*this.m12-this.m11*this.m02,s=-this.m10,a=this.m00,o=this.m10*this.m02-this.m00*this.m12;return this.m00=e*i,this.m01=e*n,this.m02=e*r,this.m10=e*s,this.m11=e*a,this.m12=e*o,this}},{key:"mul",value:function(t){var e=this.m00*t.m00+this.m01*t.m10,i=this.m00*t.m01+this.m01*t.m11,n=this.m00*t.m02+this.m01*t.m12+this.m02,r=this.m10*t.m00+this.m11*t.m10,s=this.m10*t.m01+this.m11*t.m11,a=this.m10*t.m02+this.m11*t.m12+this.m12;return this.m00=e,this.m01=i,this.m02=n,this.m10=r,this.m11=s,this.m12=a,this}},{key:"preMul",value:function(t){var e=t.m00*this.m00+t.m01*this.m10,i=t.m00*this.m01+t.m01*this.m11,n=t.m00*this.m02+t.m01*this.m12+t.m02,r=t.m10*this.m00+t.m11*this.m10,s=t.m10*this.m01+t.m11*this.m11,a=t.m10*this.m02+t.m11*this.m12+t.m12;return this.m00=e,this.m01=i,this.m02=n,this.m10=r,this.m11=s,this.m12=a,this}},{key:"translate",value:function(t,e){return this.m02+=this.m00*t+this.m01*e,this.m12+=this.m10*t+this.m11*e,this}},{key:"preTranslate",value:function(t,e){return this.m02+=t,this.m12+=e,this}},{key:"scale",value:function(t,e){return this.m00*=t,this.m01*=e,this.m10*=t,this.m11*=e,this}},{key:"preScale",value:function(t,e){return this.m00*=t,this.m01*=t,this.m02*=t,this.m10*=e,this.m11*=e,this.m12*=e,this}},{key:"rotate",value:function(t){if(0===t)return this;var e=Math.cos(t*(180/Math.PI)),i=Math.sin(t*(180/Math.PI)),n=this.m00*e+this.m01*i,r=this.m00*-i+this.m01*e,s=this.m10*e+this.m11*i,a=this.m10*-i+this.m11*e;return this.m00=n,this.m01=r,this.m10=s,this.m11=a,this}},{key:"rotateRad",value:function(t){if(0===t)return this;var e=Math.cos(t),i=Math.sin(t),n=this.m00*e+this.m01*i,r=this.m00*-i+this.m01*e,s=this.m10*e+this.m11*i,a=this.m10*-i+this.m11*e;return this.m00=n,this.m01=r,this.m10=s,this.m11=a,this}},{key:"preRotate",value:function(t){if(0===t)return this;var e=Math.cos(t*(180/Math.PI)),i=Math.sin(t*(180/Math.PI)),n=e*this.m00-i*this.m10,r=e*this.m01-i*this.m11,s=e*this.m02-i*this.m12,a=i*this.m00+e*this.m10,o=i*this.m01+e*this.m11,l=i*this.m02+e*this.m12;return this.m00=n,this.m01=r,this.m02=s,this.m10=a,this.m11=o,this.m12=l,this}},{key:"preRotateRad",value:function(t){if(0===t)return this;var e=Math.cos(t),i=Math.sin(t),n=e*this.m00-i*this.m10,r=e*this.m01-i*this.m11,s=e*this.m02-i*this.m12,a=i*this.m00+e*this.m10,o=i*this.m01+e*this.m11,l=i*this.m02+e*this.m12;return this.m00=n,this.m01=r,this.m02=s,this.m10=a,this.m11=o,this.m12=l,this}},{key:"shear",value:function(t,e){var i=this.m00+e*this.m01,n=this.m01+t*this.m00;return this.m00=i,this.m01=n,i=this.m10+e*this.m11,n=this.m11+t*this.m10,this.m10=i,this.m11=n,this}},{key:"preShear",value:function(t,e){var i=this.m00+t*this.m10,n=this.m01+t*this.m11,r=this.m02+t*this.m12,s=this.m10+e*this.m00,a=this.m11+e*this.m01,o=this.m12+e*this.m02;return this.m00=i,this.m01=n,this.m02=r,this.m10=s,this.m11=a,this.m12=o,this}},{key:"det",value:function(){return this.m00*this.m11-this.m01*this.m10}},{key:"getTranslation",value:function(t){return t.x=this.m02,t.y=this.m12,t}},{key:"isTranslation",value:function(){return 1===this.m00&&1===this.m11&&0===this.m01&&0===this.m10}},{key:"isIdt",value:function(){return 1===this.m00&&0===this.m02&&0===this.m12&&1===this.m11&&0===this.m01&&0===this.m10}},{key:"applyTo",value:function(t){var e=t.x,i=t.y;t.x=this.m00*e+this.m01*i+this.m02,t.y=this.m10*e+this.m11*i+this.m12}}]),t}();e.Affine2=o},9054:function(t,e,i){"use strict";var n,r=i(4704).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=e.PlayMode=void 0,function(t){t[t.NORMAL=0]="NORMAL",t[t.LOOP=1]="LOOP",t[t.LOOP_PINGPONG=2]="LOOP_PINGPONG",t[t.REVERSED=3]="REVERSED",t[t.LOOP_REVERSED=4]="LOOP_REVERSED"}(n=e.PlayMode||(e.PlayMode={}));var o=function(){function t(e,i){s(this,t),this.totalDuration=0,this.keyFrames=e,Array.isArray(i)||(i=[i]);for(var n=i[i.length-1]||0;i.length<e.length;)i.push(n);var a,o=r(i);try{for(o.s();!(a=o.n()).done;){var l=a.value;this.totalDuration+=l}}catch(u){o.e(u)}finally{o.f()}this.frameDurations=i}return a(t,[{key:"getFrameNumber",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.frameDurations,n=e?i.length-1:0;!((t-=i[n])<0);)e?n--:n++;return n}},{key:"getKeyFrame",value:function(t,e){var i=this.keyFrames,r=this.frameDurations,s=this.totalDuration,a=Math.floor(t/s),o=t%s,l=0;switch(e){case n.NORMAL:l=0===a?this.getFrameNumber(o):r.length-1;break;case n.LOOP:l=this.getFrameNumber(o);break;case n.LOOP_PINGPONG:l=this.getFrameNumber(o,a%2===1);break;case n.REVERSED:l=0===a?this.getFrameNumber(o,!0):0;break;case n.LOOP_REVERSED:l=this.getFrameNumber(o,!0)}return i[l]}}]),t}();e.Animation=o},7035:function(t,e,i){"use strict";var n=i(861).default,r=i(7061).default,s=i(4704).default,a=i(6690).default,o=i(9728).default,l=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AssetManager=void 0;var u=i(5283),h=i(3432),c=i(8143),f=function(){function t(e){a(this,t),this.promises=[],this.atlases=new Map,this.textures=new Map,this.jsonData=new Map,this.binaryData=new Map,this.done=0,this.listeners=[],this.fonts=new Map,this.gl=e}return o(t,[{key:"addListener",value:function(t){this.listeners.push(t)}},{key:"reportDone",value:function(){this.done++;var t,e=s(this.listeners);try{for(e.s();!(t=e.n()).done;){(0,t.value)(this.done/this.getTotal()*100,this.done>=this.getTotal())}}catch(i){e.e(i)}finally{e.f()}}},{key:"loadAtlas",value:function(t,e){var i=this,n=c.TextureAtlas.load(this.gl,t,{}).then((function(t){return i.atlases.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getAtlas",value:function(t){return this.atlases.get(t)}},{key:"loadJsonData",value:function(t,e){var i=this,n=fetch(t).then((function(t){return t.json()})).then((function(t){return i.jsonData.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getJsonData",value:function(t){return this.jsonData.get(t)}},{key:"loadBinaryData",value:function(t,e){var i=this,n=fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return i.binaryData.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getBinaryData",value:function(t){return this.binaryData.get(t)}},{key:"loadFont",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u.BitmapFont.load(this.gl,t,n).then((function(t){return i.fonts.set(e,t),i.reportDone(),t}));return this.promises.push(r),r}},{key:"getFont",value:function(t){return this.fonts.get(t)}},{key:"loadTexture",value:function(t,e){var i=this,n=h.Texture.load(this.gl,t).then((function(t){return i.textures.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getTexture",value:function(t){return this.textures.get(t)}},{key:"finishLoading",value:function(){return l(this,void 0,void 0,r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.promises);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getDone",value:function(){return this.done}},{key:"getTotal",value:function(){return this.promises.length}},{key:"disposeAll",value:function(){var t=this;n(this.atlases.keys()).forEach((function(e){t.atlases.get(e).dispose(),t.atlases.delete(e)})),n(this.textures.keys()).forEach((function(e){t.textures.get(e).dispose(),t.textures.delete(e)})),n(this.fonts.keys()).forEach((function(e){t.fonts.get(e).dispose(),t.fonts.delete(e)}))}}]),t}();e.AssetManager=f,e.default=f},5283:function(t,e,i){"use strict";var n=i(7061).default,r=i(9728).default,s=i(6690).default,a=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFont=void 0;var o=i(6735),l=i(909),u=i(8637),h=r((function t(e,i,n){var r=this;s(this,t),this.load=function(t){for(var e=Object.values(t.glyphs),i=0;i<e.length;i++){var n=e[i];if(n)for(var s=0;s<n.length;s++){var a=n[s];a&&t.setGlyphRegion(a,r.regions[a.page])}}null!=t.missingGlyph&&t.setGlyphRegion(t.missingGlyph,r.regions[t.missingGlyph.page])},this.draw=function(t,e,i,n,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.Align.left,o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:e.length,c=arguments.length>9?arguments[9]:void 0;r.cache.clear(),r.cache.addText(e,i,n,l,h,s,a,o,c),r.cache.draw(t)},this.getColor=function(){return r.cache.getColor()},this.getScaleX=function(){return r.data.scaleX},this.getScaleY=function(){return r.data.scaleY},this.getRegions=function(){return r.regions},this.getRegion=function(t){return r.regions[t]},this.getLineHeight=function(){return r.data.lineHeight},this.getSpaceXadvance=function(){return r.data.spaceXadvance},this.getXHeight=function(){return r.data.xHeight},this.getCapHeight=function(){return r.data.capHeight},this.getAscent=function(){return r.data.ascent},this.getDescent=function(){return r.data.descent},this.isFlipped=function(){return r.flipped},this.dispose=function(){if(r.ownsTexture)for(var t=0;t<r.regions.length;t++)r.regions[t].texture.dispose()},this.setFixedWidthGlyphs=function(t){for(var e=r.data,i=0,n=0,s=t.length;n<s;n++){var a=e.getGlyph(t.charAt(n));null!=a&&a.xadvance>i&&(i=a.xadvance)}for(var o=0,l=t.length;o<l;o++){var u=e.getGlyph(t.charAt(o));u&&(u.xoffset+=(i-u.xadvance)/2,u.xadvance=i,u.kerning=[],u.kerning=null,u.fixedWidth=!0)}},this.setUseIntegerPositions=function(t){r.integer=t,r.cache.setUseIntegerPositions(t)},this.usesIntegerPositions=function(){return r.integer},this.getCache=function(){return r.cache},this.getData=function(){return r.data},this.getOwnsTexture=function(){return r.ownsTexture},this.setOwnsTexture=function(t){r.ownsTexture=t},this.newFontCache=function(){return new o.BitmapFontCache(r,r.integer)},this.regions=i,this.flipped=e.flipped,this.data=e,this.integer=n,0!==this.regions.length?(this.ownsTexture=!1,this.cache=this.newFontCache(),this.load(e)):console.log("No texture region were found")}));e.BitmapFont=h,h.load=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return a(void 0,void 0,void 0,n().mark((function s(){var a;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=new l.BitmapFontData(e,i),n.next=3,a.loadFont(t);case 3:return n.abrupt("return",new h(a,a.regions,r));case 4:case"end":return n.stop()}}),s)})))}},6735:function(t,e,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontCache=void 0;var a=i(417),o=i(2226),l=i(8637),u=function(){function t(e,i){var s=this;r(this,t),this.tempColor=new l.Color(1,1,1,1),this.drawingTexts=[],this.layouts=[],this.pooledLayouts=[],this.color=new l.Color(1,1,1,1),this.setPosition=function(t,e){s.translate(t-s.x,e-s.y)},this.translate=function(t,e){if(0!==t||0!==e){s.integer&&(t=Math.round(t),e=Math.round(e)),s.x+=t,s.y+=e;for(var i=s.pageVertices,n=0,r=i.length;n<r;n++)for(var a=i[n],o=0,l=s.idx[n];o<l;o+=5)a[o]+=t,a[o+1]+=e}},this.setColors=function(t,e,i,n){for(var r=255<<24|255*i<<16|255*e<<8|255*t,a=o.NumberUtil.intToFloatColor(r),l=0,u=s.pageVertices.length;l<u;l++)for(var h=s.pageVertices[l],c=2,f=s.idx[l];c<f;c+=5)h[c]=a},this.getColor=function(){return s.color},this.setColor=function(t,e,i,n){s.color.set(t,e,i,n)},this.clear=function(){s.x=0,s.y=0,l.Pools.freeAll("GlyphLayout",s.pooledLayouts),s.pooledLayouts.length=0,s.layouts.length=0;for(var t=0,e=s.idx.length;t<e;t++)null!=s.pageGlyphIndices&&(s.pageGlyphIndices[t].length=0),s.idx[t]=0},this.requireGlyphs=function(t){if(1===s.pageVertices.length)s.requirePageGlyphs(0,t.glyphCount);else{for(var e=s.tempGlyphCount,i=0;i<e.length;i++)e[i]=0;for(var n=0,r=t.runs.length;n<r;n++)for(var a=t.runs[n].glyphs,o=a,l=0,u=a.length;l<u;l++)e[o[l].page]++;for(var h=0,c=e.length;h<c;h++)s.requirePageGlyphs(h,e[h])}},this.requirePageGlyphs=function(t,e){var i=s.idx[t]+20*e,n=s.pageVertices[t];if(n){if(n.length<i){var r=new Array(i);l.Utils.arrayCopy(n,0,r,0,s.idx[t]),s.pageVertices[t]=r}}else s.pageVertices[t]=new Array(i)},this.setPageCount=function(t){var e=new Array(t).fill([]);l.Utils.arrayCopy(s.pageVertices,0,e,0,s.pageVertices.length),s.pageVertices=n(e);var i=new Array(t);l.Utils.arrayCopy(s.idx,0,i,0,s.idx.length),s.idx=i;var r=new Array(t),a=0;null!=s.pageGlyphIndices&&(a=s.pageGlyphIndices.length,l.Utils.arrayCopy(s.pageGlyphIndices,0,r,0,s.pageGlyphIndices.length));for(var o=a;o<t;o++)r[o]=[];s.pageGlyphIndices=r,s.tempGlyphCount=new Array(t)},this.addToCache=function(t,e,i){var n=t.runs.length;if(0!==n){s.pageVertices.length<s.font.regions.length&&s.setPageCount(s.font.regions.length),s.layouts.push(t),s.requireGlyphs(t);var r=t.colors,a=0,l=0,u=0,h=0;s.drawingTexts.length=0;for(var c=0;c<n;c++)for(var f=t.runs[c],d=f.glyphs,v=f.xAdvances,p=e+f.x,g=i+f.y,m=0,y=f.glyphs.length;m<y;m++)u++===l&&(h=o.NumberUtil.intToFloatColor(r[++a]),l=++a<r.length?r[a]:-1),p+=v[m],s.drawingTexts.push(d[m].id),s.addGlyph(d[m],p,g,h);s.currentTint=o.NumberUtil.intToFloatColor(-1)}},this.addGlyph=function(t,e,i,n){var r=s.font.data.scaleX,a=s.font.data.scaleY;e+=t.xoffset*r,i+=t.yoffset*a;var o=t.width*r,l=t.height*a,u=t.u,h=t.u2,c=t.v,f=t.v2;s.integer&&(e=Math.round(e),i=Math.round(i),o=Math.round(o),l=Math.round(l));var d=e+o,v=i+l,p=t.page,g=s.idx[p];s.idx[p]+=20,null!=s.pageGlyphIndices&&s.pageGlyphIndices[p].push(s.glyphCount++);var m=s.pageVertices[p];m[g++]=e,m[g++]=i,m[g++]=n,m[g++]=u,m[g++]=c,m[g++]=e,m[g++]=v,m[g++]=n,m[g++]=u,m[g++]=f,m[g++]=d,m[g++]=v,m[g++]=n,m[g++]=h,m[g++]=f,m[g++]=d,m[g++]=i,m[g++]=n,m[g++]=h,m[g]=c},this.setText=function(t,e,i,n,r,a,o,l,u){return s.clear(),s.addText(t,e,i,n,r,a,o,l,u)},this.setTextToCache=function(t,e,i){s.clear(),s.addTextToCache(t,e,i)},this.addText=function(t,e,i,n,r,a,o,u,h){var c=l.Pools.obtain("GlyphLayout");return s.pooledLayouts.push(c),c.setText(s.font,t,n,r,s.color,a,o,u,h),s.addTextToCache(c,e,i),c},this.addTextToCache=function(t,e,i){s.addToCache(t,e,i+s.font.data.ascent)},this.getX=function(){return s.x},this.getY=function(){return s.y},this.getFont=function(){return s.font},this.setUseIntegerPositions=function(t){s.integer=t},this.usesIntegerPositions=function(){return s.integer},this.getVertices=function(t){return s.pageVertices[t]},this.getVertexCount=function(t){return s.idx[t]},this.getLayouts=function(){return s.layouts},this.font=e,this.integer=i;var u=e.regions.length;if(0===u&&console.log("The specified font must contain at least one texture page."),this.pageVertices=new Array(u).fill([]),this.idx=new Array(u),u>1){this.pageGlyphIndices=new Array(u);for(var h=0,c=this.pageGlyphIndices.length;h<c;h++)this.pageGlyphIndices[h]=[]}this.tempGlyphCount=new Array(u),l.Pools.get("GlyphLayout",(function(){return new a.GlyphLayout(e,"",0,0,l.Color.WHITE,0,l.Align.left,!1)}))}return s(t,[{key:"draw",value:function(t){for(var e=this,i=this.font.getRegions(),n=0;n<this.pageVertices.length;n++)if(this.idx[n]>0)for(var r=this.pageVertices[n],s=function(n){var s=20*n,a=i.find((function(t){var i;return t.id===(null===(i=e.drawingTexts)||void 0===i?void 0:i[n])}));a&&a.draw(t,r[0+s],r[1+s],r[10+s]-r[0+s],r[11+s]-r[1+s])},a=0;a<this.idx[n]/20;a++)s(a)}}]),t}();e.BitmapFontCache=u},909:function(t,e,i){"use strict";var n=i(861).default,r=i(7061).default,s=i(6690).default,a=i(9728).default,o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontData=void 0;var l=i(5508),u=i(3432),h=i(8026),c=i(8637),f=65535,d=function(){function t(e,i){var n=this;s(this,t),this.capHeight=1,this.blankLineScale=1,this.scaleX=1,this.scaleY=1,this.glyphs={},this.xHeight=1,this.xChars=["x","e","a","o","n","s","r","c","u","m","v","w","z"],this.capChars=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.loadFont=function(t){return o(n,void 0,void 0,r().mark((function e(){var i,n,s,a,o,d,p,g,m,y,M,x,b,w,_,T,A,k,L,S,E,C,P,R,I,F,G,B,O,U,D,V,N,z,j,W,H,X,Y,q,K,Z,Q,J,$,tt,et,it,nt,rt,st,at,ot,lt,ut,ht,ct,ft,dt,vt,pt,gt,mt,yt,Mt,xt;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.imagePaths){e.next=2;break}return e.abrupt("return");case 2:return i=0,e.next=5,fetch(this.fontFile);case 5:return s=e.sent,e.next=8,s.text();case 8:if(n=e.sent,a=n.split(/\r?\n/).map((function(t){return t.trim()})),e.prev=10,"string"===typeof(o=a[i])){e.next=14;break}throw new Error("File is empty.");case 14:if(o=o.substring(o.indexOf("padding=")+8),4===(d=o.substring(0,o.indexOf(" ")).split(",",4)).length){e.next=18;break}throw new Error("Invalid padding.");case 18:if(this.padTop=parseInt(d[0]),this.padRight=parseInt(d[1]),this.padBottom=parseInt(d[2]),this.padLeft=parseInt(d[3]),p=this.padTop+this.padBottom,i++,"string"===typeof(o=a[i])){e.next=27;break}throw new Error("Missing common header.");case 27:if(!((g=o.split(" ",9)).length<3)){e.next=30;break}throw new Error("Invalid common header.");case 30:if(g[1].startsWith("lineHeight=")){e.next=32;break}throw new Error("Missing: lineHeight");case 32:if(this.lineHeight=parseInt(g[1].substring(11)),g[2].startsWith("base=")){e.next=35;break}throw new Error("Missing: base");case 35:if(m=parseInt(g[2].substring(5)),y=1,g.length>=6&&null!=g[5]&&g[5].startsWith("pages="))try{y=Math.max(1,parseInt(g[5].substring(6)))}catch(r){}this.imagePaths=new Array(y),M=[],x=0;case 41:if(!(x<y)){e.next=65;break}if(i++,"string"===typeof(o=a[i])){e.next=46;break}throw new Error("Missing additional page definitions.");case 46:if(!((b=o.match(new RegExp(".*id=(\\d+)")))&&b.length>1)){e.next=57;break}if(w=b[1],e.prev=49,parseInt(w)===x){e.next=53;break}throw new Error("Page IDs must be indices starting at 0: "+w);case 53:e.next=57;break;case 55:e.prev=55,e.t0=e.catch(49);case 57:if((_=o.match(new RegExp('.*file="?([^"]+)"?')))&&!(_.length<=1)){e.next=60;break}throw new Error("Missing: file");case 60:T=_[1],M[x]=T;case 62:x++,e.next=41;break;case 65:this.descent=0;case 66:if(i++,o=a[i]){e.next=71;break}return e.abrupt("break",105);case 71:if(!o.startsWith("kernings ")){e.next=73;break}return e.abrupt("break",105);case 73:if(!o.startsWith("metrics ")){e.next=75;break}return e.abrupt("break",105);case 75:if(o.startsWith("char ")){e.next=77;break}return e.abrupt("continue",66);case 77:if(A=new l.Glyph,(k=new v(o,"=")).nextToken(),k.nextToken(),!((L=parseInt(k.nextToken()))>0&&L>f)){e.next=84;break}return e.abrupt("continue",66);case 84:if(A.id=L+"",k.nextToken(),A.srcX=parseInt(k.nextToken()),k.nextToken(),A.srcY=parseInt(k.nextToken()),k.nextToken(),A.width=parseInt(k.nextToken()),k.nextToken(),A.height=parseInt(k.nextToken()),k.nextToken(),A.xoffset=parseInt(k.nextToken()),k.nextToken(),this.flipped?A.yoffset=parseInt(k.nextToken()):A.yoffset=-(A.height+parseInt(k.nextToken())),k.nextToken(),A.xadvance=parseInt(k.nextToken()),k.hasMoreTokens()&&k.nextToken(),k.hasMoreTokens())try{A.page=parseInt(k.nextToken())}catch(bt){}A.width>0&&A.height>0&&(this.descent=Math.min(m+A.yoffset,this.descent)),L<=0?this.missingGlyph=A:L<=f&&this.setGlyph(L,A),e.next=66;break;case 105:this.descent+=this.padBottom;case 106:if(i++,"string"===typeof(o=a[i])){e.next=111;break}return e.abrupt("break",127);case 111:if(o.startsWith("kerning ")){e.next=113;break}return e.abrupt("break",127);case 113:if((S=new v(o,"=")).nextToken(),S.nextToken(),E=parseInt(S.nextToken()),S.nextToken(),C=parseInt(S.nextToken()),!(E<0||E>f||C<0||C>f)){e.next=121;break}return e.abrupt("continue",106);case 121:P=this.getGlyph(E+""),S.nextToken(),R=parseInt(S.nextToken()),P&&P.setKerning(C,R),e.next=106;break;case 127:I=!1,F=0,G=0,B=0,O=0,U=0,D=0,V=0,null!=o&&o.startsWith("metrics ")&&(I=!0,(N=new v(o,"=")).nextToken(),N.nextToken(),F=parseFloat(N.nextToken()),N.nextToken(),G=parseFloat(N.nextToken()),N.nextToken(),B=parseFloat(N.nextToken()),N.nextToken(),O=parseFloat(N.nextToken()),N.nextToken(),U=parseFloat(N.nextToken()),N.nextToken(),D=parseFloat(N.nextToken()),N.nextToken(),V=parseFloat(N.nextToken())),(z=this.getGlyph("32"))||((z=new l.Glyph).id="32",(j=this.getGlyph("l"))||(j=this.getFirstGlyph()),z.xadvance=j.xadvance,this.setGlyph(32,z)),0===z.width&&(z.width=this.padLeft+z.xadvance+this.padRight,z.xoffset=-this.padLeft),this.spaceXadvance=z.xadvance,H=0;case 141:if(!(H<this.xChars.length)){e.next=148;break}if(!(W=this.getGlyph(this.xChars[H]))){e.next=145;break}return e.abrupt("break",148);case 145:H++,e.next=141;break;case 148:W||(W=this.getFirstGlyph()),this.xHeight=W.height-p,Y=0;case 151:if(!(Y<this.capChars.length)){e.next=158;break}if(!(X=this.getGlyph(this.capChars[Y]))){e.next=155;break}return e.abrupt("break",158);case 155:Y++,e.next=151;break;case 158:if(X){e.next=178;break}q=Object.values(this.glyphs),K=0;case 161:if(!(K<q.length)){e.next=176;break}if(Z=q[K]){e.next=165;break}return e.abrupt("continue",173);case 165:Q=0;case 166:if(!(Q<Z.length)){e.next=173;break}if(Z[Q]&&0!==Z[Q].height&&0!==Z[Q].width){e.next=169;break}return e.abrupt("continue",170);case 169:this.capHeight=Math.max(this.capHeight,Z[Q].height);case 170:Q++,e.next=166;break;case 173:K++,e.next=161;break;case 176:e.next=179;break;case 178:this.capHeight=X.height;case 179:for(this.capHeight-=p,this.ascent=m-this.capHeight,this.down=-this.lineHeight,this.flipped&&(this.ascent=-this.ascent,this.down=-this.down),I&&(this.ascent=F,this.descent=G,this.down=B,this.capHeight=O,this.lineHeight=U,this.spaceXadvance=D,this.xHeight=V),J=[],$=Object.values(this.glyphs),tt=0;tt<$.length;tt++)for(et=Object.values($[tt]),it=0;it<et.length;it++)nt={id:et[it].id,left:et[it].srcX,top:et[it].srcY,width:et[it].width,height:et[it].height,xoffset:et[it].xoffset,yoffset:et[it].yoffset,xadvance:et[it].xadvance,page:M[et[it].page],pageId:et[it].page},J.push(nt);rt=[],st=0;case 189:if(!(st<y)){e.next=199;break}return e.next=192,u.Texture.load(t,(0,c.concatAndResolveUrl)(this.fontFile,"../".concat(M[st])));case 192:at=e.sent,ot=1/at.width,lt=1/at.height,rt.push({texture:at,invTexWidth:ot,invTexHeight:lt});case 196:st++,e.next=189;break;case 199:for(this.regions=[],ut=0,ht=J;ut<ht.length;ut++)ct=ht[ut],ft=ct.left,dt=ct.top,vt=ct.width,pt=ct.height,gt=rt[ct.pageId],mt=gt.texture,yt=gt.invTexWidth,Mt=gt.invTexHeight,(xt=new h.TextureRegion(mt,ft,dt,vt,pt,ct,yt,Mt)).originalWidth=vt,xt.originalHeight=pt,xt.offsetX=0,xt.offsetY=0,this.regions.push(xt);e.next=206;break;case 203:e.prev=203,e.t1=e.catch(10),console.error(e.t1);case 206:case"end":return e.stop()}}),e,this,[[10,203],[49,55]])})))},this.setGlyphRegion=function(t,e){var i=e.texture,r=1/i.width,s=1/i.height,a=e.u,o=e.v,l=(e.originalWidth,e.originalHeight,t.srcX),u=t.srcX+t.width,h=t.srcY,c=t.srcY+t.height;t.u=a+l*r,t.u2=a+u*r,n.flipped?(t.v=o+h*s,t.v2=o+c*s):(t.v2=o+h*s,t.v=o+c*s)},this.setLineHeight=function(t){n.lineHeight=t*n.scaleY,n.down=n.flipped?n.lineHeight:-n.lineHeight},this.setGlyph=function(t,e){var i=n.glyphs[t/l.PAGE_SIZE];i||(i=new Array(l.PAGE_SIZE),n.glyphs[t/l.PAGE_SIZE]=i),i[t&l.PAGE_SIZE-1]=e},this.getFirstGlyph=function(){for(var t=Object.values(n.glyphs),e=0;e<t.length;e++){var i=t[e];if(i)for(var r=0;r<i.length;r++){var s=i[r];if(s&&0!==s.height&&0!==s.width)return s}}},this.hasGlyph=function(t){return!!n.missingGlyph||null!=n.getGlyph(t)},this.getGlyph=function(t){var e=n.glyphs[t.charCodeAt(0)/l.PAGE_SIZE];if(null!=e)return e[t.charCodeAt(0)&l.PAGE_SIZE-1]},this.getGlyphs=function(t,e,i,r,s){if(0!==r-i){var a=n.markupEnabled,o=n.scaleX,l=t.glyphs,u=t.xAdvances;do{var h=e.charAt(i++);if("\r"!==h){var c=n.getGlyph(h);if(!c){if(!n.missingGlyph)continue;c=n.missingGlyph}l.push(c),u.push(s?(s.xadvance+s.getKerning(h))*o:c.fixedWidth?0:-c.xoffset*o-n.padLeft),s=c,a&&"["===h&&i<r&&"["===e.charAt(i)&&i++}}while(i<r);if(s){var f=s.fixedWidth?s.xadvance*o:(s.width+s.xoffset)*o-n.padRight;u.push(f)}}},this.getWrapIndex=function(t,e){var i=e-1,r=t,s=r[i].id;if(n.isWhitespace(s+""))return i;for(n.isBreakChar(s+"")&&i--;i>0;i--)if(s=r[i].id,n.isWhitespace(s+"")||n.isBreakChar(s+""))return i+1;return 0},this.isBreakChar=function(t){if(!n.breakChars)return!1;for(var e=String.fromCharCode(parseInt(t)),i=0;i<n.breakChars.length;i++)if(e===n.breakChars[i])return!0;return!1},this.isWhitespace=function(t){switch(String.fromCharCode(parseInt(t))){case"\n":case"\r":case"\t":case" ":return!0;default:return!1}},this.getImagePath=function(t){return n.imagePaths[t]},this.getImagePaths=function(){return n.imagePaths},this.setScale=function(t,e){if(0!==t&&0!==e){var i=t/n.scaleX,r=e/n.scaleY;n.lineHeight*=r,n.spaceXadvance*=i,n.xHeight*=r,n.capHeight*=r,n.ascent*=r,n.descent*=r,n.down*=r,n.padLeft*=i,n.padRight*=i,n.padTop*=r,n.padBottom*=r,n.scaleX=t,n.scaleY=e}},this.scale=function(t){n.setScale(n.scaleX+t,n.scaleY+t)},this.fontFile=e,this.flipped=i}return a(t,[{key:"setXYScale",value:function(t){this.setScale(t,t)}}]),t}();e.BitmapFontData=d;var v=function(){function t(e,i){s(this,t),this.strArray=[],this.currentIndex=0;for(var r=e.split(/\s+/),a=0;a<r.length;a++){var o,l=r[a];(o=this.strArray).push.apply(o,n(l.split(i)))}}return a(t,[{key:"hasMoreTokens",value:function(){return this.currentIndex>=this.strArray.length}},{key:"nextToken",value:function(){return this.strArray[this.currentIndex++]}}]),t}()},2691:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BoundingBox=void 0;var a=i(2668),o=function(){function t(){r(this,t),this.min=new a.Vector3,this.max=new a.Vector3,this.cnt=new a.Vector3,this.dim=new a.Vector3,this.clr()}return s(t,[{key:"getCenter",value:function(t){return t.setFrom(this.cnt)}},{key:"getCenterX",value:function(){return this.cnt.x}},{key:"getCenterY",value:function(){return this.cnt.y}},{key:"getCenterZ",value:function(){return this.cnt.z}},{key:"getCorner000",value:function(t){return t.set(this.min.x,this.min.y,this.min.z)}},{key:"getCorner001",value:function(t){return t.set(this.min.x,this.min.y,this.max.z)}},{key:"getCorner010",value:function(t){return t.set(this.min.x,this.max.y,this.min.z)}},{key:"getCorner011",value:function(t){return t.set(this.min.x,this.max.y,this.max.z)}},{key:"getCorner100",value:function(t){return t.set(this.max.x,this.min.y,this.min.z)}},{key:"getCorner101",value:function(t){return t.set(this.max.x,this.min.y,this.max.z)}},{key:"getCorner110",value:function(t){return t.set(this.max.x,this.max.y,this.min.z)}},{key:"getCorner111",value:function(t){return t.set(this.max.x,this.max.y,this.max.z)}},{key:"getDimensions",value:function(t){return t.setFrom(this.dim)}},{key:"getWidth",value:function(){return this.dim.x}},{key:"getHeight",value:function(){return this.dim.y}},{key:"getDepth",value:function(){return this.dim.z}},{key:"getMin",value:function(t){return t.setFrom(this.min)}},{key:"getMax",value:function(t){return t.setFrom(this.max)}},{key:"setFromBounds",value:function(t){return this.set(t.min,t.max)}},{key:"set",value:function(t,e){return this.min.set(t.x<e.x?t.x:e.x,t.y<e.y?t.y:e.y,t.z<e.z?t.z:e.z),this.max.set(t.x>e.x?t.x:e.x,t.y>e.y?t.y:e.y,t.z>e.z?t.z:e.z),this.update(),this}},{key:"update",value:function(){this.cnt.setFrom(this.min).add(this.max).scale(.5),this.dim.setFrom(this.max).sub(this.min)}},{key:"setFromPoints",value:function(t){this.inf();var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.extPoint(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"inf",value:function(){return this.min.set(1/0,1/0,1/0),this.max.set(-1/0,-1/0,-1/0),this.cnt.set(0,0,0),this.dim.set(0,0,0),this}},{key:"extPoint",value:function(t){return this.set(this.min.set(Math.min(this.min.x,t.x),Math.min(this.min.y,t.y),Math.min(this.min.z,t.z)),this.max.set(Math.max(this.max.x,t.x),Math.max(this.max.y,t.y),Math.max(this.max.z,t.z)))}},{key:"clr",value:function(){return this.set(this.min.set(0,0,0),this.max.set(0,0,0))}},{key:"isValid",value:function(){return this.min.x<=this.max.x&&this.min.y<=this.max.y&&this.min.z<=this.max.z}},{key:"extBounds",value:function(t){return this.set(this.min.set(Math.min(this.min.x,t.min.x),Math.min(this.min.y,t.min.y),Math.min(this.min.z,t.min.z)),this.max.set(Math.max(this.max.x,t.max.x),Math.max(this.max.y,t.max.y),Math.max(this.max.z,t.max.z)))}},{key:"extSphere",value:function(t,e){return this.set(this.min.set(Math.min(this.min.x,t.x-e),Math.min(this.min.y,t.y-e),Math.min(this.min.z,t.z-e)),this.max.set(Math.max(this.max.x,t.x+e),Math.max(this.max.y,t.y+e),Math.max(this.max.z,t.z+e)))}},{key:"extTransformedBox",value:function(e,i){return this.extPoint(t.tmpVector.set(e.min.x,e.min.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.min.x,e.min.y,e.max.z).multiply(i)),this.extPoint(t.tmpVector.set(e.min.x,e.max.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.min.x,e.max.y,e.max.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.min.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.min.y,e.max.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.max.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.max.y,e.max.z).multiply(i)),this}},{key:"mul",value:function(e){var i=this.min.x,n=this.min.y,r=this.min.z,s=this.max.x,a=this.max.y,o=this.max.z;return this.inf(),this.extPoint(t.tmpVector.set(i,n,r).multiply(e)),this.extPoint(t.tmpVector.set(i,n,o).multiply(e)),this.extPoint(t.tmpVector.set(i,a,r).multiply(e)),this.extPoint(t.tmpVector.set(i,a,o).multiply(e)),this.extPoint(t.tmpVector.set(s,n,r).multiply(e)),this.extPoint(t.tmpVector.set(s,n,o).multiply(e)),this.extPoint(t.tmpVector.set(s,a,r).multiply(e)),this.extPoint(t.tmpVector.set(s,a,o).multiply(e)),this}},{key:"containsBounds",value:function(t){return!this.isValid()||this.min.x<=t.min.x&&this.min.y<=t.min.y&&this.min.z<=t.min.z&&this.max.x>=t.max.x&&this.max.y>=t.max.y&&this.max.z>=t.max.z}},{key:"intersects",value:function(t){if(!this.isValid())return!1;var e=Math.abs(this.cnt.x-t.cnt.x),i=this.dim.x/2+t.dim.x/2,n=Math.abs(this.cnt.y-t.cnt.y),r=this.dim.y/2+t.dim.y/2,s=Math.abs(this.cnt.z-t.cnt.z),a=this.dim.z/2+t.dim.z/2;return e<=i&&n<=r&&s<=a}},{key:"containsPoint",value:function(t){return this.min.x<=t.x&&this.max.x>=t.x&&this.min.y<=t.y&&this.max.y>=t.y&&this.min.z<=t.z&&this.max.z>=t.z}},{key:"ext",value:function(t,e,i){return this.set(this.min.set(Math.min(this.min.x,t),Math.min(this.min.y,e),Math.min(this.min.z,i)),this.max.set(Math.max(this.max.x,t),Math.max(this.max.y,e),Math.max(this.max.z,i)))}}]),t}();e.BoundingBox=o,o.tmpVector=new a.Vector3},814:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.OrthoCamera=void 0;var s=i(5474),a=i(2668),o=function(){function t(e,i,r,o){n(this,t),this.position=new a.Vector3(0,0,0),this.direction=new a.Vector3(0,0,-1),this.up=new a.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new s.Matrix4,this.inverseProjectionView=new s.Matrix4,this.projection=new s.Matrix4,this.view=new s.Matrix4,this.yDown=!1,this.tmp3=new a.Vector3,this.resize(e,i,r,o)}return r(t,[{key:"getYDown",value:function(){return this.yDown}},{key:"setYDown",value:function(t){this.yDown=t,t?(this.up.set(0,-1,0),this.direction.set(0,0,1)):(this.up.set(0,1,0),this.direction.set(0,0,-1)),this.update()}},{key:"resize",value:function(t,e,i,n){this.viewportWidth=t,this.viewportHeight=e,this.screenWidth=i,this.screenHeight=n,this.update()}},{key:"setPosition",value:function(t,e){this.position.set(t,e,this.position.z)}},{key:"update",value:function(){var t=this.projection,e=this.view,i=this.projectionView,n=this.inverseProjectionView,r=this.zoom,s=this.viewportWidth,a=this.viewportHeight;t.ortho(r*(-s/2),r*(s/2),r*(-a/2),r*(a/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),i.set(t.values),i.multiply(e),n.set(i.values).invert(),this.combined=i.values}},{key:"screenToWorld",value:function(t,e,i){e=e||this.screenWidth,i=i||this.screenHeight;var n=t.x,r=i-t.y-1;return t.x=2*n/e-1,t.y=2*r/i-1,t.z=2*t.z-1,t.project(this.inverseProjectionView),t}},{key:"worldToScreen",value:function(t,e,i){return e=e||this.screenWidth,i=i||this.screenHeight,t.project(this.projectionView),t.x=e*(t.x+1)/2,t.y=i*(t.y+1)/2,t.z=(t.z+1)/2,t}},{key:"unprojectVector2",value:function(t,e){this.tmp3.set(e.x,e.y,0),this.screenToWorld(this.tmp3),t.set(this.tmp3.x,this.tmp3.y)}},{key:"setViewport",value:function(t,e){this.viewportWidth=t,this.viewportHeight=e}}]),t}();e.OrthoCamera=o},2229:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var s=function(){function t(){n(this,t)}return r(t,[{key:"setScreen",value:function(t){this.currentScreen&&this.currentScreen.dispose&&this.currentScreen.dispose(),this.currentScreen=t,this.currentScreen&&this.currentScreen.init&&this.currentScreen.init(this)}},{key:"update",value:function(t){this.currentScreen&&this.currentScreen.update&&this.currentScreen.update(t,this)}}]),t}();e.Game=s,s.shared=new s},5508:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Glyph=e.PAGES=e.PAGE_SIZE=e.LOG2_PAGE_SIZE=void 0,e.LOG2_PAGE_SIZE=9,e.PAGE_SIZE=1<<e.LOG2_PAGE_SIZE,e.PAGES=65536/e.PAGE_SIZE;var s=function(){function t(){n(this,t),this.page=0}return r(t,[{key:"getKerning",value:function(t){if(this.kerning){var i=this.kerning[t.charCodeAt(0)>>>e.LOG2_PAGE_SIZE];if(null!=i)return i[t.charCodeAt(0)&e.PAGE_SIZE-1]}return 0}},{key:"setKerning",value:function(t,i){this.kerning||(this.kerning=[]);var n=this.kerning[t>>>e.LOG2_PAGE_SIZE];n||(this.kerning[t>>>e.LOG2_PAGE_SIZE]=n=new Uint32Array(new ArrayBuffer(e.PAGE_SIZE))),n[(t&e.PAGE_SIZE)-1]=i}}]),t}();e.Glyph=s},417:function(t,e,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphLayout=void 0;var a=i(1013),o=i(8637),l=function(){function t(e,i){var s=this,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(null===i||void 0===i?void 0:i.length)||0,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.Color.WHITE,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o.Align.left,d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],v=arguments.length>8?arguments[8]:void 0;r(this,t),this.epsilon=1e-4,this.glyphRunPool=o.Pools.get("GlyphRun",(function(){return new a.GlyphRun})),this.colorStack=new Array(4),this.runs=[],this.colors=[],this.setText=function(t,e,i,n,r,a,o,l,u){s.reset();var h=t.data;if(i!==n){l&&(a=Math.max(a,3*h.spaceXadvance));var c=l||null!=u,f=r.toIntBits(),d=f;s.colors.shift();var v=h.markupEnabled;v&&s.colorStack.push(f);for(var p=!1,g=0,m=h.down,y=null,M=null,x=i;;){var b=void 0,w=!1;if(i===n){if(x===n)break;b=n,p=!0}else{if("\n"!==e.charAt(i++))continue;b=i-1,w=!0}t:{var _=s.glyphRunPool.obtain();if(_.x=0,_.y=g,h.getGlyphs(_,e,x,b,M),s.glyphCount+=_.glyphs.length,d!==f&&(s.colors[s.colors.length-2]===s.glyphCount?s.colors[s.colors.length-1]=d:(s.colors.push(s.glyphCount),s.colors.push(d)),f=d),0===_.glyphs.length){if(s.glyphRunPool.free(_),!y)break t}else y?(y.appendRun(_),s.glyphRunPool.free(_)):(y=_,s.runs.push(y));if(w||p?(s.setLastGlyphXAdvance(h,y),M=null):M=y.glyphs[y.glyphs.length-1],c&&0!==y.glyphs.length&&(w||p))for(var T=y.xAdvances[0]+y.xAdvances[1],A=2;A<y.xAdvances.length;A++){var k=y.glyphs[A-1];if(T+s.getGlyphWidth(k,h)-s.epsilon<=a)T+=y.xAdvances[A];else{if(null!=u){s.truncate(h,y,a,u);break}var L=h.getWrapIndex(y.glyphs,A);if((0===L&&0===y.x||L>=y.glyphs.length)&&(L=A-1),!(y=s.wrap(h,y,L)))break t;s.runs.push(y),g+=m,y.x=0,y.y=g,T=y.xAdvances[0]+y.xAdvances[1],A=1}}}w&&(y=null,M=null,g+=b===x?m*h.blankLineScale:m),x=i}s.height=h.capHeight+Math.abs(g),s.calculateWidths(h),s.alignRuns(a,o),v&&(s.colorStack.length=0)}else s.height=h.capHeight},this.calculateWidths=function(t){for(var e,i=0,r=n(s.runs),a=0,o=s.runs.length;a<o;a++){for(var l=r[a],u=l.xAdvances,h=l.x+u[0],c=0,f=l.glyphs,d=0;d<l.glyphs.length;){var v=f[d],p=s.getGlyphWidth(v,t);c=Math.max(c,h+p),h+=null!==(e=u[++d])&&void 0!==e?e:0}l.width=Math.max(h,c)-l.x,i=Math.max(i,l.x+(isNaN(l.width)?h:l.width))}s.width=i},this.alignRuns=function(t,e){if(0===(e&o.Align.left))for(var i=0!==(e&o.Align.center),r=n(s.runs),a=0,l=s.runs.length;a<l;a++){var u=r[a];u.x+=i?.5*(t-u.width):t-u.width}},this.truncate=function(t,e,i,n){var r=e.glyphs.length,a=s.glyphRunPool.obtain();t.getGlyphs(a,n,0,n.length,null);var l=0;if(a.xAdvances.length>0){s.setLastGlyphXAdvance(t,a);for(var u=a.xAdvances,h=1;h<a.xAdvances.length;h++)l+=u[h]}i-=l;for(var c=0,f=e.x,d=e.xAdvances;c<e.xAdvances.length;){if((f+=d[c])>i)break;c++}if(c>1){if(c-1>=0&&e.glyphs.length>c-1)for(var v=c-1;v<e.glyphs.length;v++)e.glyphs.splice(v,1);if(c>=0&&e.xAdvances.length>c)for(var p=c;p<e.xAdvances.length;p++)e.xAdvances.splice(p,1);s.setLastGlyphXAdvance(t,e),a.xAdvances.length>0&&o.Utils.arrayCopy(a.xAdvances,1,e.xAdvances,e.xAdvances.length,a.xAdvances.length-1)}else e.glyphs.length=0,e.xAdvances.length=0,o.Utils.arrayCopy(a.xAdvances,0,e.xAdvances,e.xAdvances.length,a.xAdvances.length);var g=r-e.glyphs.length;if(g>0&&(s.glyphCount-=g,t.markupEnabled))for(;s.colors.length>2&&s.colors[s.colors.length-2]>=s.glyphCount;)s.colors.length-=2;o.Utils.arrayCopy(a.glyphs,0,e.glyphs,e.glyphs.length,a.glyphs.length),s.glyphCount+=n.length,s.glyphRunPool.free(a)},this.setLastGlyphXAdvance=function(t,e){var i=e.glyphs[e.glyphs.length-1];i.fixedWidth||(e.xAdvances[e.xAdvances.length-1]=s.getGlyphWidth(i,t))},this.getGlyphWidth=function(t,e){return(t.width+t.xoffset)*e.scaleX-e.padRight},this.getLineOffset=function(t,e){return-t[0].xoffset*e.scaleX-e.padLeft},this.reset=function(){s.glyphRunPool.freeAll(s.runs),s.runs.length=0,s.colors.length=0,s.glyphCount=0,s.width=0,s.height=0},e&&i&&this.setText(e,i,l,u,h,c,f,d,v)}return s(t,[{key:"wrap",value:function(t,e,i){for(var n=e.glyphs.length,r=e.glyphs,s=e.xAdvances,a=i;a>0&&t.isWhitespace(r[a-1].id);a--);for(var l,u=i;u<n&&t.isWhitespace(r[u].id);u++);if(u<n){var h=(l=this.glyphRunPool.obtain()).glyphs;o.Utils.arrayCopy(r,0,h,h.length,a),r.splice(0,u-1+1),e.glyphs=h,l.glyphs=r;var c=l.xAdvances;o.Utils.arrayCopy(s,0,c,c.length,a+1),s.splice(1,u),s[0]=this.getLineOffset(r,t),e.xAdvances=c,l.xAdvances=s;var f=e.glyphs.length,d=l.glyphs.length,v=n-f-d;if(this.glyphCount-=v,t.markupEnabled&&v>0)for(var p=this.glyphCount-d,g=this.colors.length-2;g>=2;g-=2){var m=this.colors[g];if(m<=p)break;this.colors[g]=m-v}}else{r=r.slice(0,a),s=s.slice(0,a+1);var y=u-a;if(y>0&&(this.glyphCount-=y,t.markupEnabled&&this.colors[this.colors.length-2]>this.glyphCount)){for(var M=this.colors[this.colors.length-1];this.colors[this.colors.length-2]>this.glyphCount;)this.colors.length-=2;this.colors[this.colors.length-2]=this.glyphCount,this.colors[this.colors.length-1]=M}}return 0===a?(this.glyphRunPool.free(e),this.runs.pop()):this.setLastGlyphXAdvance(t,e),l}}]),t}();e.GlyphLayout=l},1013:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphRun=void 0;var s=n((function t(){var e=this;r(this,t),this.glyphs=[],this.xAdvances=[],this.appendRun=function(t){e.glyphs.concat(t.glyphs),e.xAdvances.length||e.xAdvances.length--,e.xAdvances.concat(t.xAdvances)},this.reset=function(){e.glyphs.length=0,e.xAdvances.length=0}}));e.GlyphRun=s},3233:function(t,e,i){"use strict";var n,r=i(4704).default,s=i(6690).default,a=i(9728).default,o=i(8416).default;Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.InputEvent=void 0;var l,u=i(7465),h=i(3192);!function(t){t.TouchStart="touchStart",t.TouchEnd="touchEnd",t.TouchMove="touchMove"}(l=e.InputEvent||(e.InputEvent={}));var c=(o(n={},l.TouchStart,"mousedown"),o(n,l.TouchEnd,"mouseup"),o(n,l.TouchMove,"mousemove"),n),f=function(t,e){var i=new MouseEvent(c[t],{clientX:e.x,clientY:e.y});return i.id=e.id,i},d=function(){function t(e){var i=this;s(this,t),this.screenCoord=new h.Vector2,this.worldCoord=new h.Vector2,this.canvas=e,this.lastX=0,this.lastY=0,this.touched=!1,this.touches=[];var n=this.emitter=new u.EventEmitter;this.mouseDownHandler=function(t){i.touched=!0,i.handleMove(t),n.emit(l.TouchStart,i.getX(),i.getY())},this.mouseUpHandler=function(t){i.touched=!1,n.emit(l.TouchEnd,i.getX(),i.getY())},this.mouseMoveHandler=function(t){i.handleMove(t),n.emit(l.TouchMove,i.getX(),i.getY())},this.touchStartHandler=function(t){t.preventDefault();var e,n=r(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var s=e.value,a={x:s.clientX,y:s.clientY,id:s.identifier};i.touches.push(a);var o=f(l.TouchStart,a);i.canvas.dispatchEvent(o)}}catch(u){n.e(u)}finally{n.f()}},this.touchEndHandler=function(t){t.preventDefault();var e,n=r(t.changedTouches);try{var s=function(){var t=e.value,n=i.touches.find((function(e){return e.id===t.identifier}));if(!n)return"continue";var r=f(l.TouchEnd,n);i.canvas.dispatchEvent(r);var s=i.touches.indexOf(n);i.touches.splice(s,1)};for(n.s();!(e=n.n()).done;)s()}catch(a){n.e(a)}finally{n.f()}},this.touchMoveHandler=function(t){t.preventDefault();var e,n=r(t.changedTouches);try{for(n.s();!(e=n.n()).done;){var s,a=e.value,o=r(i.touches);try{for(o.s();!(s=o.n()).done;){var u=s.value;if(u.id===a.identifier){u.x=a.clientX,u.y=a.clientY;var h=f(l.TouchMove,u);i.canvas.dispatchEvent(h);break}}}catch(c){o.e(c)}finally{o.f()}}}catch(c){n.e(c)}finally{n.f()}},this.canvas.addEventListener("mousedown",this.mouseDownHandler,!1),this.canvas.addEventListener("mouseup",this.mouseUpHandler,!1),this.canvas.addEventListener("mousemove",this.mouseMoveHandler,!1),this.canvas.addEventListener("touchstart",this.touchStartHandler,!1),this.canvas.addEventListener("touchend",this.touchEndHandler,!1),this.canvas.addEventListener("touchmove",this.touchMoveHandler,!1)}return a(t,[{key:"cleanup",value:function(){this.canvas.removeEventListener("mousedown",this.mouseDownHandler),this.canvas.removeEventListener("mouseup",this.mouseUpHandler),this.canvas.removeEventListener("mousemove",this.mouseMoveHandler),this.canvas.removeEventListener("touchstart",this.touchStartHandler),this.canvas.removeEventListener("touchend",this.touchEndHandler),this.canvas.removeEventListener("touchmove",this.touchMoveHandler)}},{key:"addEventListener",value:function(t,e){this.emitter.addListener(t,e)}},{key:"handleMove",value:function(t){var e=this.canvas.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;this.lastX=i,this.lastY=n}},{key:"getX",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=null===(t=this.touches[e])||void 0===t?void 0:t.x;return void 0===i?this.lastX:i}},{key:"getY",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=null===(t=this.touches[e])||void 0===t?void 0:t.y;return void 0===i?this.lastY:i}},{key:"isTouched",value:function(){return this.touches.length>0||this.touched}},{key:"getTouchedWorldCoord",value:function(t){return this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),t}();e.InputHandler=d},176:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix3=void 0;var a=i(5474),o=i(8637),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r(this,t),this.val=new Array(9),this.tmp=new Array(9),e?this.setByMatrix3(e):this.idt()}return s(t,[{key:"idt",value:function(){var e=this.val;return e[t.M00]=1,e[t.M10]=0,e[t.M20]=0,e[t.M01]=0,e[t.M11]=1,e[t.M21]=0,e[t.M02]=0,e[t.M12]=0,e[t.M22]=1,this}},{key:"mulWithMatrix3",value:function(e){var i=this.val,n=i[t.M00]*e.val[t.M00]+i[t.M01]*e.val[t.M10]+i[t.M02]*e.val[t.M20],r=i[t.M00]*e.val[t.M01]+i[t.M01]*e.val[t.M11]+i[t.M02]*e.val[t.M21],s=i[t.M00]*e.val[t.M02]+i[t.M01]*e.val[t.M12]+i[t.M02]*e.val[t.M22],a=i[t.M10]*e.val[t.M00]+i[t.M11]*e.val[t.M10]+i[t.M12]*e.val[t.M20],o=i[t.M10]*e.val[t.M01]+i[t.M11]*e.val[t.M11]+i[t.M12]*e.val[t.M21],l=i[t.M10]*e.val[t.M02]+i[t.M11]*e.val[t.M12]+i[t.M12]*e.val[t.M22],u=i[t.M20]*e.val[t.M00]+i[t.M21]*e.val[t.M10]+i[t.M22]*e.val[t.M20],h=i[t.M20]*e.val[t.M01]+i[t.M21]*e.val[t.M11]+i[t.M22]*e.val[t.M21],c=i[t.M20]*e.val[t.M02]+i[t.M21]*e.val[t.M12]+i[t.M22]*e.val[t.M22];return i[t.M00]=n,i[t.M10]=a,i[t.M20]=u,i[t.M01]=r,i[t.M11]=o,i[t.M21]=h,i[t.M02]=s,i[t.M12]=l,i[t.M22]=c,this}},{key:"mulLeft",value:function(e){var i=this.val,n=e.val[t.M00]*i[t.M00]+e.val[t.M01]*i[t.M10]+e.val[t.M02]*i[t.M20],r=e.val[t.M00]*i[t.M01]+e.val[t.M01]*i[t.M11]+e.val[t.M02]*i[t.M21],s=e.val[t.M00]*i[t.M02]+e.val[t.M01]*i[t.M12]+e.val[t.M02]*i[t.M22],a=e.val[t.M10]*i[t.M00]+e.val[t.M11]*i[t.M10]+e.val[t.M12]*i[t.M20],o=e.val[t.M10]*i[t.M01]+e.val[t.M11]*i[t.M11]+e.val[t.M12]*i[t.M21],l=e.val[t.M10]*i[t.M02]+e.val[t.M11]*i[t.M12]+e.val[t.M12]*i[t.M22],u=e.val[t.M20]*i[t.M00]+e.val[t.M21]*i[t.M10]+e.val[t.M22]*i[t.M20],h=e.val[t.M20]*i[t.M01]+e.val[t.M21]*i[t.M11]+e.val[t.M22]*i[t.M21],c=e.val[t.M20]*i[t.M02]+e.val[t.M21]*i[t.M12]+e.val[t.M22]*i[t.M22];return i[t.M00]=n,i[t.M10]=a,i[t.M20]=u,i[t.M01]=r,i[t.M11]=o,i[t.M21]=h,i[t.M02]=s,i[t.M12]=l,i[t.M22]=c,this}},{key:"setToRotation",value:function(t){return this.setToRotationRad(o.MathUtils.degreesToRadians*t)}},{key:"setToRotationRad",value:function(e){var i=Math.cos(e),n=Math.sin(e),r=this.val;return r[t.M00]=i,r[t.M10]=n,r[t.M20]=0,r[t.M01]=-n,r[t.M11]=i,r[t.M21]=0,r[t.M02]=0,r[t.M12]=0,r[t.M22]=1,this}},{key:"setToRotationWithAxis",value:function(e,i){var n=Math.cos(i),r=Math.sin(i),s=this.val,a=1-n;return s[t.M00]=a*e.x*e.x+n,s[t.M01]=a*e.x*e.y-e.z*r,s[t.M02]=a*e.z*e.x+e.y*r,s[t.M10]=a*e.x*e.y+e.z*r,s[t.M11]=a*e.y*e.y+n,s[t.M12]=a*e.y*e.z-e.x*r,s[t.M20]=a*e.z*e.x-e.y*r,s[t.M21]=a*e.y*e.z+e.x*r,s[t.M22]=a*e.z*e.z+n,this}},{key:"setToTranslation",value:function(e,i){var n=this.val;return n[t.M00]=1,n[t.M10]=0,n[t.M20]=0,n[t.M01]=0,n[t.M11]=1,n[t.M21]=0,n[t.M02]=e,n[t.M12]=i,n[t.M22]=1,this}},{key:"setToScaling",value:function(e,i){var n=this.val;return n[t.M00]=e,n[t.M10]=0,n[t.M20]=0,n[t.M01]=0,n[t.M11]=i,n[t.M21]=0,n[t.M02]=0,n[t.M12]=0,n[t.M22]=1,this}},{key:"toString",value:function(){var e=this.val;return"["+e[t.M00]+"|"+e[t.M01]+"|"+e[t.M02]+"]\n["+e[t.M10]+"|"+e[t.M11]+"|"+e[t.M12]+"]\n["+e[t.M20]+"|"+e[t.M21]+"|"+e[t.M22]+"]"}},{key:"det",value:function(){var e=this.val;return e[t.M00]*e[t.M11]*e[t.M22]+e[t.M01]*e[t.M12]*e[t.M20]+e[t.M02]*e[t.M10]*e[t.M21]-e[t.M00]*e[t.M12]*e[t.M21]-e[t.M01]*e[t.M10]*e[t.M22]-e[t.M02]*e[t.M11]*e[t.M20]}},{key:"inv",value:function(){var e=this.det();if(0===e)throw new Error("Can't invert a singular matrix");var i=1/e,n=this.tmp,r=this.val;return n[t.M00]=r[t.M11]*r[t.M22]-r[t.M21]*r[t.M12],n[t.M10]=r[t.M20]*r[t.M12]-r[t.M10]*r[t.M22],n[t.M20]=r[t.M10]*r[t.M21]-r[t.M20]*r[t.M11],n[t.M01]=r[t.M21]*r[t.M02]-r[t.M01]*r[t.M22],n[t.M11]=r[t.M00]*r[t.M22]-r[t.M20]*r[t.M02],n[t.M21]=r[t.M20]*r[t.M01]-r[t.M00]*r[t.M21],n[t.M02]=r[t.M01]*r[t.M12]-r[t.M11]*r[t.M02],n[t.M12]=r[t.M10]*r[t.M02]-r[t.M00]*r[t.M12],n[t.M22]=r[t.M00]*r[t.M11]-r[t.M10]*r[t.M01],r[t.M00]=i*n[t.M00],r[t.M10]=i*n[t.M10],r[t.M20]=i*n[t.M20],r[t.M01]=i*n[t.M01],r[t.M11]=i*n[t.M11],r[t.M21]=i*n[t.M21],r[t.M02]=i*n[t.M02],r[t.M12]=i*n[t.M12],r[t.M22]=i*n[t.M22],this}},{key:"setByMatrix3",value:function(t){var e,i=n(t.val);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.val.push(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"setByMatrix4",value:function(e){var i=this.val;return i[t.M00]=e.values[a.Matrix4.M00],i[t.M10]=e.values[a.Matrix4.M10],i[t.M20]=e.values[a.Matrix4.M20],i[t.M01]=e.values[a.Matrix4.M01],i[t.M11]=e.values[a.Matrix4.M11],i[t.M21]=e.values[a.Matrix4.M21],i[t.M02]=e.values[a.Matrix4.M02],i[t.M12]=e.values[a.Matrix4.M12],i[t.M22]=e.values[a.Matrix4.M22],this}},{key:"trnByVector2",value:function(e){var i=this.val;return i[t.M02]+=e.x,i[t.M12]+=e.y,this}},{key:"trnByMatrix3",value:function(e,i){var n=this.val;return n[t.M02]+=e,n[t.M12]+=i,this}},{key:"trnByVector3",value:function(e){var i=this.val;return i[t.M02]+=e.x,i[t.M12]+=e.y,this}},{key:"translate",value:function(e,i){var n=this.val;return this.tmp[t.M00]=1,this.tmp[t.M10]=0,this.tmp[t.M20]=0,this.tmp[t.M01]=0,this.tmp[t.M11]=1,this.tmp[t.M21]=0,this.tmp[t.M02]=e,this.tmp[t.M12]=i,this.tmp[t.M22]=1,t.mul(n,this.tmp),this}},{key:"rotate",value:function(t){return this.rotateRad(o.MathUtils.degreesToRadians*t)}},{key:"rotateRad",value:function(e){if(0===e)return this;var i=Math.cos(e),n=Math.sin(e),r=this.tmp;return r[t.M00]=i,r[t.M10]=n,r[t.M20]=0,r[t.M01]=-n,r[t.M11]=i,r[t.M21]=0,r[t.M02]=0,r[t.M12]=0,r[t.M22]=1,t.mul(this.val,r),this}},{key:"scale",value:function(e,i){var n=this.tmp;return n[t.M00]=e,n[t.M10]=0,n[t.M20]=0,n[t.M01]=0,n[t.M11]=i,n[t.M21]=0,n[t.M02]=0,n[t.M12]=0,n[t.M22]=1,t.mul(this.val,n),this}},{key:"getValues",value:function(){return this.val}},{key:"getTranslation",value:function(e){return e.x=this.val[t.M02],e.y=this.val[t.M12],e}},{key:"getScale",value:function(e){var i=this.val;return e.x=Math.sqrt(i[t.M00]*i[t.M00]+i[t.M01]*i[t.M01]),e.y=Math.sqrt(i[t.M10]*i[t.M10]+i[t.M11]*i[t.M11]),e}},{key:"getRotation",value:function(){return o.MathUtils.radiansToDegrees*Math.atan2(this.val[t.M10],this.val[t.M00])}},{key:"getRotationRad",value:function(){return Math.atan2(this.val[t.M10],this.val[t.M00])}},{key:"sclByNumber",value:function(e){return this.val[t.M00]*=e,this.val[t.M11]*=e,this}},{key:"sclByVector2",value:function(e){return this.val[t.M00]*=e.x,this.val[t.M11]*=e.y,this}},{key:"scl",value:function(e){return this.val[t.M00]*=e.x,this.val[t.M11]*=e.y,this}},{key:"transpose",value:function(){var e=this.val,i=e[t.M10],n=e[t.M20],r=e[t.M01],s=e[t.M21],a=e[t.M02],o=e[t.M12];return e[t.M01]=i,e[t.M02]=n,e[t.M10]=r,e[t.M12]=s,e[t.M20]=a,e[t.M21]=o,this}}],[{key:"mul",value:function(e,i){var n=e[t.M00]*i[t.M00]+e[t.M01]*i[t.M10]+e[t.M02]*i[t.M20],r=e[t.M00]*i[t.M01]+e[t.M01]*i[t.M11]+e[t.M02]*i[t.M21],s=e[t.M00]*i[t.M02]+e[t.M01]*i[t.M12]+e[t.M02]*i[t.M22],a=e[t.M10]*i[t.M00]+e[t.M11]*i[t.M10]+e[t.M12]*i[t.M20],o=e[t.M10]*i[t.M01]+e[t.M11]*i[t.M11]+e[t.M12]*i[t.M21],l=e[t.M10]*i[t.M02]+e[t.M11]*i[t.M12]+e[t.M12]*i[t.M22],u=e[t.M20]*i[t.M00]+e[t.M21]*i[t.M10]+e[t.M22]*i[t.M20],h=e[t.M20]*i[t.M01]+e[t.M21]*i[t.M11]+e[t.M22]*i[t.M21],c=e[t.M20]*i[t.M02]+e[t.M21]*i[t.M12]+e[t.M22]*i[t.M22];e[t.M00]=n,e[t.M10]=a,e[t.M20]=u,e[t.M01]=r,e[t.M11]=o,e[t.M21]=h,e[t.M02]=s,e[t.M12]=l,e[t.M22]=c}}]),t}();e.Matrix3=l,l.M00=0,l.M01=3,l.M02=6,l.M10=1,l.M11=4,l.M12=7,l.M20=2,l.M21=5,l.M22=8},5474:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix4=void 0;var s=i(4496),a=i(8637),o=i(2668),l=function(){function t(){n(this,t),this.temp=new Float32Array(16),this.values=new Float32Array(16);var e=this.values;e[t.M00]=1,e[t.M11]=1,e[t.M22]=1,e[t.M33]=1}return r(t,[{key:"set",value:function(t){return this.values.set(t),this}},{key:"setFromQuaternion",value:function(e){var i=2*e.x,n=2*e.y,r=2*e.z,s=e.w*i,a=e.w*n,o=e.w*r,l=e.x*i,u=e.x*n,h=e.x*r,c=e.y*n,f=e.y*r,d=e.z*r,v=this.values;return v[t.M00]=1-(c+d),v[t.M01]=u-o,v[t.M02]=h+a,v[t.M03]=0,v[t.M10]=u+o,v[t.M11]=1-(l+d),v[t.M12]=f-s,v[t.M13]=0,v[t.M20]=h-a,v[t.M21]=f+s,v[t.M22]=1-(l+c),v[t.M23]=0,v[t.M30]=0,v[t.M31]=0,v[t.M32]=0,v[t.M33]=1,this}},{key:"setFromTranslationRotation",value:function(e,i,n){var r=2*i.x,s=2*i.y,a=2*i.z,o=i.w*r,l=i.w*s,u=i.w*a,h=i.x*r,c=i.x*s,f=i.x*a,d=i.y*s,v=i.y*a,p=i.z*a,g=this.values;return g[t.M00]=n.x*(1-(d+p)),g[t.M01]=n.y*(c-u),g[t.M02]=n.z*(f+l),g[t.M03]=e.x,g[t.M10]=n.x*(c+u),g[t.M11]=n.y*(1-(h+p)),g[t.M12]=n.z*(v-o),g[t.M13]=e.y,g[t.M20]=n.x*(f-l),g[t.M21]=n.y*(v+o),g[t.M22]=n.z*(1-(h+d)),g[t.M23]=e.z,g[t.M30]=0,g[t.M31]=0,g[t.M32]=0,g[t.M33]=1,this}},{key:"transpose",value:function(){var e=this.temp,i=this.values;return e[t.M00]=i[t.M00],e[t.M01]=i[t.M10],e[t.M02]=i[t.M20],e[t.M03]=i[t.M30],e[t.M10]=i[t.M01],e[t.M11]=i[t.M11],e[t.M12]=i[t.M21],e[t.M13]=i[t.M31],e[t.M20]=i[t.M02],e[t.M21]=i[t.M12],e[t.M22]=i[t.M22],e[t.M23]=i[t.M32],e[t.M30]=i[t.M03],e[t.M31]=i[t.M13],e[t.M32]=i[t.M23],e[t.M33]=i[t.M33],this.set(e)}},{key:"identity",value:function(){var e=this.values;return e[t.M00]=1,e[t.M01]=0,e[t.M02]=0,e[t.M03]=0,e[t.M10]=0,e[t.M11]=1,e[t.M12]=0,e[t.M13]=0,e[t.M20]=0,e[t.M21]=0,e[t.M22]=1,e[t.M23]=0,e[t.M30]=0,e[t.M31]=0,e[t.M32]=0,e[t.M33]=1,this}},{key:"invert",value:function(){var e=this.values,i=this.temp,n=e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33];if(0===n)throw new Error("non-invertible matrix");var r=1/n;return i[t.M00]=e[t.M12]*e[t.M23]*e[t.M31]-e[t.M13]*e[t.M22]*e[t.M31]+e[t.M13]*e[t.M21]*e[t.M32]-e[t.M11]*e[t.M23]*e[t.M32]-e[t.M12]*e[t.M21]*e[t.M33]+e[t.M11]*e[t.M22]*e[t.M33],i[t.M01]=e[t.M03]*e[t.M22]*e[t.M31]-e[t.M02]*e[t.M23]*e[t.M31]-e[t.M03]*e[t.M21]*e[t.M32]+e[t.M01]*e[t.M23]*e[t.M32]+e[t.M02]*e[t.M21]*e[t.M33]-e[t.M01]*e[t.M22]*e[t.M33],i[t.M02]=e[t.M02]*e[t.M13]*e[t.M31]-e[t.M03]*e[t.M12]*e[t.M31]+e[t.M03]*e[t.M11]*e[t.M32]-e[t.M01]*e[t.M13]*e[t.M32]-e[t.M02]*e[t.M11]*e[t.M33]+e[t.M01]*e[t.M12]*e[t.M33],i[t.M03]=e[t.M03]*e[t.M12]*e[t.M21]-e[t.M02]*e[t.M13]*e[t.M21]-e[t.M03]*e[t.M11]*e[t.M22]+e[t.M01]*e[t.M13]*e[t.M22]+e[t.M02]*e[t.M11]*e[t.M23]-e[t.M01]*e[t.M12]*e[t.M23],i[t.M10]=e[t.M13]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M20]*e[t.M32]+e[t.M10]*e[t.M23]*e[t.M32]+e[t.M12]*e[t.M20]*e[t.M33]-e[t.M10]*e[t.M22]*e[t.M33],i[t.M11]=e[t.M02]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M22]*e[t.M30]+e[t.M03]*e[t.M20]*e[t.M32]-e[t.M00]*e[t.M23]*e[t.M32]-e[t.M02]*e[t.M20]*e[t.M33]+e[t.M00]*e[t.M22]*e[t.M33],i[t.M12]=e[t.M03]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M10]*e[t.M32]+e[t.M00]*e[t.M13]*e[t.M32]+e[t.M02]*e[t.M10]*e[t.M33]-e[t.M00]*e[t.M12]*e[t.M33],i[t.M13]=e[t.M02]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M12]*e[t.M20]+e[t.M03]*e[t.M10]*e[t.M22]-e[t.M00]*e[t.M13]*e[t.M22]-e[t.M02]*e[t.M10]*e[t.M23]+e[t.M00]*e[t.M12]*e[t.M23],i[t.M20]=e[t.M11]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M21]*e[t.M30]+e[t.M13]*e[t.M20]*e[t.M31]-e[t.M10]*e[t.M23]*e[t.M31]-e[t.M11]*e[t.M20]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M33],i[t.M21]=e[t.M03]*e[t.M21]*e[t.M30]-e[t.M01]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M20]*e[t.M31]+e[t.M00]*e[t.M23]*e[t.M31]+e[t.M01]*e[t.M20]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M33],i[t.M22]=e[t.M01]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M11]*e[t.M30]+e[t.M03]*e[t.M10]*e[t.M31]-e[t.M00]*e[t.M13]*e[t.M31]-e[t.M01]*e[t.M10]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M33],i[t.M23]=e[t.M03]*e[t.M11]*e[t.M20]-e[t.M01]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M10]*e[t.M21]+e[t.M00]*e[t.M13]*e[t.M21]+e[t.M01]*e[t.M10]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M23],i[t.M30]=e[t.M12]*e[t.M21]*e[t.M30]-e[t.M11]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M20]*e[t.M31]+e[t.M10]*e[t.M22]*e[t.M31]+e[t.M11]*e[t.M20]*e[t.M32]-e[t.M10]*e[t.M21]*e[t.M32],i[t.M31]=e[t.M01]*e[t.M22]*e[t.M30]-e[t.M02]*e[t.M21]*e[t.M30]+e[t.M02]*e[t.M20]*e[t.M31]-e[t.M00]*e[t.M22]*e[t.M31]-e[t.M01]*e[t.M20]*e[t.M32]+e[t.M00]*e[t.M21]*e[t.M32],i[t.M32]=e[t.M02]*e[t.M11]*e[t.M30]-e[t.M01]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M10]*e[t.M31]+e[t.M00]*e[t.M12]*e[t.M31]+e[t.M01]*e[t.M10]*e[t.M32]-e[t.M00]*e[t.M11]*e[t.M32],i[t.M33]=e[t.M01]*e[t.M12]*e[t.M20]-e[t.M02]*e[t.M11]*e[t.M20]+e[t.M02]*e[t.M10]*e[t.M21]-e[t.M00]*e[t.M12]*e[t.M21]-e[t.M01]*e[t.M10]*e[t.M22]+e[t.M00]*e[t.M11]*e[t.M22],e[t.M00]=i[t.M00]*r,e[t.M01]=i[t.M01]*r,e[t.M02]=i[t.M02]*r,e[t.M03]=i[t.M03]*r,e[t.M10]=i[t.M10]*r,e[t.M11]=i[t.M11]*r,e[t.M12]=i[t.M12]*r,e[t.M13]=i[t.M13]*r,e[t.M20]=i[t.M20]*r,e[t.M21]=i[t.M21]*r,e[t.M22]=i[t.M22]*r,e[t.M23]=i[t.M23]*r,e[t.M30]=i[t.M30]*r,e[t.M31]=i[t.M31]*r,e[t.M32]=i[t.M32]*r,e[t.M33]=i[t.M33]*r,this}},{key:"determinant",value:function(){var e=this.values;return e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33]}},{key:"translate",value:function(e,i,n){var r=this.values;return r[t.M03]+=e,r[t.M13]+=i,r[t.M23]+=n,this}},{key:"setTranslation",value:function(e,i,n){var r=this.values;return r[t.M03]=e,r[t.M13]=i,r[t.M23]=n,this}},{key:"getTranslation",value:function(e){var i=this.values;return e.x=i[t.M03],e.y=i[t.M13],e.z=i[t.M23],e}},{key:"hasRotationOrScaling",value:function(){var e=this.values;return!(a.MathUtils.isEqual(e[t.M00],1)&&a.MathUtils.isEqual(e[t.M11],1)&&a.MathUtils.isEqual(e[t.M22],1)&&a.MathUtils.isZero(e[t.M01])&&a.MathUtils.isZero(e[t.M02])&&a.MathUtils.isZero(e[t.M10])&&a.MathUtils.isZero(e[t.M12])&&a.MathUtils.isZero(e[t.M20])&&a.MathUtils.isZero(e[t.M21]))}},{key:"det3x3",value:function(){var e=this.values;return e[t.M00]*e[t.M11]*e[t.M22]+e[t.M01]*e[t.M12]*e[t.M20]+e[t.M02]*e[t.M10]*e[t.M21]-e[t.M00]*e[t.M12]*e[t.M21]-e[t.M01]*e[t.M10]*e[t.M22]-e[t.M02]*e[t.M11]*e[t.M20]}},{key:"copy",value:function(){return(new t).set(this.values)}},{key:"projection",value:function(e,i,n,r){this.identity();var s=1/Math.tan(n*(Math.PI/180)/2),a=(i+e)/(e-i),o=2*i*e/(e-i),l=this.values;return l[t.M00]=s/r,l[t.M10]=0,l[t.M20]=0,l[t.M30]=0,l[t.M01]=0,l[t.M11]=s,l[t.M21]=0,l[t.M31]=0,l[t.M02]=0,l[t.M12]=0,l[t.M22]=a,l[t.M32]=-1,l[t.M03]=0,l[t.M13]=0,l[t.M23]=o,l[t.M33]=0,this}},{key:"ortho2d",value:function(t,e,i,n){return this.ortho(t,t+i,e,e+n,0,1)}},{key:"ortho",value:function(e,i,n,r,s,a){this.identity();var o=2/(i-e),l=2/(r-n),u=-2/(a-s),h=-(i+e)/(i-e),c=-(r+n)/(r-n),f=-(a+s)/(a-s),d=this.values;return d[t.M00]=o,d[t.M10]=0,d[t.M20]=0,d[t.M30]=0,d[t.M01]=0,d[t.M11]=l,d[t.M21]=0,d[t.M31]=0,d[t.M02]=0,d[t.M12]=0,d[t.M22]=u,d[t.M32]=0,d[t.M03]=h,d[t.M13]=c,d[t.M23]=f,d[t.M33]=1,this}},{key:"multiply",value:function(e){var i=this.temp,n=this.values,r=e.values;return i[t.M00]=n[t.M00]*r[t.M00]+n[t.M01]*r[t.M10]+n[t.M02]*r[t.M20]+n[t.M03]*r[t.M30],i[t.M01]=n[t.M00]*r[t.M01]+n[t.M01]*r[t.M11]+n[t.M02]*r[t.M21]+n[t.M03]*r[t.M31],i[t.M02]=n[t.M00]*r[t.M02]+n[t.M01]*r[t.M12]+n[t.M02]*r[t.M22]+n[t.M03]*r[t.M32],i[t.M03]=n[t.M00]*r[t.M03]+n[t.M01]*r[t.M13]+n[t.M02]*r[t.M23]+n[t.M03]*r[t.M33],i[t.M10]=n[t.M10]*r[t.M00]+n[t.M11]*r[t.M10]+n[t.M12]*r[t.M20]+n[t.M13]*r[t.M30],i[t.M11]=n[t.M10]*r[t.M01]+n[t.M11]*r[t.M11]+n[t.M12]*r[t.M21]+n[t.M13]*r[t.M31],i[t.M12]=n[t.M10]*r[t.M02]+n[t.M11]*r[t.M12]+n[t.M12]*r[t.M22]+n[t.M13]*r[t.M32],i[t.M13]=n[t.M10]*r[t.M03]+n[t.M11]*r[t.M13]+n[t.M12]*r[t.M23]+n[t.M13]*r[t.M33],i[t.M20]=n[t.M20]*r[t.M00]+n[t.M21]*r[t.M10]+n[t.M22]*r[t.M20]+n[t.M23]*r[t.M30],i[t.M21]=n[t.M20]*r[t.M01]+n[t.M21]*r[t.M11]+n[t.M22]*r[t.M21]+n[t.M23]*r[t.M31],i[t.M22]=n[t.M20]*r[t.M02]+n[t.M21]*r[t.M12]+n[t.M22]*r[t.M22]+n[t.M23]*r[t.M32],i[t.M23]=n[t.M20]*r[t.M03]+n[t.M21]*r[t.M13]+n[t.M22]*r[t.M23]+n[t.M23]*r[t.M33],i[t.M30]=n[t.M30]*r[t.M00]+n[t.M31]*r[t.M10]+n[t.M32]*r[t.M20]+n[t.M33]*r[t.M30],i[t.M31]=n[t.M30]*r[t.M01]+n[t.M31]*r[t.M11]+n[t.M32]*r[t.M21]+n[t.M33]*r[t.M31],i[t.M32]=n[t.M30]*r[t.M02]+n[t.M31]*r[t.M12]+n[t.M32]*r[t.M22]+n[t.M33]*r[t.M32],i[t.M33]=n[t.M30]*r[t.M03]+n[t.M31]*r[t.M13]+n[t.M32]*r[t.M23]+n[t.M33]*r[t.M33],this.set(this.temp)}},{key:"multiplyLeft",value:function(e){var i=this.temp,n=this.values,r=e.values;return i[t.M00]=r[t.M00]*n[t.M00]+r[t.M01]*n[t.M10]+r[t.M02]*n[t.M20]+r[t.M03]*n[t.M30],i[t.M01]=r[t.M00]*n[t.M01]+r[t.M01]*n[t.M11]+r[t.M02]*n[t.M21]+r[t.M03]*n[t.M31],i[t.M02]=r[t.M00]*n[t.M02]+r[t.M01]*n[t.M12]+r[t.M02]*n[t.M22]+r[t.M03]*n[t.M32],i[t.M03]=r[t.M00]*n[t.M03]+r[t.M01]*n[t.M13]+r[t.M02]*n[t.M23]+r[t.M03]*n[t.M33],i[t.M10]=r[t.M10]*n[t.M00]+r[t.M11]*n[t.M10]+r[t.M12]*n[t.M20]+r[t.M13]*n[t.M30],i[t.M11]=r[t.M10]*n[t.M01]+r[t.M11]*n[t.M11]+r[t.M12]*n[t.M21]+r[t.M13]*n[t.M31],i[t.M12]=r[t.M10]*n[t.M02]+r[t.M11]*n[t.M12]+r[t.M12]*n[t.M22]+r[t.M13]*n[t.M32],i[t.M13]=r[t.M10]*n[t.M03]+r[t.M11]*n[t.M13]+r[t.M12]*n[t.M23]+r[t.M13]*n[t.M33],i[t.M20]=r[t.M20]*n[t.M00]+r[t.M21]*n[t.M10]+r[t.M22]*n[t.M20]+r[t.M23]*n[t.M30],i[t.M21]=r[t.M20]*n[t.M01]+r[t.M21]*n[t.M11]+r[t.M22]*n[t.M21]+r[t.M23]*n[t.M31],i[t.M22]=r[t.M20]*n[t.M02]+r[t.M21]*n[t.M12]+r[t.M22]*n[t.M22]+r[t.M23]*n[t.M32],i[t.M23]=r[t.M20]*n[t.M03]+r[t.M21]*n[t.M13]+r[t.M22]*n[t.M23]+r[t.M23]*n[t.M33],i[t.M30]=r[t.M30]*n[t.M00]+r[t.M31]*n[t.M10]+r[t.M32]*n[t.M20]+r[t.M33]*n[t.M30],i[t.M31]=r[t.M30]*n[t.M01]+r[t.M31]*n[t.M11]+r[t.M32]*n[t.M21]+r[t.M33]*n[t.M31],i[t.M32]=r[t.M30]*n[t.M02]+r[t.M31]*n[t.M12]+r[t.M32]*n[t.M22]+r[t.M33]*n[t.M32],i[t.M33]=r[t.M30]*n[t.M03]+r[t.M31]*n[t.M13]+r[t.M32]*n[t.M23]+r[t.M33]*n[t.M33],this.set(this.temp)}},{key:"idt",value:function(){var e=this.values;return e[t.M00]=1,e[t.M01]=0,e[t.M02]=0,e[t.M03]=0,e[t.M10]=0,e[t.M11]=1,e[t.M12]=0,e[t.M13]=0,e[t.M20]=0,e[t.M21]=0,e[t.M22]=1,e[t.M23]=0,e[t.M30]=0,e[t.M31]=0,e[t.M32]=0,e[t.M33]=1,this}},{key:"lookAt",value:function(e,i,n){t.initTemps();var r=t.xAxis,s=t.yAxis,a=t.zAxis;a.setFrom(i).normalize(),r.setFrom(i).normalize(),r.cross(n).normalize(),s.setFrom(r).cross(a).normalize(),this.identity();var o=this.values;return o[t.M00]=r.x,o[t.M01]=r.y,o[t.M02]=r.z,o[t.M10]=s.x,o[t.M11]=s.y,o[t.M12]=s.z,o[t.M20]=-a.x,o[t.M21]=-a.y,o[t.M22]=-a.z,t.tmpMatrix.identity(),t.tmpMatrix.values[t.M03]=-e.x,t.tmpMatrix.values[t.M13]=-e.y,t.tmpMatrix.values[t.M23]=-e.z,this.multiply(t.tmpMatrix),this}},{key:"setToLookAt",value:function(e,i,n){return null===t.tempVec&&(t.tempVec=new o.Vector3),t.tempVec.setFrom(i).sub(e),this.lookAt(e,t.tempVec,n),this}},{key:"rotate",value:function(e){var i=e.x,n=e.y,r=e.z,s=e.w,a=i*i,o=i*n,l=i*r,u=i*s,h=n*n,c=n*r,f=n*s,d=r*r,v=r*s,p=1-2*(h+d),g=2*(o-v),m=2*(l+f),y=2*(o+v),M=1-2*(a+d),x=2*(c-u),b=2*(l-f),w=2*(c+u),_=1-2*(a+h),T=this.values,A=T[t.M00]*p+T[t.M01]*y+T[t.M02]*b,k=T[t.M00]*g+T[t.M01]*M+T[t.M02]*w,L=T[t.M00]*m+T[t.M01]*x+T[t.M02]*_,S=T[t.M10]*p+T[t.M11]*y+T[t.M12]*b,E=T[t.M10]*g+T[t.M11]*M+T[t.M12]*w,C=T[t.M10]*m+T[t.M11]*x+T[t.M12]*_,P=T[t.M20]*p+T[t.M21]*y+T[t.M22]*b,R=T[t.M20]*g+T[t.M21]*M+T[t.M22]*w,I=T[t.M20]*m+T[t.M21]*x+T[t.M22]*_,F=T[t.M30]*p+T[t.M31]*y+T[t.M32]*b,G=T[t.M30]*g+T[t.M31]*M+T[t.M32]*w,B=T[t.M30]*m+T[t.M31]*x+T[t.M32]*_;return T[t.M00]=A,T[t.M10]=S,T[t.M20]=P,T[t.M30]=F,T[t.M01]=k,T[t.M11]=E,T[t.M21]=R,T[t.M31]=G,T[t.M02]=L,T[t.M12]=C,T[t.M22]=I,T[t.M32]=B,this}},{key:"scale",value:function(e,i,n){var r=this.values;return r[t.M00]*=e,r[t.M01]*=i,r[t.M02]*=n,r[t.M10]*=e,r[t.M11]*=i,r[t.M12]*=n,r[t.M20]*=e,r[t.M21]*=i,r[t.M22]*=n,r[t.M30]*=e,r[t.M31]*=i,r[t.M32]*=n,this}},{key:"setToRotation",value:function(e,i){return 0===i?(this.idt(),this):this.setFromQuaternion(t.quat.setFromAxis(e.x,e.y,e.z,i))}}],[{key:"initTemps",value:function(){null===t.xAxis&&(t.xAxis=new o.Vector3),null===t.yAxis&&(t.yAxis=new o.Vector3),null===t.zAxis&&(t.zAxis=new o.Vector3)}},{key:"matrix4_proj",value:function(e,i){var n=1/(i[0]*e[t.M30]+i[1]*e[t.M31]+i[2]*e[t.M32]+e[t.M33]),r=(i[0]*e[t.M00]+i[1]*e[t.M01]+i[2]*e[t.M02]+e[t.M03])*n,s=(i[0]*e[t.M10]+i[1]*e[t.M11]+i[2]*e[t.M12]+e[t.M13])*n,a=(i[0]*e[t.M20]+i[1]*e[t.M21]+i[2]*e[t.M22]+e[t.M23])*n;i[0]=r,i[1]=s,i[2]=a}},{key:"prj",value:function(e,i,n,r,s){for(var a=t.tmpArrayForVec,o=0;o<r;o++){var l=n+o*s,u=0;a[u]=i[l+u++],a[u]=i[l+u++],a[u]=i[l+u++],u=0,t.matrix4_proj(e.values,a),i[o*s+u]=a[u++],i[o*s+u]=a[u++],i[o*s+u]=a[u++]}}}]),t}();e.Matrix4=l,l.M00=0,l.M01=4,l.M02=8,l.M03=12,l.M10=1,l.M11=5,l.M12=9,l.M13=13,l.M20=2,l.M21=6,l.M22=10,l.M23=14,l.M30=3,l.M31=7,l.M32=11,l.M33=15,l.xAxis=null,l.yAxis=null,l.zAxis=null,l.tempVec=null,l.tmpMatrix=new l,l.quat=new s.Quaternion,l.tmpArrayForVec=[]},4731:function(t,e,i){"use strict";var n=i(1655).default,r=i(6389).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Color2Attribute=e.ColorAttribute=e.TexCoordAttribute=e.Position3Attribute=e.Position2Attribute=e.VertexAttribute=e.VertexAttributeType=e.Mesh=void 0;var o,l=i(6403),u=function(){function t(e,i,n,r){s(this,t),this.attributes=i,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=e,this.elementsPerVertex=0;for(var a=0;a<i.length;a++)this.elementsPerVertex+=i[a].numElements;this.vertices=new Float32Array(n*this.elementsPerVertex),this.indices=new Uint16Array(r)}return a(t,[{key:"getAttributes",value:function(){return this.attributes}},{key:"maxVertices",value:function(){return this.vertices.length/this.elementsPerVertex}},{key:"numVertices",value:function(){return this.verticesLength/this.elementsPerVertex}},{key:"setVerticesLength",value:function(t){this.dirtyVertices=!0,this.verticesLength=t}},{key:"getVertices",value:function(){return this.vertices}},{key:"maxIndices",value:function(){return this.indices.length}},{key:"numIndices",value:function(){return this.indicesLength}},{key:"setIndicesLength",value:function(t){this.dirtyIndices=!0,this.indicesLength=t}},{key:"getIndices",value:function(){return this.indices}},{key:"getVertexSizeInFloats",value:function(){for(var t=0,e=0;e<this.attributes.length;e++){t+=this.attributes[e].numElements}return t}},{key:"setVertices",value:function(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}},{key:"setIndices",value:function(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}},{key:"draw",value:function(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}},{key:"drawWithOffset",value:function(t,e,i,n){var r=this.context;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?r.drawElements(e,n,r.UNSIGNED_SHORT,2*i):r.drawArrays(e,i,n),this.unbind(t)}},{key:"bind",value:function(t){var e=this.context;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);for(var i=0,n=0;n<this.attributes.length;n++){var r=this.attributes[n],s=t.getAttributeLocation(r.name);e.enableVertexAttribArray(s),e.vertexAttribPointer(s,r.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*i),i+=r.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}},{key:"unbind",value:function(t){for(var e=this.context,i=0;i<this.attributes.length;i++){var n=this.attributes[i],r=t.getAttributeLocation(n.name);e.disableVertexAttribArray(r)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}},{key:"update",value:function(){var t=this.context;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}},{key:"restore",value:function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}},{key:"dispose",value:function(){var t=this.context;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}]),t}();e.Mesh=u,function(t){t[t.Float=0]="Float"}(o=e.VertexAttributeType||(e.VertexAttributeType={}));var h=a((function t(e,i,n){s(this,t),this.name=e,this.type=i,this.numElements=n}));e.VertexAttribute=h;var c=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,l.Shader.POSITION,o.Float,2)}return a(i)}(h);e.Position2Attribute=c;var f=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,l.Shader.POSITION,o.Float,3)}return a(i)}(h);e.Position3Attribute=f;var d=function(t){n(i,t);var e=r(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return s(this,i),e.call(this,l.Shader.TEXCOORDS+(0===t?"":t),o.Float,2)}return a(i)}(h);e.TexCoordAttribute=d;var v=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,l.Shader.COLOR,o.Float,4)}return a(i)}(h);e.ColorAttribute=v;var p=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,l.Shader.COLOR2,o.Float,4)}return a(i)}(h);e.Color2Attribute=p},2226:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.NumberUtil=void 0;var s=new Int8Array(4),a=new Int32Array(s.buffer,0,1),o=new Float32Array(s.buffer,0,1),l=function(){function t(){n(this,t)}return r(t,null,[{key:"intBitsToFloat",value:function(t){return a[0]=t,o[0]}},{key:"floatToIntBits",value:function(t){return o[0]=t,a[0]}},{key:"intToFloatColor",value:function(e){return t.intBitsToFloat(4278190079&e)}},{key:"colorToFloat",value:function(e,i,n,r){var s=e<<24|i<<16|n<<8|r;return t.intToFloatColor(s)}},{key:"isPowerOfTwo",value:function(t){return 0===(t&t-1)}},{key:"nextPowerOfTwo",value:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}}]),t}();e.NumberUtil=l},2991:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonBatch=void 0;var s=i(8637),a=i(4731),o=i(6403),l=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],u=new s.Color(1,1,1,1),h=function(){function t(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10920;if(n(this,t),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,this.projectionValues=new Float32Array(16),this.color=u,this.twoColorTint=!0,this.yDown=!1,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);this.context=e;var s=i?[new a.Position2Attribute,new a.ColorAttribute,new a.TexCoordAttribute,new a.Color2Attribute]:[new a.Position2Attribute,new a.ColorAttribute,new a.TexCoordAttribute];this.mesh=new a.Mesh(e,s,r,3*r),this.shader=o.Shader.newTwoColoredTextured(e);var l=this.context;this.srcColorBlend=l.SRC_ALPHA,this.srcAlphaBlend=l.ONE,this.dstBlend=l.ONE_MINUS_SRC_ALPHA,this.twoColorTint=i}return r(t,[{key:"setColor",value:function(t){this.color=t}},{key:"setShader",value:function(t){this.shader.dispose(),this.shader=t}},{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0;var t=this.shader;this.lastTexture=null,this.isDrawing=!0,t.bind(),t.setUniform4x4f(o.Shader.MVP_MATRIX,this.projectionValues),t.setUniformi("u_texture",0);var e=this.context;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,i){this.srcColorBlend===t&&this.srcAlphaBlend===e&&this.dstBlend===i||(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing&&(this.flush(),this.context.blendFuncSeparate(t,i,e,i)))}},{key:"drawVerticesWithOffset",value:function(e,i,n,r){for(var s=[],a=0;a<r;a++)s[a]=i[a+n];this.drawVertices(e,s,t.QUAD_TRIANGLES)}},{key:"drawVertices",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.QUAD_TRIANGLES;e!==this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+i.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var r=this.mesh.numVertices();this.mesh.getVertices().set(i,this.verticesLength),this.verticesLength+=i.length,this.mesh.setVerticesLength(this.verticesLength);for(var s=this.mesh.getIndices(),a=this.indicesLength,o=0;o<n.length;a++,o++)s[a]=n[o]+r;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)}},{key:"drawTransformed",value:function(e,i,n,r){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]&&arguments[8];if(this.yDown){var c=a;a=u,u=c}var f=s,d=a,v=o,p=u,g=v,m=d,y=f,M=p;h&&(this.yDown?(f=s,d=u,v=o,p=a,g=s,m=a,y=o,M=u):(f=o,d=a,v=s,p=u,g=o,m=u,y=s,M=a));var x=r.m02,b=r.m12,w=r.m01*n+r.m02,_=r.m11*n+r.m12,T=r.m00*i+r.m01*n+r.m02,A=r.m10*i+r.m11*n+r.m12,k=r.m00*i+r.m02,L=r.m10*i+r.m12,S=this.color,E=0;l[E++]=x,l[E++]=b,l[E++]=S.r,l[E++]=S.g,l[E++]=S.b,l[E++]=S.a,l[E++]=f,l[E++]=d,this.twoColorTint&&(l[E++]=0,l[E++]=0,l[E++]=0,l[E++]=0),l[E++]=w,l[E++]=_,l[E++]=S.r,l[E++]=S.g,l[E++]=S.b,l[E++]=S.a,l[E++]=y,l[E++]=M,this.twoColorTint&&(l[E++]=0,l[E++]=0,l[E++]=0,l[E++]=0),l[E++]=T,l[E++]=A,l[E++]=S.r,l[E++]=S.g,l[E++]=S.b,l[E++]=S.a,l[E++]=v,l[E++]=p,this.twoColorTint&&(l[E++]=0,l[E++]=0,l[E++]=0,l[E++]=0),l[E++]=k,l[E++]=L,l[E++]=S.r,l[E++]=S.g,l[E++]=S.b,l[E++]=S.a,l[E++]=g,l[E++]=m,this.twoColorTint&&(l[E++]=0,l[E++]=0,l[E++]=0,l[E]=0),this.drawVertices(e,l,t.QUAD_TRIANGLES)}},{key:"flush",value:function(){0!==this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader.unbind(),this.lastTexture=null,this.isDrawing=!1,t.totalDrawCalls+=this.drawCalls;var e=this.context;e.disable(e.BLEND)}},{key:"getDrawCalls",value:function(){return this.drawCalls}},{key:"dispose",value:function(){this.mesh.dispose()}},{key:"setYDown",value:function(t){this.yDown=t}},{key:"draw",value:function(e,i,n,r,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1,v=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,g=arguments.length>14&&void 0!==arguments[14]&&arguments[14],m=this.color;if(this.yDown){var y=d;d=p,p=y}i=i||0,n=n||0;var M=-a,x=(r=0===r?r:r||e.width)-a,b=r-a,w=-a,_=-o,T=-o,A=(s=0===s?s:s||e.height)-o,k=s-o;if(1!==h&&(M*=h,x*=h,b*=h,w*=h),1!==c&&(_*=c,T*=c,A*=c,k*=c),0!==u){var L=Math.cos(u),S=Math.sin(u),E=L*M-S*_,C=S*M+L*_,P=L*x-S*T,R=S*x+L*T,I=L*b-S*A,F=S*b+L*A,G=L*w-S*k,B=S*w+L*k;M=E,x=P,b=I,w=G,_=C,T=R,A=F,k=B}M+=i+a,x+=i+a,b+=i+a,w+=i+a,_+=n+o,T+=n+o,A+=n+o,k+=n+o;var O=f,U=d,D=v,V=p,N=D,z=U,j=O,W=V;g&&(this.yDown?(O=f,U=p,D=v,V=d,N=f,z=d,j=v,W=p):(O=v,U=d,D=f,V=p,N=v,z=p,j=f,W=d));var H=0;l[H++]=M,l[H++]=_,l[H++]=m.r,l[H++]=m.g,l[H++]=m.b,l[H++]=m.a,l[H++]=O,l[H++]=U,this.twoColorTint&&(l[H++]=0,l[H++]=0,l[H++]=0,l[H++]=0),l[H++]=x,l[H++]=T,l[H++]=m.r,l[H++]=m.g,l[H++]=m.b,l[H++]=m.a,l[H++]=N,l[H++]=z,this.twoColorTint&&(l[H++]=0,l[H++]=0,l[H++]=0,l[H++]=0),l[H++]=b,l[H++]=A,l[H++]=m.r,l[H++]=m.g,l[H++]=m.b,l[H++]=m.a,l[H++]=D,l[H++]=V,this.twoColorTint&&(l[H++]=0,l[H++]=0,l[H++]=0,l[H++]=0),l[H++]=w,l[H++]=k,l[H++]=m.r,l[H++]=m.g,l[H++]=m.b,l[H++]=m.a,l[H++]=j,l[H++]=W,this.twoColorTint&&(l[H++]=0,l[H++]=0,l[H++]=0,l[H]=0),this.drawVertices(e,l,t.QUAD_TRIANGLES)}}],[{key:"resetTotalDrawCalls",value:function(){t.totalDrawCalls=0}}]),t}();e.PolygonBatch=h,h.QUAD_TRIANGLES=[0,1,2,2,3,0],h.totalDrawCalls=0},4496:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Quaternion=void 0;var s=i(5474),a=i(8637),o=i(2668),l=i(176),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n(this,t),this.set(e,i,r,s)}return r(t,[{key:"set",value:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}},{key:"setFrom",value:function(t){return this.set(t.x,t.y,t.z,t.w)}},{key:"len",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"toString",value:function(){return"["+this.x+"|"+this.y+"|"+this.z+"|"+this.w+"]"}},{key:"setEulerAngles",value:function(t,e,i){return this.setEulerAnglesRad(t*a.MathUtils.degreesToRadians,e*a.MathUtils.degreesToRadians,i*a.MathUtils.degreesToRadians)}},{key:"setEulerAnglesRad",value:function(t,e,i){var n=.5*i,r=Math.sin(n),s=Math.cos(n),a=.5*e,o=Math.sin(a),l=Math.cos(a),u=.5*t,h=Math.sin(u),c=Math.cos(u),f=c*o,d=h*l,v=c*l,p=h*o;return this.x=f*s+d*r,this.y=d*s-f*r,this.z=v*r-p*s,this.w=v*s+p*r,this}},{key:"getGimbalPole",value:function(){var t=this.y*this.x+this.z*this.w;return t>.499?1:t<-.499?-1:0}},{key:"getRollRad",value:function(){var t=this.getGimbalPole();return 0===t?Math.atan2(2*(this.w*this.z+this.y*this.x),1-2*(this.x*this.x+this.z*this.z)):2*t*Math.atan2(this.y,this.w)}},{key:"getRoll",value:function(){return this.getRollRad()*a.MathUtils.radiansToDegrees}},{key:"getPitchRad",value:function(){var t=this.getGimbalPole();return 0===t?Math.asin(a.MathUtils.clamp(2*(this.w*this.x-this.z*this.y),-1,1)):t*a.MathUtils.PI*.5}},{key:"getPitch",value:function(){return this.getPitchRad()*a.MathUtils.radiansToDegrees}},{key:"getYawRad",value:function(){return 0===this.getGimbalPole()?Math.atan2(2*(this.y*this.w+this.x*this.z),1-2*(this.y*this.y+this.x*this.x)):0}},{key:"getYaw",value:function(){return this.getYawRad()*a.MathUtils.radiansToDegrees}},{key:"len2",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"nor",value:function(){var t=this.len2();return 0===t||a.MathUtils.isEqual(t,1)||(t=Math.sqrt(t),this.w/=t,this.x/=t,this.y/=t,this.z/=t),this}},{key:"conjugate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"transform",value:function(e){t.tmp2.set(this.x,this.y,this.z,this.w),t.tmp2.conjugate();var i=t.tmp1.set(e.x,e.y,e.z,0);return t.tmp2.mulLeft(i.x,i.y,i.z,i.w).mulLeft(this.x,this.y,this.z,this.w),e.x=t.tmp2.x,e.y=t.tmp2.y,e.z=t.tmp2.z,e}},{key:"mul",value:function(t,e,i,n){var r=this.w*t+this.x*n+this.y*i-this.z*e,s=this.w*e+this.y*n+this.z*t-this.x*i,a=this.w*i+this.z*n+this.x*e-this.y*t,o=this.w*n-this.x*t-this.y*e-this.z*i;return this.x=r,this.y=s,this.z=a,this.w=o,this}},{key:"mulLeft",value:function(t,e,i,n){var r=n*this.x+t*this.w+e*this.z-i*this.y,s=n*this.y+e*this.w+i*this.x-t*this.z,a=n*this.z+i*this.w+t*this.y-e*this.x,o=n*this.w-t*this.x-e*this.y-i*this.z;return this.x=r,this.y=s,this.z=a,this.w=o,this}},{key:"add",value:function(t,e,i,n){return this.x+=t,this.y+=e,this.z+=i,this.w+=n,this}},{key:"toMatrix",value:function(t){var e=this.x*this.x,i=this.x*this.y,n=this.x*this.z,r=this.x*this.w,a=this.y*this.y,o=this.y*this.z,l=this.y*this.w,u=this.z*this.z,h=this.z*this.w;t[s.Matrix4.M00]=1-2*(a+u),t[s.Matrix4.M01]=2*(i-h),t[s.Matrix4.M02]=2*(n+l),t[s.Matrix4.M03]=0,t[s.Matrix4.M10]=2*(i+h),t[s.Matrix4.M11]=1-2*(e+u),t[s.Matrix4.M12]=2*(o-r),t[s.Matrix4.M13]=0,t[s.Matrix4.M20]=2*(n-l),t[s.Matrix4.M21]=2*(o+r),t[s.Matrix4.M22]=1-2*(e+a),t[s.Matrix4.M23]=0,t[s.Matrix4.M30]=0,t[s.Matrix4.M31]=0,t[s.Matrix4.M32]=0,t[s.Matrix4.M33]=1}},{key:"idt",value:function(){return this.set(0,0,0,1)}},{key:"isIdentity",value:function(){return a.MathUtils.isZero(this.x)&&a.MathUtils.isZero(this.y)&&a.MathUtils.isZero(this.z)&&a.MathUtils.isEqual(this.w,1)}},{key:"setFromAxis",value:function(t,e,i,n){return this.setFromAxisRad(t,e,i,n*a.MathUtils.degreesToRadians)}},{key:"setFromAxisRad",value:function(t,e,i,n){var r=new o.Vector3(t,e,i).length();if(0===r)return this.idt();r=1/r;var s=n<0?a.MathUtils.PI2- -n%a.MathUtils.PI2:n%a.MathUtils.PI2,l=Math.sin(s/2),u=Math.cos(s/2);return this.set(r*t*l,r*e*l,r*i*l,u).nor()}},{key:"setFromMatrix4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.setFromAxes(t.values[s.Matrix4.M00],t.values[s.Matrix4.M01],t.values[s.Matrix4.M02],t.values[s.Matrix4.M10],t.values[s.Matrix4.M11],t.values[s.Matrix4.M12],t.values[s.Matrix4.M20],t.values[s.Matrix4.M21],t.values[s.Matrix4.M22],e)}},{key:"setFromMatrix3",value:function(t,e){return this.setFromAxes(t.val[l.Matrix3.M00],t.val[l.Matrix3.M01],t.val[l.Matrix3.M02],t.val[l.Matrix3.M10],t.val[l.Matrix3.M11],t.val[l.Matrix3.M12],t.val[l.Matrix3.M20],t.val[l.Matrix3.M21],t.val[l.Matrix3.M22],e)}},{key:"setFromAxes",value:function(t,e,i,n,r,s,a,l,u){var h=arguments.length>9&&void 0!==arguments[9]&&arguments[9];if(h){var c=1/new o.Vector3(t,e,i).length(),f=1/new o.Vector3(n,r,s).length(),d=1/new o.Vector3(a,l,u).length();t*=c,e*=c,i*=c,n*=f,r*=f,s*=f,a*=d,l*=d,u*=d}var v=t+r+u;if(v>=0){var p=Math.sqrt(v+1);this.w=.5*p,p=.5/p,this.x=(l-s)*p,this.y=(i-a)*p,this.z=(n-e)*p}else if(t>r&&t>u){var g=Math.sqrt(1+t-r-u);this.x=.5*g,g=.5/g,this.y=(n+e)*g,this.z=(i+a)*g,this.w=(l-s)*g}else if(r>u){var m=Math.sqrt(1+r-t-u);this.y=.5*m,m=.5/m,this.x=(n+e)*m,this.z=(l+s)*m,this.w=(i-a)*m}else{var y=Math.sqrt(1+u-t-r);this.z=.5*y,y=.5/y,this.x=(i+a)*y,this.y=(l+s)*y,this.w=(n-e)*y}return this}},{key:"setFromCross",value:function(t,e){var i=a.MathUtils.clamp(t.dot(e),-1,1),n=Math.acos(i);return this.setFromAxisRad(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x,n)}},{key:"slerp",value:function(t,e){var i=this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w,n=i<0?-i:i,r=1-e,s=e;if(1-n>.1){var a=Math.acos(n),o=1/Math.sin(a);r=Math.sin((1-e)*a)*o,s=Math.sin(e*a)*o}return i<0&&(s=-s),this.x=r*this.x+s*t.x,this.y=r*this.y+s*t.y,this.z=r*this.z+s*t.z,this.w=r*this.w+s*t.w,this}},{key:"slerpWithQuaternions",value:function(e){var i=1/e.length;this.set(e[0].x,e[0].y,e[0].z,e[0].w).exp(i);for(var n=1;n<e.length;n++){var r=t.tmp1.set(e[n].x,e[n].y,e[n].z,e[n].w).exp(i);this.mul(r.x,r.y,r.z,r.w)}return this.nor(),this}},{key:"exp",value:function(t){var e=this.len(),i=Math.pow(e,t),n=Math.acos(this.w/e),r=0;return r=Math.abs(n)<.001?i*t/e:i*Math.sin(t*n)/(e*Math.sin(n)),this.w=i*Math.cos(t*n),this.x*=r,this.y*=r,this.z*=r,this.nor(),this}},{key:"dot",value:function(t,e,i,n){return this.x*t+this.y*e+this.z*i+this.w*n}},{key:"mulByScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"getAxisAngle",value:function(t){return this.getAxisAngleRad(t.x,t.y,t.z)*a.MathUtils.radiansToDegrees}},{key:"getAxisAngleRad",value:function(t,e,i){this.w>1&&this.nor();var n=2*Math.acos(this.w),r=Math.sqrt(1-this.w*this.w);return r<a.MathUtils.FLOAT_ROUNDING_ERROR?(this.x,this.y,this.z):(this.x/r,this.y/r,this.z/r),n}},{key:"getAngleRad",value:function(){return 2*Math.acos(this.w>1?this.w/this.len():this.w)}},{key:"getAngle",value:function(){return this.getAngleRad()*a.MathUtils.radiansToDegrees}}],[{key:"len",value:function(t,e,i,n){return Math.sqrt(t*t+e*e+i*i+n*n)}},{key:"len2",value:function(t,e,i,n){return t*t+e*e+i*i+n*n}},{key:"dot",value:function(t,e,i,n,r,s,a,o){return t*r+e*s+i*a+n*o}}]),t}();e.Quaternion=u,u.tmp1=new u(0,0,0,0),u.tmp2=new u(0,0,0,0)},6403:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Shader=void 0;var s=function(){function t(e,i,r){n(this,t),this.vertexShader=i,this.fragmentShader=r,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=i,this.fsSource=r,this.context=e,this.compile()}return r(t,[{key:"getProgram",value:function(){return this.program}},{key:"getVertexShader",value:function(){return this.vertexShader}},{key:"getFragmentShader",value:function(){return this.fragmentShader}},{key:"getVertexShaderSource",value:function(){return this.vsSource}},{key:"getFragmentSource",value:function(){return this.fsSource}},{key:"compile",value:function(){var t=this.context;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}},{key:"compileShader",value:function(t,e){var i=this.context,n=i.createShader(t);if(i.shaderSource(n,e),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS)){var r="Couldn't compile shader: "+i.getShaderInfoLog(n);if(i.deleteShader(n),!i.isContextLost())throw new Error(r)}return n}},{key:"compileProgram",value:function(t,e){var i=this.context,n=i.createProgram();if(i.attachShader(n,t),i.attachShader(n,e),i.linkProgram(n),!i.getProgramParameter(n,i.LINK_STATUS)){var r="Couldn't compile shader program: "+i.getProgramInfoLog(n);if(i.deleteProgram(n),!i.isContextLost())throw new Error(r)}return n}},{key:"restore",value:function(){this.compile()}},{key:"bind",value:function(){this.context.useProgram(this.program)}},{key:"unbind",value:function(){this.context.useProgram(null)}},{key:"setUniformi",value:function(t,e){this.context.uniform1i(this.getUniformLocation(t),e)}},{key:"setUniformf",value:function(t,e){this.context.uniform1f(this.getUniformLocation(t),e)}},{key:"setUniform2f",value:function(t,e,i){this.context.uniform2f(this.getUniformLocation(t),e,i)}},{key:"setUniform3f",value:function(t,e,i,n){this.context.uniform3f(this.getUniformLocation(t),e,i,n)}},{key:"setUniform1fWithLocation",value:function(t,e){this.context.uniform1f(t,e)}},{key:"setUniform3fWithLocation",value:function(t,e,i,n){this.context.uniform3f(t,e,i,n)}},{key:"setUniform4f",value:function(t,e,i,n,r){this.context.uniform4f(this.getUniformLocation(t),e,i,n,r)}},{key:"setUniform2x2f",value:function(t,e){this.tmp2x2.set(e),this.context.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}},{key:"setUniform3x3f",value:function(t,e){this.tmp3x3.set(e),this.context.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}},{key:"setUniform4x4f",value:function(t,e){this.tmp4x4.set(e),this.context.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}},{key:"setUniform4x4fWithLocation",value:function(t,e){this.context.uniformMatrix4fv(t,!1,e)}},{key:"setUniform3fv",value:function(t,e){this.context.uniform3fv(this.getUniformLocation(t),e)}},{key:"getUniformLocation",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.context.getUniformLocation(this.program,t);if(e&&!i&&!this.context.isContextLost())throw new Error("Couldn't find location for uniform ".concat(t));return i}},{key:"getAttributeLocation",value:function(t){return this.context.getAttribLocation(this.program,t)}},{key:"dispose",value:function(){this.vs&&(this.context.deleteShader(this.vs),this.vs=null),this.fs&&(this.context.deleteShader(this.fs),this.fs=null),this.program&&(this.context.deleteProgram(this.program),this.program=null)}}],[{key:"newColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           gl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n         }\n       ")}},{key:"newTwoColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec4 ").concat(t.COLOR2,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_light;\n         varying vec4 v_dark;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_light = ").concat(t.COLOR,";\n           v_dark = ").concat(t.COLOR2,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_light;\n         varying LOWP vec4 v_dark;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           vec4 texColor = texture2D(u_texture, v_texCoords);\n           gl_FragColor.a = texColor.a * v_light.a;\n           gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n         }\n       ")}},{key:"newColored",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n \n         void main () {\n           gl_FragColor = v_color;\n         }\n       ")}}]),t}();e.Shader=s,s.MVP_MATRIX="u_projTrans",s.POSITION="a_position",s.COLOR="a_color",s.COLOR2="a_color2",s.TEXCOORDS="a_texCoords",s.SAMPLER="u_texture",s.NORMAL="a_normal",s.TANGENT="a_tangent",s.BINORMAL="a_binormal",s.BONEWEIGHT="a_boneWeight"},2438:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeRenderer=e.ShapeType=void 0;var s,a=i(4731),o=i(6403),l=i(8637),u=i(3192);!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Filled=4]="Filled"}(s=e.ShapeType||(e.ShapeType={}));var h=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10920;if(n(this,t),this.isDrawing=!1,this.shapeType=s.Filled,this.color=new l.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new u.Vector2,this.projectionValues=new Float32Array(16),i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=e,this.mesh=new a.Mesh(e,[new a.Position2Attribute,new a.ColorAttribute],i,0);var r=this.context;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA,this.shader=o.Shader.newColored(r)}return r(t,[{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.vertexIndex=0,this.isDrawing=!0,this.shader.bind(),this.shader.setUniform4x4f(o.Shader.MVP_MATRIX,this.projectionValues);var t=this.context;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,i){(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing)&&(this.flush(),this.context.blendFuncSeparate(t,i,e,i))}},{key:"setColor",value:function(t){this.color.setFromColor(t)}},{key:"setColorWith",value:function(t,e,i,n){this.color.set(t,e,i,n)}},{key:"point",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.check(s.Point,1),null===i&&(i=this.color),this.vertex(t,e,i)}},{key:"line",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.check(s.Line,2),null===r&&(r=this.color),this.vertex(t,e,r),this.vertex(i,n,r)}},{key:"triangle",value:function(t,e,i,n,r,a,o){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(t?s.Filled:s.Line,3),null===l&&(l=this.color),null===u&&(u=this.color),null===h&&(h=this.color),t?(this.vertex(e,i,l),this.vertex(n,r,u),this.vertex(a,o,h)):(this.vertex(e,i,l),this.vertex(n,r,u),this.vertex(n,r,l),this.vertex(a,o,u),this.vertex(a,o,l),this.vertex(e,i,u))}},{key:"quad",value:function(t,e,i,n,r,a,o,l,u){var h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null;this.check(t?s.Filled:s.Line,3),null===h&&(h=this.color),null===c&&(c=this.color),null===f&&(f=this.color),null===d&&(d=this.color),t?(this.vertex(e,i,h),this.vertex(n,r,c),this.vertex(a,o,f),this.vertex(a,o,f),this.vertex(l,u,d),this.vertex(e,i,h)):(this.vertex(e,i,h),this.vertex(n,r,c),this.vertex(n,r,c),this.vertex(a,o,f),this.vertex(a,o,f),this.vertex(l,u,d),this.vertex(l,u,d),this.vertex(e,i,h))}},{key:"rect",value:function(t,e,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.quad(t,e,i,e+n,i,e+n,i+r,e,i+r,s,s,s,s)}},{key:"rectLine",value:function(t,e,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.check(t?s.Filled:s.Line,8),null===o&&(o=this.color);var l=this.tmp.set(r-i,e-n);l.nor(),a*=.5;var u=l.x*a,h=l.y*a;t?(this.vertex(e+u,i+h,o),this.vertex(e-u,i-h,o),this.vertex(n+u,r+h,o),this.vertex(n-u,r-h,o),this.vertex(n+u,r+h,o),this.vertex(e-u,i-h,o)):(this.vertex(e+u,i+h,o),this.vertex(e-u,i-h,o),this.vertex(n+u,r+h,o),this.vertex(n-u,r-h,o),this.vertex(n+u,r+h,o),this.vertex(e+u,i+h,o),this.vertex(n-u,r-h,o),this.vertex(e-u,i-h,o))}},{key:"x",value:function(t,e,i){this.line(t-i,e-i,t+i,e+i),this.line(t-i,e+i,t+i,e-i)}},{key:"polygon",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(s.Line,2*i),null===n&&(n=this.color),i<<=1;for(var r=t[e<<=1],a=t[e+1],o=e+i,l=e,u=e+i-2;l<u;l+=2){var h=t[l],c=t[l+1],f=0,d=0;l+2>=o?(f=r,d=a):(f=t[l+2],d=t[l+3]),this.vertex(h,c,n),this.vertex(f,d,n)}}},{key:"circle",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(0===a&&(a=Math.max(1,6*l.MathUtils.cbrt(n)|0)),a<=0)throw new Error("segments must be > 0.");null===r&&(r=this.color);var o=2*l.MathUtils.PI/a,u=Math.cos(o),h=Math.sin(o),c=n,f=0;if(t){this.check(s.Filled,3*a+3),a--;for(var d=0;d<a;d++){this.vertex(e,i,r),this.vertex(e+c,i+f,r);var v=c;c=u*c-h*f,f=h*v+u*f,this.vertex(e+c,i+f,r)}this.vertex(e,i,r),this.vertex(e+c,i+f,r)}else{this.check(s.Line,2*a+2);for(var p=0;p<a;p++){this.vertex(e+c,i+f,r);var g=c;c=u*c-h*f,f=h*g+u*f,this.vertex(e+c,i+f,r)}this.vertex(e+c,i+f,r)}c=n,f=0,this.vertex(e+c,i+f,r)}},{key:"curve",value:function(t,e,i,n,r,a,o,l,u){var h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(s.Line,2*u+2),null===h&&(h=this.color);for(var c=1/u,f=c*c,d=c*c*c,v=3*c,p=3*f,g=6*f,m=6*d,y=t-2*i+r,M=e-2*n+a,x=3*(i-r)-t+o,b=3*(n-a)-e+l,w=t,_=e,T=(i-t)*v+y*p+x*d,A=(n-e)*v+M*p+b*d,k=y*g+x*m,L=M*g+b*m,S=x*m,E=b*m;u-- >0;)this.vertex(w,_,h),w+=T,_+=A,T+=k,A+=L,k+=S,L+=E,this.vertex(w,_,h);this.vertex(w,_,h),this.vertex(o,l,h)}},{key:"vertex",value:function(t,e,i){var n=this.vertexIndex,r=this.mesh.getVertices();r[n++]=t,r[n++]=e,r[n++]=i.r,r[n++]=i.g,r[n++]=i.b,r[n++]=i.a,this.vertexIndex=n}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();var t=this.context;t.disable(t.BLEND),this.isDrawing=!1}},{key:"flush",value:function(){0!==this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)}},{key:"check",value:function(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType===t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t}},{key:"dispose",value:function(){this.mesh.dispose()}}]),t}();e.ShapeRenderer=h},9805:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;var s=i(8637),a=i(3192),o=function(){function t(e){n(this,t),this.region=e,this.dirty=!1,this.position=new a.Vector2(0,0),this.size=new a.Vector2(0,0),this.origin=new a.Vector2(0,0),this.scale=new a.Vector2(1,1),this.color=new s.Color(1,1,1,1),this.rotation=0,this.vertices=new Float32Array(48),this.bounds={x:0,y:0,width:0,height:0},this.setSize(e.width,e.height),this.setOrigin(e.width/2,e.height/2)}return r(t,[{key:"set",value:function(t){this.region=t.region,this.position.setVector(t.position),this.size.setVector(t.size),this.origin.setVector(t.origin),this.rotation=t.rotation,this.scale.setVector(t.scale),this.color.setFromColor(t.color),this.dirty=!0}},{key:"setBounds",value:function(t,e,i,n){this.setPosition(t,e),this.setSize(t,e),this.dirty=!0}},{key:"setSize",value:function(t,e){this.size.set(t,e),this.dirty=!0}},{key:"setPosition",value:function(t,e){this.position.set(t,e),this.dirty=!0}},{key:"setOriginBasedPosition",value:function(t,e){this.setPosition(t-this.origin.x,e-this.origin.y)}},{key:"setX",value:function(t){this.position.x=t,this.dirty=!0}},{key:"setY",value:function(t){this.position.y=t,this.dirty=!0}},{key:"setCenterX",value:function(t){this.setX(t-this.size.x/2)}},{key:"setCenterY",value:function(t){this.setY(t-this.size.y/2)}},{key:"setCenter",value:function(t,e){this.setPosition(t-this.size.x/2,e-this.size.y/2)}},{key:"translateX",value:function(t){this.translate(t,0)}},{key:"translateY",value:function(t){this.translate(0,t)}},{key:"translate",value:function(t,e){this.position.add(t,e),this.dirty=!0}},{key:"setColor",value:function(t){this.color.setFromColor(t),this.dirty=!0}},{key:"setAlpha",value:function(t){this.color.a=t,this.dirty=!0}},{key:"setOrigin",value:function(t,e){this.origin.set(t,e),this.dirty=!0}},{key:"setOriginCenter",value:function(){this.origin.set(this.size.x/2,this.size.y/2),this.dirty=!0}},{key:"setRotation",value:function(t){this.rotation=t,this.dirty=!0}},{key:"getRotation",value:function(){return this.rotation}},{key:"rotate",value:function(t){0!==t&&(this.rotation+=t,this.dirty=!0)}},{key:"setScale",value:function(t,e){this.scale.set(t,e),this.dirty=!0}},{key:"applyScale",value:function(t){this.scale.scale(t),this.dirty=!0}},{key:"getVertices",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.vertices,i=this.region;if(!this.dirty)return e;var n=this.position.x,r=this.position.y,s=this.size.x,a=this.size.y,o=this.origin.x,l=this.origin.y,u=this.rotation,h=this.scale.x,c=this.scale.y,f=i.u,d=i.v,v=i.u2,p=i.v2,g=this.color,m=i.rotated,y=s/i.originalWidth,M=a/i.originalHeight,x=i.width*y,b=i.height*M,w=n+i.offsetX*y;if(n=w,r=t?r+a-i.offsetY*M-b:r+i.offsetY*M,t){var _=d;d=p,p=_}var T=-o,A=(s=x)-o,k=s-o,L=-o,S=-l,E=-l,C=(a=b)-l,P=a-l;if(1!==h&&(T*=h,A*=h,k*=h,L*=h),1!==c&&(S*=c,E*=c,C*=c,P*=c),0!==u){var R=Math.cos(u),I=Math.sin(u),F=R*T-I*S,G=I*T+R*S,B=R*A-I*E,O=I*A+R*E,U=R*k-I*C,D=I*k+R*C,V=R*L-I*P,N=I*L+R*P;T=F,A=B,k=U,L=V,S=G,E=O,C=D,P=N}T+=n+o,A+=n+o,k+=n+o,L+=n+o,S+=r+l,E+=r+l,C+=r+l,P+=r+l;var z=f,j=d,W=v,H=p,X=W,Y=j,q=z,K=H;m&&(t?(z=f,j=p,W=v,H=d,X=f,Y=d,q=v,K=p):(z=v,j=d,W=f,H=p,X=v,Y=p,q=f,K=d));var Z=0;return e[Z++]=T,e[Z++]=S,e[Z++]=g.r,e[Z++]=g.g,e[Z++]=g.b,e[Z++]=g.a,e[Z++]=z,e[Z++]=j,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=A,e[Z++]=E,e[Z++]=g.r,e[Z++]=g.g,e[Z++]=g.b,e[Z++]=g.a,e[Z++]=X,e[Z++]=Y,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=k,e[Z++]=C,e[Z++]=g.r,e[Z++]=g.g,e[Z++]=g.b,e[Z++]=g.a,e[Z++]=W,e[Z++]=H,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=L,e[Z++]=P,e[Z++]=g.r,e[Z++]=g.g,e[Z++]=g.b,e[Z++]=g.a,e[Z++]=q,e[Z++]=K,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z]=0,e}},{key:"getBoundingRectangle",value:function(){var t=this.vertices,e=t[0],i=t[1],n=t[0],r=t[1];return e=(e=(e=e>t[12]?t[12]:e)>t[24]?t[24]:e)>t[36]?t[36]:e,n=(n=(n=n<t[12]?t[12]:n)<t[24]?t[24]:n)<t[36]?t[36]:n,i=(i=(i=i>t[13]?t[13]:i)>t[25]?t[25]:i)>t[37]?t[37]:i,r=(r=(r=r<t[13]?t[13]:r)<t[25]?t[25]:r)<t[37]?t[37]:r,this.bounds.x=e,this.bounds.y=i,this.bounds.width=n-e,this.bounds.height=r-i,this.bounds}},{key:"draw",value:function(t){t.drawVertices(this.region.texture,this.getVertices(t.yDown))}},{key:"drawWithAlpha",value:function(t,e){var i=this.getColor().a;this.setAlpha(i*e),this.draw(t),this.setAlpha(i)}},{key:"getX",value:function(){return this.position.x}},{key:"getY",value:function(){return this.position.y}},{key:"getWidth",value:function(){return this.size.x}},{key:"getHeight",value:function(){return this.size.y}},{key:"getOriginX",value:function(){return this.origin.x}},{key:"getOriginY",value:function(){return this.origin.y}},{key:"getScaleX",value:function(){return this.scale.x}},{key:"getScaleY",value:function(){return this.scale.y}},{key:"getColor",value:function(){return this.color}}]),t}();e.Sprite=o},3432:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Texture=e.TextureWrap=e.TextureFilter=void 0,function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(n=e.TextureFilter||(e.TextureFilter={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(e.TextureWrap||(e.TextureWrap={}));var a=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,t),this.texture=null,this.boundUnit=0,this.useMipMaps=!1,this.width=0,this.height=0,this._image=i,this.context=e,this.useMipMaps=n,this.restore(),this.width=i.width,this.height=i.height}return s(t,[{key:"getImage",value:function(){return this._image}},{key:"getWebGLTexture",value:function(){return this.texture}},{key:"setFilters",value:function(e,i){var n=this.context;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t.validateMagFilter(i))}},{key:"setWraps",value:function(t,e){var i=this.context;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e)}},{key:"update",value:function(e){var i=this.context;this.texture||(this.texture=this.context.createTexture()),this.bind(),t.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._image),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),e&&i.generateMipmap(i.TEXTURE_2D)}},{key:"restore",value:function(){this.texture=null,this.update(this.useMipMaps)}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.context;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}},{key:"unbind",value:function(){var t=this.context;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}},{key:"dispose",value:function(){this.context.deleteTexture(this.texture)}}],[{key:"createWhiteTexture",value:function(e){return new t(e,new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1))}},{key:"load",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){var s=new Image;s.onload=function(){r(new t(e,s,n))},s.src=i}))}},{key:"validateMagFilter",value:function(t){switch(t){case n.MipMap:case n.MipMapLinearLinear:case n.MipMapLinearNearest:case n.MipMapNearestLinear:case n.MipMapNearestNearest:return n.Linear;default:return t}}}]),t}();e.Texture=a,a.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1},8143:function(t,e,i){"use strict";var n=i(7061).default,r=i(7424).default,s=i(4704).default,a=i(6690).default,o=i(9728).default,l=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function o(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TextureAtlas=void 0;var u=i(3432),h=i(8026),c=i(8637),f=function(){function t(e,i){a(this,t),this.pages=e,this.regions=i}return o(t,[{key:"dispose",value:function(){var t,e=s(this.pages);try{for(e.s();!(t=e.n()).done;){t.value.dispose()}}catch(i){e.e(i)}finally{e.f()}}},{key:"getPages",value:function(){return this.pages}},{key:"getRegions",value:function(){return this.regions}},{key:"findRegion",value:function(t,e){for(var i=0;i<this.regions.length;i++){var n=this.regions[i];if(n.name===t&&(void 0===e||n.index===e))return n}return null}},{key:"findRegions",value:function(t){return this.regions.filter((function(e){return e.name===t})).sort((function(t,e){return t.index-e.index}))}}],[{key:"load",value:function(e,i,s){return l(this,void 0,void 0,n().mark((function a(){var o,l,f,d,v,p,g,m,y,M,x,b,w,_,T,A,k,L,S,E,C,P,R,I,F,G,B,O,U,D,V,N,z,j,W,H,X,Y,q,K,Z;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(i).then((function(t){return t.text()}));case 2:o=n.sent,l=[],f=[],d=[],p=o.split(/\r?\n/),g=0;case 8:if(void 0!==(y=p[g])){n.next=12;break}return n.abrupt("break",16);case 12:0===y.trim().length?v=null:v?(E=y,g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),C="true"===m[0],g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),P=parseInt(m[0],10),R=parseInt(m[1],10),g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),I=parseInt(m[0],10),F=parseInt(m[1],10),G={name:E,rotate:C,left:P,top:R,width:I,height:F,page:v},g++,y=p[g],4===(m=y.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(G.splits=m.map((function(t){return parseInt(t,10)})),g++,y=p[g],4===(m=y.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(G.pads=m.map((function(t){return parseInt(t,10)})),g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})))),G.originalWidth=parseInt(m[0],10),G.originalHeight=parseInt(m[1],10),g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),G.offsetX=parseInt(m[0],10),G.offsetY=parseInt(m[1],10),g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),G.index=parseInt(m[0],10),d.push(G)):(M=(0,c.concatAndResolveUrl)(i,"../".concat(y)),g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),x=parseInt(m[0],10),b=parseInt(m[1],10),g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),w=m[0],g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),_=r(m,2),T=_[0],A=_[1],g++,y=p[g],m=y.split(":")[1].split(",").map((function(t){return t.trim()})),k=m[0],L=u.TextureWrap.ClampToEdge,S=u.TextureWrap.ClampToEdge,"x"===k?L=u.TextureWrap.Repeat:"y"===k?S=u.TextureWrap.Repeat:"xy"===k&&(L=u.TextureWrap.Repeat,S=u.TextureWrap.Repeat),v={file:M,width:x,height:b,format:w,mipMaps:"Nearest"!==T&&"Linear"!==T,min:T,max:A,direction:k,repeatX:L,repeatY:S},l.push(v)),g++,n.next=8;break;case 16:B=0,O=l;case 17:if(!(B<O.length)){n.next=27;break}return U=O[B],n.next=21,u.Texture.load(e,U.file,s);case 21:U.texture=n.sent,U.invTexWidth=1/U.texture.width,U.invTexHeight=1/U.texture.height;case 24:B++,n.next=17;break;case 27:for(D=[],V=0,N=d;V<N.length;V++)z=N[V],j=z.left,W=z.top,H=z.rotate?z.height:z.width,X=z.rotate?z.width:z.height,Y=z.page,q=Y.texture,K=Y.invTexWidth,Z=Y.invTexHeight,D.push(new h.TextureRegion(q,j,W,H,X,z,K,Z,z.rotate));return n.abrupt("return",new t(f,D));case 30:case"end":return n.stop()}}),a)})))}}]),t}();e.TextureAtlas=f},8026:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRegion=void 0;var s=i(9416),a=function(){function t(e,i,r,a,o,l,u,h){var c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];n(this,t),this.name=null,this.index=0,this.texture=null,this.regionX=0,this.regionY=0,this.width=0,this.height=0,this.invTexWidth=0,this.invTexHeight=0,this.originalWidth=0,this.originalHeight=0,this.offsetX=0,this.offsetY=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.rotated=!1,this.tmpTransform=new s.Affine2,u&&h||(u=1/e.width,h=1/e.height);var f=i*u,d=(r+o)*h,v=(i+a)*u,p=r*h;for(var g in this.texture=e,this.regionX=i,this.regionY=r,this.width=a,this.height=o,this.originalWidth=a,this.originalHeight=o,this.offsetX=0,this.offsetY=0,this.u=f,this.v=d,this.u2=v,this.v2=p,this.rotated=c,l)this[g]=l[g]}return r(t,[{key:"draw",value:function(t,e,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,h=this.originalWidth,c=this.originalHeight,f=this.offsetX,d=this.offsetY,v=this.width,p=this.height,g=n/h,m=r/c,y=v*g,M=p*m,x=e+f*g,b=0;s-=x-e,a-=(b=t.yDown?i+r-d*m-M:i+d*m)-i,t.draw(this.texture,x,b,y,M,s,a,o,l,u,this.u,this.v,this.u2,this.v2,this.rotated)}},{key:"drawTransformed",value:function(t,e,i,n){var r=this.originalWidth,s=this.originalHeight,a=this.offsetX,o=this.offsetY,l=e/r,u=i/s,h=this.width*l,c=this.height*u,f=a*l,d=0;d=t.yDown?i-o*u-c:o*u,this.tmpTransform.set(n),this.tmpTransform.translate(f,d),t.drawTransformed(this.texture,h,c,this.tmpTransform,this.u,this.v,this.u2,this.v2,this.rotated)}}],[{key:"splitTexture",value:function(e,i,n){for(var r=e.width/i,s=e.height/n,a=[],o=0;o<n;o++)for(var l=0;l<i;l++)a.push(new t(e,l*r,o*s,r,s,{}));return a}}]),t}();e.TextureRegion=a},8637:function(t,e,i){"use strict";var n,r=i(1588).default,s=i(3808).default,a=i(1655).default,o=i(6389).default,l=i(6690).default,u=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.concatAndResolveUrl=e.ArrayMap=e.copyArray=e.createStage=e.pointInRect=e.resizeCanvas=e.createGameLoop=e.WindowedMean=e.TimeKeeper=e.Pools=e.FlushablePool=e.Pool=e.Utils=e.PowOut=e.Pow=e.Interpolation=e.MathUtils=e.Color=e.StringSet=e.IntSet=e.Align=void 0;var h=function(){function t(){l(this,t)}return u(t,null,[{key:"isLeft",value:function(t){return 0!==(t&this.left)}},{key:"isRight",value:function(t){return 0!==(t&this.right)}},{key:"isTop",value:function(t){return 0!==(t&this.top)}},{key:"isBottom",value:function(t){return 0!==(t&this.bottom)}},{key:"isCenterVertical",value:function(t){return 0===(t&this.top)&&0===(t&this.bottom)}},{key:"isCenterHorizontal",value:function(t){return 0===(t&this.left)&&0===(t&this.right)}}]),t}();e.Align=h,n=h,h.center=1,h.top=2,h.bottom=4,h.left=8,h.right=16,h.topLeft=n.top|n.left,h.topRight=n.top|n.right,h.bottomLeft=n.bottom|n.left,h.bottomRight=n.bottom|n.right;var c=function(){function t(){l(this,t),this.array=new Array}return u(t,[{key:"add",value:function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e}},{key:"contains",value:function(t){return void 0!==this.array[0|t]}},{key:"remove",value:function(t){this.array[0|t]=void 0}},{key:"clear",value:function(){this.array.length=0}}]),t}();e.IntSet=c;var f=function(){function t(){l(this,t),this.entries={},this.size=0}return u(t,[{key:"add",value:function(t){var e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}},{key:"addAll",value:function(t){for(var e=this.size,i=0,n=t.length;i<n;i++)this.add(t[i]);return e!==this.size}},{key:"contains",value:function(t){return this.entries[t]}},{key:"clear",value:function(){this.entries={},this.size=0}}]),t}();e.StringSet=f;var d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;l(this,t),this.r=e,this.g=i,this.b=n,this.a=r}return u(t,[{key:"unsafeSet",value:function(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n}},{key:"set",value:function(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this.clamp()}},{key:"setFromColor",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"setFromString",value:function(t){return t="#"===t.charAt(0)?t.substring(1):t,this.r=parseInt(t.substring(0,2),16)/255,this.g=parseInt(t.substring(2,4),16)/255,this.b=parseInt(t.substring(4,6),16)/255,this.a=8!==t.length?1:parseInt(t.substring(6,8),16)/255,this}},{key:"add",value:function(t,e,i,n){return this.r+=t,this.g+=e,this.b+=i,this.a+=n,this.clamp()}},{key:"clamp",value:function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}},{key:"lerp",value:function(t,e){return this.r+=e*(t.r-this.r),this.g+=e*(t.g-this.g),this.b+=e*(t.b-this.b),this.a+=e*(t.a-this.a),this.clamp()}},{key:"mul",value:function(t,e,i,n){return this.r*=t,this.g*=e,this.b*=i,this.a*=n,this.clamp()}},{key:"toIntBits",value:function(){return 255*this.a<<24|255*this.b<<16|255*this.g<<8|255*this.r}},{key:"equals",value:function(t){return this===t||this.toIntBits()===t.toIntBits()}}],[{key:"rgba8888ToColor",value:function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}},{key:"rgb888ToColor",value:function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}},{key:"fromString",value:function(e){return(new t).setFromString(e)}}]),t}();e.Color=d,d.WHITE=new d(1,1,1,1),d.RED=new d(1,0,0,1),d.GREEN=new d(0,1,0,1),d.BLUE=new d(0,0,1,1),d.MAGENTA=new d(1,0,1,1);var v=function(){function t(){l(this,t)}return u(t,null,[{key:"clamp",value:function(t,e,i){return t<e?e:t>i?i:t}},{key:"cosDeg",value:function(e){return Math.cos(e*t.degRad)}},{key:"sinDeg",value:function(e){return Math.sin(e*t.degRad)}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}},{key:"toInt",value:function(t){return t>0?Math.floor(t):Math.ceil(t)}},{key:"cbrt",value:function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}},{key:"randomTriangular",value:function(e,i){return t.randomTriangularWith(e,i,.5*(e+i))}},{key:"randomTriangularWith",value:function(t,e,i){var n=Math.random(),r=e-t;return n<=(i-t)/r?t+Math.sqrt(n*r*(i-t)):e-Math.sqrt((1-n)*r*(e-i))}},{key:"isPowerOfTwo",value:function(t){return t&&0===(t&t-1)}},{key:"isEqual",value:function(e,i){return Math.abs(e-i)<=t.FLOAT_ROUNDING_ERROR}},{key:"isZero",value:function(e){return Math.abs(e)<=t.FLOAT_ROUNDING_ERROR}}]),t}();e.MathUtils=v,v.FLOAT_ROUNDING_ERROR=1e-6,v.PI=3.1415927,v.PI2=2*v.PI,v.radiansToDegrees=180/v.PI,v.radDeg=v.radiansToDegrees,v.degreesToRadians=v.PI/180,v.degRad=v.degreesToRadians;var p=function(){function t(){l(this,t)}return u(t,[{key:"apply",value:function(t,e,i){return t+(e-t)*this.applyInternal(i)}}]),t}();e.Interpolation=p;var g=function(t){a(i,t);var e=o(i);function i(t){var n;return l(this,i),(n=e.call(this)).power=2,n.power=t,n}return u(i,[{key:"applyInternal",value:function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2===0?-2:2)+1}}]),i}(p);e.Pow=g;var m=function(t){a(i,t);var e=o(i);function i(){return l(this,i),e.apply(this,arguments)}return u(i,[{key:"applyInternal",value:function(t){return Math.pow(t-1,this.power)*(this.power%2===0?-1:1)+1}}]),i}(g);e.PowOut=m;var y=function(){function t(){l(this,t)}return u(t,null,[{key:"arrayCopy",value:function(t,e,i,n,r){for(var s=e,a=n;s<e+r;s++,a++)i[a]=t[s]}},{key:"arrayFill",value:function(t,e,i,n){for(var r=e;r<i;r++)t[r]=n}},{key:"setArraySize",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.length;if(n===e)return t;if(t.length=e,n<e)for(var r=n;r<e;r++)t[r]=i;return t}},{key:"ensureArrayCapacity",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.length>=i?e:t.setArraySize(e,i,n)}},{key:"newArray",value:function(t,e){for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i}},{key:"newFloatArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i}},{key:"newShortArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i}},{key:"toFloatArray",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}},{key:"toSinglePrecision",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}},{key:"contains",value:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}},{key:"enumValue",value:function(t,e){return t[e[0].toUpperCase()+e.slice(1)]}},{key:"getHashCodeOfString",value:function(t){var e,i=0;if(0===this.length)return i;for(e=0;e<this.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return i}}]),t}();e.Utils=y,y.SUPPORTS_TYPED_ARRAYS="undefined"!==typeof Float32Array;var M=function(){function t(e){l(this,t),this.items=new Array,this.instantiator=e||function(){return{}}}return u(t,[{key:"obtain",value:function(){return this.items.length>0?this.items.pop():this.instantiator()}},{key:"free",value:function(t){(null===t||void 0===t?void 0:t.reset)&&t.reset(),this.items.push(t)}},{key:"freeAll",value:function(t){for(var e=0;e<t.length;e++)this.free(t[e])}},{key:"clear",value:function(){this.items.length=0}}]),t}();e.Pool=M;var x=function(t){a(i,t);var e=o(i);function i(t){var n;return l(this,i),(n=e.call(this,t)).obtained=new Array,n}return u(i,[{key:"obtain",value:function(){var t=r(s(i.prototype),"obtain",this).call(this);return this.obtained.push(t),t}},{key:"flush",value:function(){r(s(i.prototype),"freeAll",this).call(this,this.obtained),this.obtained.length=0}},{key:"free",value:function(t){var e=this.obtained.indexOf(t);e>-1&&this.obtained.splice(e,1),r(s(i.prototype),"free",this).call(this,t)}},{key:"freeAll",value:function(t){for(var e=0;e<t.length;e++){var n=this.obtained.indexOf(t[e]);n>=0&&this.obtained.splice(n,1)}r(s(i.prototype),"freeAll",this).call(this,t)}}]),i}(M);e.FlushablePool=x;var b=function(){function t(){l(this,t)}return u(t,null,[{key:"free",value:function(t,e){this.pools[t]&&this.pools[t].free(e)}},{key:"freeAll",value:function(t,e){this.pools[t]&&this.pools[t].freeAll(e)}},{key:"get",value:function(t,e){return this.pools[t]||(this.pools[t]=new M(e)),this.pools[t]}},{key:"set",value:function(t,e){this.pools[t]=e}},{key:"obtain",value:function(t,e){return this.get(t,e).obtain()}}]),t}();e.Pools=b,b.pools={};var w=function(){function t(){l(this,t),this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return u(t,[{key:"update",value:function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}]),t}();e.TimeKeeper=w;var _=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;l(this,t),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(e)}return u(t,[{key:"hasEnoughData",value:function(){return this.addedValues>=this.values.length}},{key:"addValue",value:function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0}},{key:"getMean",value:function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0}}]),t}();e.WindowedMean=_;e.createGameLoop=function(t){var e,i=Date.now(),n=0,r=!0,s=0,a=0;function o(){if(r){var l=Date.now()-i;i=Date.now(),s++,(a+=l)>=1e3&&(n=s,s=0,a-=1e3),e=requestAnimationFrame(o),t(l/1e3)}}return o(),{isRunning:function(){return r},start:function(){r||(r=!0,o())},stop:function(){e&&cancelAnimationFrame(e),r=!1},getFps:function(){return n}}};e.resizeCanvas=function(t,e){var i=e||window.devicePixelRatio||1,n=t.clientWidth*i,r=t.clientHeight*i;return t.width===n&&t.height===r||(t.width=n,t.height=r),[n,r]};e.pointInRect=function(t,e,i,n,r,s){return t>i&&t<i+r&&e>n&&e<n+s};e.createStage=function(t){t=Object.assign(Object.assign({},{hidden:!1,info:!0}),t);var e=document.createElement("div");e.setAttribute("style","position:fixed;top:0;left:0;right:0;bottom:0;"),t.wrapperClassName&&(e.className=t.wrapperClassName),t.hidden&&(e.style.display="none");var i=document.createElement("canvas");i.setAttribute("style","width:100%;height:100%;");var n=document.createElement("div");return n.setAttribute("style","position:absolute;top:1em;left:1em;color:white"),t.info||(n.style.display="none"),e.appendChild(i),e.appendChild(n),document.body.appendChild(e),{getCanvas:function(){return i},getInfo:function(){return n},show:function(){return e.style.display="block"},hide:function(){return e.style.display="none"},cleanup:function(){return document.body.removeChild(e)}}};e.copyArray=function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,s=0;s<r;s++)e[i+s]=t[n+s]};var T=function(){function t(){l(this,t),this.keys=[],this.values=[],this.size=0}return u(t,[{key:"set",value:function(t,e){var i=this.indexOfKey(t);return-1===i&&(i=this.size++),this.keys[i]=t,this.values[i]=e,i}},{key:"get",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.size-1;i>=0;i--)if(this.keys[i]===t)return this.values[i];return e}},{key:"indexOfKey",value:function(t){for(var e=0,i=this.size;e<i;e++)if(this.keys[e]===t)return e;return-1}},{key:"removeKey",value:function(t){for(var e=0,i=this.size;e<i;e++)this.keys[e]===t&&this.removeIndex(e)}},{key:"removeIndex",value:function(t){if(t>=this.size)throw new Error("index out of bound");this.size--,this.keys.splice(t,1),this.values.splice(t,1)}},{key:"clear",value:function(){this.keys.length=0,this.values.length=0,this.size=0}}]),t}();e.ArrayMap=T,e.concatAndResolveUrl=function(t,e){for(var i=t.split("/"),n=e.split("/"),r=[],s=0,a=i.length;s<a;s++)if(".."===i[s])r.pop();else{if("."===i[s])continue;r.push(i[s])}for(var o=0,l=n.length;o<l;o++)if(".."===n[o])r.pop();else{if("."===n[o])continue;r.push(n[o])}return r.join("/")}},3192:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,t),this.x=0,this.y=0,this.x=e,this.y=i}return r(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setVector",value:function(t){return this.set(t.x,t.y)}},{key:"add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"addVector",value:function(t){return this.add(t.x,t.y)}},{key:"sub",value:function(t,e){return this.add(-t,-e)}},{key:"subVector",value:function(t){return this.sub(t.x,t.y)}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"distanceSqr",value:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSqr(t))}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"len2",value:function(){return this.x*this.x+this.y*this.y}},{key:"len",value:function(){return Math.sqrt(this.len2())}},{key:"nor",value:function(){var t=this.len();return 0!==t&&(this.x/=t,this.y/=t),this}},{key:"rotateRad",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.x*e-this.y*i,r=this.x*i+this.y*e;return this.x=n,this.y=r,this}},{key:"rotate",value:function(t){return this.rotateRad(t*Math.PI/180)}},{key:"cpy",value:function(){return new t(this.x,this.y)}},{key:"mul",value:function(t){var e=this.x*t.val[0]+this.y*t.val[3]+t.val[6],i=this.x*t.val[1]+this.y*t.val[4]+t.val[7];return this.x=e,this.y=i,this}},{key:"lerp",value:function(t,e){var i=1-e;return this.x=this.x*i+t.x*e,this.y=this.y*i+t.y*e,this}}]),t}();e.Vector2=s},2668:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector3=void 0;var s=i(176),a=i(5474),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n(this,t),this.x=0,this.y=0,this.z=0,this.x=e,this.y=i,this.z=r}return r(t,[{key:"isZero",value:function(){return 0===this.x&&0===this.y&&0===this.z}},{key:"dst2",value:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return e*e+i*i+n*n}},{key:"setFrom",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"set",value:function(t,e,i){return this.x=t,this.y=e,this.z=i,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"normalize",value:function(){var t=this.length();return 0===t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}},{key:"cross",value:function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}},{key:"multiply",value:function(t){var e=t.values;return this.set(this.x*e[a.Matrix4.M00]+this.y*e[a.Matrix4.M01]+this.z*e[a.Matrix4.M02]+e[a.Matrix4.M03],this.x*e[a.Matrix4.M10]+this.y*e[a.Matrix4.M11]+this.z*e[a.Matrix4.M12]+e[a.Matrix4.M13],this.x*e[a.Matrix4.M20]+this.y*e[a.Matrix4.M21]+this.z*e[a.Matrix4.M22]+e[a.Matrix4.M23])}},{key:"multiplyMat3",value:function(t){var e=t.val;return this.set(this.x*e[s.Matrix3.M00]+this.y*e[s.Matrix3.M01]+this.z*e[s.Matrix3.M02],this.x*e[s.Matrix3.M10]+this.y*e[s.Matrix3.M11]+this.z*e[s.Matrix3.M12],this.x*e[s.Matrix3.M20]+this.y*e[s.Matrix3.M21]+this.z*e[s.Matrix3.M22])}},{key:"project",value:function(t){var e=t.values,i=1/(this.x*e[a.Matrix4.M30]+this.y*e[a.Matrix4.M31]+this.z*e[a.Matrix4.M32]+e[a.Matrix4.M33]);return this.set((this.x*e[a.Matrix4.M00]+this.y*e[a.Matrix4.M01]+this.z*e[a.Matrix4.M02]+e[a.Matrix4.M03])*i,(this.x*e[a.Matrix4.M10]+this.y*e[a.Matrix4.M11]+this.z*e[a.Matrix4.M12]+e[a.Matrix4.M13])*i,(this.x*e[a.Matrix4.M20]+this.y*e[a.Matrix4.M21]+this.z*e[a.Matrix4.M22]+e[a.Matrix4.M23])*i)}},{key:"unproject",value:function(t,e,i,n,r,s){var a=this.x,o=this.y,l=this.z;return a-=i,o=s-o-1,o-=n,t.set(2*a/r-1,2*o/s-1,2*l-1),t.project(e),t}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"dotWithValue",value:function(t,e,i){return this.x*t+this.y*e+this.z*i}},{key:"rotate",value:function(e,i){return t.tmpMat.setToRotation(e,i),this.multiply(t.tmpMat)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"length2",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"distance",value:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)}},{key:"lerp",value:function(t,e){return this.x+=e*(t.x-this.x),this.y+=e*(t.y-this.y),this.z+=e*(t.z-this.z),this}},{key:"equals",value:function(t){return this===t||this.x===t.x&&this.y===t.y&&this.z===t.z}}]),t}();e.Vector3=o,o.X=new o(1,0,0),o.Y=new o(0,1,0),o.Z=new o(0,0,1),o.Zero=new o(0,0,0),o.tmpMat=new a.Matrix4},7885:function(t,e,i){"use strict";var n=i(4704).default,r=i(7424).default;Object.defineProperty(e,"__esModule",{value:!0}),e.createViewport=void 0;var s=i(814),a=i(8637);e.createViewport=function(t,e,i,o){var l,u={autoUpdate:!0,pixelRatio:void 0,crop:!0};(o=Object.assign(Object.assign({},u),o)).disablePremultipliedAlpha&&(l={premultipliedAlpha:!1}),l=Object.assign(Object.assign({},l),o.contextOption);var h=t.getContext("webgl2",l);h||(h=t.getContext("webgl",l));var c,f=[],d=o,v=d.autoUpdate,p=d.pixelRatio,g=d.crop,m={pixelRatio:p=p||window.devicePixelRatio||1,x:0,y:0,width:e,height:i,worldWidth:e,worldHeight:i},y=(0,a.resizeCanvas)(t,p),M=r(y,2),x=M[0],b=M[1],w=new s.OrthoCamera(e,i,x,b);v&&(c=function(t){_.update()},window.addEventListener("resize",c));var _={getViewportInfo:function(){return m},getCamera:function(){return w},addCamera:function(t){f.push(t)},getContext:function(){return h},getCanvas:function(){return t},update:function(){var s=(0,a.resizeCanvas)(t,p),o=r(s,2),l=o[0],u=o[1],c=e/i,d=l/u;if(g){var v,y;c<d?(y=u,v=u*c):(v=l,y=l/c);var M=(l-v)/2,x=(u-y)/2;m.x=M,m.y=x,m.width=v,m.height=y,h.viewport(M,x,v,y),w.setPosition(e/2,i/2),w.resize(e,i,v,y);var b,_=n(f);try{for(_.s();!(b=_.n()).done;){var T=b.value;T.setPosition(e/2,i/2),T.resize(e,i,v,y)}}catch(R){_.e(R)}finally{_.f()}}else{var A,k,L,S;m.x=0,m.y=0,m.width=l,m.height=u,h.viewport(0,0,l,u),c<d?(L=-((A=(k=i)*d)-e)/2,S=0):(L=0,S=-((k=(A=e)/d)-i)/2),w.setPosition(L+A/2,S+k/2),w.resize(A,k,l,u);var E,C=n(f);try{for(C.s();!(E=C.n()).done;){var P=E.value;P.setPosition(L+A/2,S+k/2),P.resize(A,k,l,u)}}catch(R){C.e(R)}finally{C.f()}}},cleanUp:function(){c&&window.removeEventListener("resize",c)}};return v&&_.update(),_}},4634:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ViewportInputHandler=void 0;var s=i(3233),a=i(3192),o=function(){function t(e){n(this,t),this.screenCoord=new a.Vector2,this.worldCoord=new a.Vector2,this.viewport=e,this.canvas=e.getCanvas(),this.inputHandler=new s.InputHandler(this.canvas)}return r(t,[{key:"isTouched",value:function(){return this.inputHandler.isTouched()}},{key:"cleanup",value:function(){this.inputHandler.cleanup()}},{key:"addEventListener",value:function(t,e){var i,n;this.inputHandler.addEventListener(t,(i=e,n=this.viewport,function(t,e){var r=n.getViewportInfo(),s=r.x,a=r.y,o=r.pixelRatio;i(t=t*o-s,e=e*o-a)}))}},{key:"getX",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.viewport.getViewportInfo(),i=e.x,n=e.pixelRatio;return this.inputHandler.getX(t)*n-i}},{key:"getY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.viewport.getViewportInfo(),i=e.y,n=e.pixelRatio;return this.inputHandler.getY(t)*n-i}},{key:"getTouchedWorldCoord",value:function(t){return t||(t=this.viewport.getCamera()),this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}},{key:"getTotalTouched",value:function(){return this.inputHandler.touches}}]),t}();e.ViewportInputHandler=o},5547:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(8863),e),r(i(9416),e),r(i(9054),e),r(i(7035),e),r(i(5283),e),r(i(6735),e),r(i(909),e),r(i(2691),e),r(i(814),e),r(i(2229),e),r(i(5508),e),r(i(417),e),r(i(1013),e),r(i(3233),e),r(i(5474),e),r(i(4731),e),r(i(2226),e),r(i(2991),e),r(i(4496),e),r(i(6403),e),r(i(2438),e),r(i(9805),e),r(i(3432),e),r(i(8143),e),r(i(8026),e),r(i(8637),e),r(i(3192),e),r(i(2668),e),r(i(7885),e),r(i(4634),e)},3897:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n},t.exports.__esModule=!0,t.exports.default=t.exports},5372:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3405:function(t,e,i){var n=i(3897);t.exports=function(t){if(Array.isArray(t))return n(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6115:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},6690:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},9728:function(t){function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},4704:function(t,e,i){var n=i(6116);t.exports=function(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=n(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw a}}}},t.exports.__esModule=!0,t.exports.default=t.exports},6389:function(t,e,i){var n=i(3808),r=i(9617),s=i(4993);t.exports=function(t){var e=r();return function(){var i,r=n(t);if(e){var a=n(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return s(this,i)}},t.exports.__esModule=!0,t.exports.default=t.exports},8416:function(t){t.exports=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},t.exports.__esModule=!0,t.exports.default=t.exports},1588:function(t,e,i){var n=i(1753);function r(){return"undefined"!==typeof Reflect&&Reflect.get?(t.exports=r=Reflect.get.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=r=function(t,e,i){var r=n(t,e);if(r){var s=Object.getOwnPropertyDescriptor(r,e);return s.get?s.get.call(arguments.length<3?t:i):s.value}},t.exports.__esModule=!0,t.exports.default=t.exports),r.apply(this,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},3808:function(t){function e(i){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},1655:function(t,e,i){var n=i(6015);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},9617:function(t){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},9498:function(t){t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},8872:function(t){t.exports=function(t,e){var i=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,s=[],a=!0,o=!1;try{for(i=i.call(t);!(a=(n=i.next()).done)&&(s.push(n.value),!e||s.length!==e);a=!0);}catch(l){o=!0,r=l}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return s}},t.exports.__esModule=!0,t.exports.default=t.exports},2218:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},2281:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},4993:function(t,e,i){var n=i(8698).default,r=i(6115);t.exports=function(t,e){if(e&&("object"===n(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},7061:function(t,e,i){var n=i(8698).default;function r(){"use strict";t.exports=r=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},i=Object.prototype,s=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(E){h=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof v?e:v,s=Object.create(r.prototype),a=new k(n||[]);return s._invoke=function(t,e,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return S()}for(i.method=r,i.arg=s;;){var a=i.delegate;if(a){var o=_(a,i);if(o){if(o===d)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var l=f(t,e,i);if("normal"===l.type){if(n=i.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n="completed",i.method="throw",i.arg=l.arg)}}}(t,i,a),s}function f(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(E){return{type:"throw",arg:E}}}e.wrap=c;var d={};function v(){}function p(){}function g(){}var m={};h(m,o,(function(){return this}));var y=Object.getPrototypeOf,M=y&&y(y(L([])));M&&M!==i&&s.call(M,o)&&(m=M);var x=g.prototype=v.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(r,a,o,l){var u=f(t[r],t,a);if("throw"!==u.type){var h=u.arg,c=h.value;return c&&"object"==n(c)&&s.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):e.resolve(c).then((function(t){h.value=t,o(h)}),(function(t){return i("throw",t,o,l)}))}l(u.arg)}var r;this._invoke=function(t,n){function s(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(s,s):s()}}function _(t,e){var i=t.iterator[e.method];if(void 0===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=f(i,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,d;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(s.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=g,h(x,"constructor",g),h(g,"constructor",p),p.displayName=h(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},b(w.prototype),h(w.prototype,l,(function(){return this})),e.AsyncIterator=w,e.async=function(t,i,n,r,s){void 0===s&&(s=Promise);var a=new w(c(t,i,n,r),s);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(x),h(x,u,"Generator"),h(x,o,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,n){return a.type="throw",a.arg=t,e.next=i,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var o=s.call(r,"catchLoc"),l=s.call(r,"finallyLoc");if(o&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),A(i),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;A(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:L(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},6015:function(t){function e(i,n){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},7424:function(t,e,i){var n=i(5372),r=i(8872),s=i(6116),a=i(2218);t.exports=function(t,e){return n(t)||r(t,e)||s(t,e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},1753:function(t,e,i){var n=i(3808);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},861:function(t,e,i){var n=i(3405),r=i(9498),s=i(6116),a=i(2281);t.exports=function(t){return n(t)||r(t)||s(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},8698:function(t){function e(i){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6116:function(t,e,i){var n=i(3897);t.exports=function(t,e){if(t){if("string"===typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}!function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return i};var i={},n=Object.prototype,r=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(S){u=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof d?e:d,s=Object.create(r.prototype),a=new A(n||[]);return s._invoke=function(t,e,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return L()}for(i.method=r,i.arg=s;;){var a=i.delegate;if(a){var o=w(a,i);if(o){if(o===f)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var l=c(t,e,i);if("normal"===l.type){if(n=i.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n="completed",i.method="throw",i.arg=l.arg)}}}(t,i,a),s}function c(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(S){return{type:"throw",arg:S}}}i.wrap=h;var f={};function d(){}function v(){}function p(){}var g={};u(g,a,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(k([])));y&&y!==n&&r.call(y,a)&&(g=y);var M=p.prototype=d.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(e,i){function n(s,a,o,l){var u=c(e[s],e,a);if("throw"!==u.type){var h=u.arg,f=h.value;return f&&"object"==t(f)&&r.call(f,"__await")?i.resolve(f.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):i.resolve(f).then((function(t){h.value=t,o(h)}),(function(t){return n("throw",t,o,l)}))}l(u.arg)}var s;this._invoke=function(t,e){function r(){return new i((function(i,r){n(t,e,i,r)}))}return s=s?s.then(r,r):r()}}function w(t,e){var i=t.iterator[e.method];if(void 0===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=c(i,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,f;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(r.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:L}}function L(){return{value:void 0,done:!0}}return v.prototype=p,u(M,"constructor",p),u(p,"constructor",v),v.displayName=u(p,l,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,l,"GeneratorFunction")),t.prototype=Object.create(M),t},i.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,o,(function(){return this})),i.AsyncIterator=b,i.async=function(t,e,n,r,s){void 0===s&&(s=Promise);var a=new b(h(t,e,n,r),s);return i.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(M),u(M,l,"Generator"),u(M,a,(function(){return this})),u(M,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},i.values=k,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,n){return a.type="throw",a.arg=t,e.next=i,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(o&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),T(i),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;T(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:k(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),f}},i}function n(t,e,i,n,r,s,a){try{var o=t[s](a),l=o.value}catch(u){return void i(u)}o.done?e(l):Promise.resolve(l).then(n,r)}function r(t){return function(){var e=this,i=arguments;return new Promise((function(r,s){var a=t.apply(e,i);function o(t){n(a,r,s,o,l,"next",t)}function l(t){n(a,r,s,o,l,"throw",t)}o(void 0)}))}}var s=i(5547);function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u=o((function t(){l(this,t)}));u.SCREEN_WIDTH=750,u.SCREEN_HEIGHT=1500,u.DEFAULT_DIRECTION_X=5,u.DEFAULT_DIRECTION_Y=0;var h=i(7530);function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function f(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(e,i){if(i&&("object"===t(i)||"function"===typeof i))return i;if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function g(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=d(t);if(e){var r=d(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p(this,i)}}var m=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).hp=void 0,t.maxHP=void 0,t}return o(i,[{key:"setHp",value:function(t){this.hp=t}},{key:"setMaxHP",value:function(t){this.maxHP=t}}]),i}(h.wA),y=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).direction=new s.Vector2,t.speed=void 0,t}return o(i,[{key:"setDirection",value:function(t,e){this.direction.set(t,e)}},{key:"setSpeed",value:function(t){this.speed=t}}]),i}(h.wA),M=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).pos=new s.Vector2(0,0),t.radius=0,t.rotation=0,t.speed=0,t}return o(i,[{key:"setPos",value:function(t,e){this.pos.set(t,e)}},{key:"setRadius",value:function(t){this.radius=t}},{key:"setRotation",value:function(t){this.rotation=t}},{key:"setSpeed",value:function(t){this.speed=t}}]),i}(h.wA);function x(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}var w,_,T,A,k,L,S,E,C,P,R,I,F,G,B,O,U,D,V,N,z,j,W,H,X,Y,q,K,Z,Q,J,$,tt,et,it,nt,rt,st,at,ot,lt,ut,ht,ct,ft,dt,vt,pt,gt,mt,yt,Mt,xt,bt,wt,_t,Tt,At,kt,Lt,St,Et,Ct,Pt,Rt,It,Ft,Gt,Bt,Ot,Ut,Dt,Vt,Nt,zt,jt,Wt,Ht,Xt,Yt,qt,Kt,Zt,Qt,Jt,$t,te,ee,ie,ne,re,se,ae,oe,le=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).damage=void 0,t}return o(i,[{key:"setDmg",value:function(t){this.damage=t}}]),i}(h.wA),ue=(w=(0,h.tB)("levelState"),_=(0,h.tB)("gameState"),T=(0,h.tB)("configGame"),A=(0,h.tB)("powerEnemy"),k=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"levelState",L,v(t)),x(t,"gameState",S,v(t)),x(t,"configGame",E,v(t)),x(t,"powerEnemy",C,v(t)),t.protectBallArchetype=new h.Yl([M,le]),t.offsetProtectBall=100,t}return o(i,[{key:"process",value:function(){if(this.levelState.exp>=this.levelState.maxExp){this.levelState.exp=1,this.levelState.currentLevel++,this.configGame.enemysRespawnTime*=2,this.powerEnemy.hp+=75;for(var t=this.configGame.amountProtectBall-1;t>=0;t--)this.world.deleteEntity(this.gameState.protectBall[t]),this.gameState.protectBall.splice(t,1);if(this.configGame.amountProtectBall=Math.max(this.configGame.amountProtectBall-5,0),1===this.levelState.currentLevel&&(this.levelState.maxExp=100),2===this.levelState.currentLevel&&(this.levelState.maxExp=70),3===this.levelState.currentLevel&&(this.levelState.maxExp=50),4===this.levelState.currentLevel&&(this.levelState.maxExp=30),1===this.levelState.role){this.configGame.normalAttack*=2,this.configGame.speedProtectBall++,this.configGame.cooldownSkill3*=2;for(var e=0;e<this.configGame.amountProtectBall;e++){var i=this.world.createEntityByArchetype(this.protectBallArchetype);this.gameState.protectBall.push(i),this.world.getComponent(i,le).setDmg(50);var n=this.world.getComponent(i,M);n.pos.set(this.offsetProtectBall,this.offsetProtectBall),n.setRadius(15),n.setRotation(360/this.configGame.amountProtectBall*e)}}if(2===this.levelState.role){this.configGame.sizeSkill1Mage/=1.5,this.configGame.laserCooldown+=.5,console.log(this.configGame.amountProtectBall);for(var r=0;r<this.configGame.amountProtectBall;r++){var s=this.world.createEntityByArchetype(this.protectBallArchetype);this.gameState.protectBall.push(s),this.world.getComponent(s,le).setDmg(50);var a=this.world.getComponent(s,M);a.pos.set(this.offsetProtectBall,this.offsetProtectBall),a.setRadius(15),a.setRotation(360/this.configGame.amountProtectBall*r)}}}}}]),i}(h.xP),L=b(k.prototype,"levelState",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=b(k.prototype,"gameState",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=b(k.prototype,"configGame",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=b(k.prototype,"powerEnemy",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k),he=(P=(0,h.tB)("cameraGame"),R=(0,h.tB)("gameState"),I=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"cameraGame",F,v(t)),x(t,"gameState",G,v(t)),t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.playerID,M);this.cameraGame.setPosition(t.pos.x,t.pos.y),this.cameraGame.update()}}]),i}(h.xP),F=b(I.prototype,"cameraGame",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=b(I.prototype,"gameState",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I),ce=(B=(0,h.tB)("shapeRenderer"),O=(0,h.tB)("cameraUI"),U=(0,h.tB)("cameraGame"),D=(0,h.tB)("gameState"),V=(0,h.tB)("joyStick"),N=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",z,v(t)),x(t,"cameraUI",j,v(t)),x(t,"cameraGame",W,v(t)),x(t,"gameState",H,v(t)),x(t,"joyStick",X,v(t)),t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.playerID,m);this.shapeRenderer.setProjection(this.cameraUI.combined),this.shapeRenderer.begin(),t.hp>=0&&(this.shapeRenderer.circle(!1,this.joyStick.origin.x,this.joyStick.origin.y,125,s.Color.WHITE),this.shapeRenderer.circle(!0,this.joyStick.thumbPos.x,this.joyStick.thumbPos.y,35,s.Color.WHITE)),this.shapeRenderer.end(),this.shapeRenderer.setProjection(this.cameraGame.combined)}}]),i}(h.xP),z=b(N.prototype,"shapeRenderer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=b(N.prototype,"cameraUI",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=b(N.prototype,"cameraGame",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=b(N.prototype,"gameState",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=b(N.prototype,"joyStick",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N),fe=(Y=(0,h.tB)("inputHandler"),q=(0,h.tB)("joyStick"),K=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return x(t=e.call.apply(e,[this].concat(r)),"inputHandler",Z,v(t)),x(t,"joyStick",Q,v(t)),t.tempTouchedWorldCoord=new s.Vector2,t.tempDirection=new s.Vector2(u.DEFAULT_DIRECTION_X,u.DEFAULT_DIRECTION_Y),t}return o(i,[{key:"initialized",value:function(){}},{key:"process",value:function(){this.inputHandler.isTouched()&&this.inputHandler.getTouchedWorldCoord().y<u.SCREEN_HEIGHT/2?(!1===this.joyStick.touched&&this.joyStick.origin.setVector(this.inputHandler.getTouchedWorldCoord()),this.joyStick.touched=!0,this.joyStick.move=!0,this.joyStick.dragging||(this.joyStick.dragging=!0),this.joyStick.direction.setVector(this.inputHandler.getTouchedWorldCoord()).subVector(this.joyStick.origin).nor(),this.joyStick.direction.x<0&&this.tempTouchedWorldCoord.x-this.joyStick.origin.x>125*this.joyStick.direction.x||this.joyStick.direction.x>0&&this.tempTouchedWorldCoord.x-this.joyStick.origin.x<125*this.joyStick.direction.x?this.joyStick.thumbPos.setVector(this.inputHandler.getTouchedWorldCoord()):this.joyStick.thumbPos.setVector(this.joyStick.direction).scale(125).addVector(this.joyStick.origin),this.tempTouchedWorldCoord.setVector(this.inputHandler.getTouchedWorldCoord())):(this.tempDirection.setVector(this.joyStick.direction),this.joyStick.dragging=!1,this.joyStick.origin.set(400,300),this.joyStick.thumbPos.set(400,300))}}]),i}(h.xP),Z=b(K.prototype,"inputHandler",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=b(K.prototype,"joyStick",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K),de=(J=(0,h.tB)("gameState"),$=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",tt,v(t)),t}return o(i,[{key:"process",value:function(){for(var t=this.world.getComponent(this.gameState.playerID,M),e=0;e<this.gameState.normalAttackBulletIDs.length;e++){var i=this.world.getComponent(this.gameState.normalAttackBulletIDs[e],M);t.pos.distance(i.pos)>350&&(this.world.deleteEntity(this.gameState.normalAttackBulletIDs[e]),this.gameState.normalAttackBulletIDs.splice(e,1))}for(var n=this.gameState.normalAttackBulletIDs.length-1;n>=0;n--){var r=this.world.getComponent(this.gameState.normalAttackBulletIDs[n],M),s=this.world.getComponent(this.gameState.normalAttackBulletIDs[n],y),a=this.world.getComponent(this.gameState.normalAttackBulletIDs[n],le);r.pos.add(s.direction.x*s.speed,s.direction.y*s.speed);for(var o=this.gameState.enemyIDs.length-1;o>=0;o--){var l=this.world.getComponent(this.gameState.enemyIDs[o],M),u=this.world.getComponent(this.gameState.enemyIDs[o],m);l.pos.x<=r.pos.x+25&&l.pos.x>=r.pos.x-25&&l.pos.y<=r.pos.y+25&&l.pos.y>=r.pos.y-25&&(this.world.deleteEntity(this.gameState.normalAttackBulletIDs[n]),u.hp=Math.max(u.hp-a.damage,0),this.gameState.normalAttackBulletIDs.splice(n,1))}}}}]),i}(h.xP),tt=b($.prototype,"gameState",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$),ve=(et=(0,h.tB)("shapeRenderer"),it=(0,h.tB)("gameState"),nt=(0,h.tB)("configGame"),rt=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",st,v(t)),x(t,"gameState",at,v(t)),x(t,"configGame",ot,v(t)),t}return o(i,[{key:"process",value:function(){this.shapeRenderer.begin();for(var t=0;t<this.gameState.normalAttackBulletIDs.length;t++){var e=this.world.getComponent(this.gameState.normalAttackBulletIDs[t],M);this.shapeRenderer.circle(!0,e.pos.x,e.pos.y,e.radius,s.Color.RED)}this.shapeRenderer.end()}}]),i}(h.xP),st=b(rt.prototype,"shapeRenderer",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at=b(rt.prototype,"gameState",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ot=b(rt.prototype,"configGame",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rt),pe=(lt=(0,h.tB)("gameState"),ut=(0,h.tB)("configGame"),ht=(0,h.tB)("joyStick"),ct=(0,h.tB)("levelState"),ft=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",dt,v(t)),x(t,"configGame",vt,v(t)),x(t,"joyStick",pt,v(t)),x(t,"levelState",gt,v(t)),t.cooldownNormalAttack=-3,t}return o(i,[{key:"process",value:function(){this.cooldownNormalAttack+=this.world.delta;var t=this.world.getComponent(this.gameState.playerID,M);if(this.cooldownNormalAttack>=this.configGame.normalAttack&&this.joyStick.direction!=new s.Vector2(0,0)&&this.levelState.currentLevel<=3){for(var e=this.levelState.currentLevel-1-2;e<=2-(this.levelState.currentLevel-1);e++){var i=new h.Yl([M,y,le]),n=this.world.createEntityByArchetype(i);this.gameState.normalAttackBulletIDs.push(n);var r=this.world.getComponent(this.gameState.normalAttackBulletIDs[this.gameState.normalAttackBulletIDs.length-1],M),a=this.world.getComponent(this.gameState.normalAttackBulletIDs[this.gameState.normalAttackBulletIDs.length-1],y),o=this.world.getComponent(this.gameState.normalAttackBulletIDs[this.gameState.normalAttackBulletIDs.length-1],le);r.setPos(t.pos.x,t.pos.y),r.setRadius(25),a.setDirection(this.joyStick.direction.x,this.joyStick.direction.y),a.direction.rotate(5*e),a.setSpeed(20),o.setDmg(25*this.levelState.currentLevel)}this.cooldownNormalAttack=0}if(4===this.levelState.currentLevel&&this.cooldownNormalAttack>=this.configGame.normalAttack&&this.joyStick.direction!=new s.Vector2(0,0)){var l=new h.Yl([M,y,le]),u=this.world.createEntityByArchetype(l);this.gameState.normalAttackBulletIDs.push(u);var c=this.world.getComponent(this.gameState.normalAttackBulletIDs[this.gameState.normalAttackBulletIDs.length-1],M),f=this.world.getComponent(this.gameState.normalAttackBulletIDs[this.gameState.normalAttackBulletIDs.length-1],y),d=this.world.getComponent(this.gameState.normalAttackBulletIDs[this.gameState.normalAttackBulletIDs.length-1],le);c.setPos(t.pos.x,t.pos.y),c.setRadius(10),f.setDirection(this.joyStick.direction.x,this.joyStick.direction.y),f.direction.rotate(0),f.setSpeed(20),d.setDmg(25*this.levelState.currentLevel),this.cooldownNormalAttack=0}}}]),i}(h.xP),dt=b(ft.prototype,"gameState",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=b(ft.prototype,"configGame",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=b(ft.prototype,"joyStick",[ht],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt=b(ft.prototype,"levelState",[ct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft),ge=(mt=(0,h.tB)("shapeRenderer"),yt=(0,h.tB)("gameState"),Mt=(0,h.tB)("levelState"),xt=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",bt,v(t)),x(t,"gameState",wt,v(t)),x(t,"levelState",_t,v(t)),t.width=50,t.offset=25,t.tempDirection=new s.Vector2(0,0),t.offsetAngle=45,t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.playerID,M),e=this.world.getComponent(this.gameState.playerID,m);this.shapeRenderer.begin(),e.hp>0&&(this.shapeRenderer.circle(!0,t.pos.x,t.pos.y,t.radius,s.Color.GREEN),this.shapeRenderer.rect(!0,t.pos.x-this.offset,t.pos.y-this.offset-15,this.width*(e.hp/e.maxHP),15,s.Color.RED),this.shapeRenderer.rect(!1,t.pos.x-this.offset,t.pos.y-this.offset-15,this.width,15),this.shapeRenderer.rect(!0,t.pos.x-this.offset-1,t.pos.y-this.offset-25,this.width*(this.levelState.exp/this.levelState.maxExp),10,s.Color.WHITE),this.tempDirection.set(50,50),this.tempDirection.rotate(t.rotation-this.offsetAngle),this.tempDirection.addVector(t.pos),this.shapeRenderer.circle(!0,this.tempDirection.x,this.tempDirection.y,10,s.Color.MAGENTA)),this.shapeRenderer.end()}}]),i}(h.xP),bt=b(xt.prototype,"shapeRenderer",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=b(xt.prototype,"gameState",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_t=b(xt.prototype,"levelState",[Mt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt),me=(Tt=(0,h.tB)("gameState"),At=(0,h.tB)("configGame"),kt=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",Lt,v(t)),x(t,"configGame",St,v(t)),t.offset=100,t}return o(i,[{key:"process",value:function(){for(var t=0;t<this.gameState.protectBall.length;t++){var e=this.world.getComponent(this.gameState.protectBall[t],M),i=this.world.getComponent(this.gameState.protectBall[t],le),n=this.world.getComponent(this.gameState.playerID,M);e.pos.set(this.offset,this.offset),e.pos.rotate(e.rotation-=this.configGame.speedProtectBall),e.pos.addVector(n.pos);for(var r=this.gameState.enemyIDs.length-1;r>=0;r--){var s=this.world.getComponent(this.gameState.enemyIDs[r],M),a=this.world.getComponent(this.gameState.enemyIDs[r],m);s.pos.x<=e.pos.x+25&&s.pos.x>=e.pos.x-25&&s.pos.y<=e.pos.y+25&&s.pos.y>=e.pos.y-25&&(a.hp=Math.max(a.hp-i.damage,0))}}}}]),i}(h.xP),Lt=b(kt.prototype,"gameState",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St=b(kt.prototype,"configGame",[At],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt),ye=(Et=(0,h.tB)("shapeRenderer"),Ct=(0,h.tB)("gameState"),Pt=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",Rt,v(t)),x(t,"gameState",It,v(t)),t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.playerID,m);if(this.shapeRenderer.begin(),t.hp>0)for(var e=0;e<this.gameState.protectBall.length;e++){var i=this.world.getComponent(this.gameState.protectBall[e],M);this.shapeRenderer.circle(!0,i.pos.x,i.pos.y,i.radius)}this.shapeRenderer.end()}}]),i}(h.xP),Rt=b(Pt.prototype,"shapeRenderer",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=b(Pt.prototype,"gameState",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt),Me=(Ft=(0,h.tB)("gameState"),Gt=(0,h.tB)("configGame"),Bt=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",Ot,v(t)),x(t,"configGame",Ut,v(t)),t.offset=100,t}return o(i,[{key:"initialized",value:function(){for(var t=0;t<this.configGame.amountProtectBall;t++){var e=new h.Yl([M,le]),i=this.world.createEntityByArchetype(e);this.gameState.protectBall.push(i),this.world.getComponent(this.gameState.protectBall[t],le).setDmg(50);var n=this.world.getComponent(this.gameState.protectBall[t],M);n.pos.set(this.offset,this.offset),n.setRadius(15),n.setRotation(360/this.configGame.amountProtectBall*t)}}},{key:"process",value:function(){}}]),i}(h.xP),Ot=b(Bt.prototype,"gameState",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ut=b(Bt.prototype,"configGame",[Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt),xe=(Dt=(0,h.tB)("gameState"),Vt=(0,h.tB)("configGame"),Nt=(0,h.tB)("levelState"),zt=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return x(t=e.call.apply(e,[this].concat(r)),"gameState",jt,v(t)),x(t,"configGame",Wt,v(t)),x(t,"levelState",Ht,v(t)),t.time=0,t.tempNumber=0,t.tempVec2=new s.Vector2,t}return o(i,[{key:"process",value:function(){this.time+=this.world.delta;for(var t=this.gameState.bulletIDs.length-1;t>=0;t--){var e=this.world.getComponent(this.gameState.bulletIDs[t],M),i=this.world.getComponent(this.gameState.bulletIDs[t],y),n=this.world.getComponent(this.gameState.bulletIDs[t],le);e.pos.add(i.direction.x*i.speed,i.direction.y*i.speed);for(var r=this.gameState.enemyIDs.length-1;r>=0;r--){var s=this.world.getComponent(this.gameState.enemyIDs[r],M),a=this.world.getComponent(this.gameState.enemyIDs[r],m);s.pos.x<=e.pos.x+25&&s.pos.x>=e.pos.x-25&&s.pos.y<=e.pos.y+25&&s.pos.y>=e.pos.y-25&&(a.hp=Math.max(a.hp-n.damage,0));for(var o=this.world.getComponent(this.gameState.playerID,M),l=0;l<this.gameState.bulletIDs.length;l++){var u=this.world.getComponent(this.gameState.bulletIDs[l],M);o.pos.distance(u.pos)>1e3&&(this.world.deleteEntity(this.gameState.bulletIDs[l]),this.gameState.bulletIDs.splice(l,1))}}}}}]),i}(h.xP),jt=b(zt.prototype,"gameState",[Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=b(zt.prototype,"configGame",[Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=b(zt.prototype,"levelState",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt),be=(Xt=(0,h.tB)("shapeRenderer"),Yt=(0,h.tB)("gameState"),qt=(0,h.tB)("configGame"),Kt=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",Zt,v(t)),x(t,"gameState",Qt,v(t)),x(t,"configGame",Jt,v(t)),t}return o(i,[{key:"process",value:function(){this.shapeRenderer.begin();for(var t=0;t<this.gameState.bulletIDs.length;t++){var e=this.world.getComponent(this.gameState.bulletIDs[t],M);this.shapeRenderer.circle(!0,e.pos.x,e.pos.y,e.radius,s.Color.WHITE)}this.shapeRenderer.end()}}]),i}(h.xP),Zt=b(Kt.prototype,"shapeRenderer",[Xt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qt=b(Kt.prototype,"gameState",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jt=b(Kt.prototype,"configGame",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt);function we(t,e){return Math.floor(Math.random()*(e-t))+t}var _e,Te,Ae,ke,Le,Se,Ee,Ce,Pe,Re,Ie,Fe,Ge,Be,Oe,Ue,De,Ve,Ne,ze,je,We,He,Xe,Ye,qe,Ke,Ze,Qe,Je,$e,ti,ei,ii,ni,ri,si,ai,oi,li,ui,hi,ci,fi,di,vi,pi,gi,mi,yi,Mi,xi,bi,wi,_i,Ti,Ai,ki,Li,Si,Ei,Ci,Pi=($t=(0,h.tB)("configGame"),te=(0,h.tB)("joyStick"),ee=(0,h.tB)("gameState"),ie=(0,h.tB)("levelState"),ne=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return x(t=e.call.apply(e,[this].concat(r)),"configGame",re,v(t)),x(t,"joyStick",se,v(t)),x(t,"gameState",ae,v(t)),x(t,"levelState",oe,v(t)),t.timeSkill3=0,t.tempNumber=0,t.tempVec2=new s.Vector2,t}return o(i,[{key:"process",value:function(){this.timeSkill3+=this.world.delta;var t=this.world.getComponent(this.gameState.playerID,M);if(this.timeSkill3>=this.configGame.cooldownSkill3&&this.gameState.enemyIDs.length&&this.levelState.currentLevel<3){var e=new h.Yl([M,y,le]),i=this.world.createEntityByArchetype(e);this.gameState.bulletIDs.push(i);var n=this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],M),r=this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],y);this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],le).setDmg(25);var s=this.world.getComponent(this.gameState.enemyIDs[we(0,this.gameState.enemyIDs.length)],M);if(this.tempVec2.setVector(s.pos).subVector(t.pos).nor(),r.setDirection(this.tempVec2.x,this.tempVec2.y),r.speed=15,n.setPos(t.pos.x,t.pos.y),n.setRadius(10),this.gameState.enemyIDs.length>2)for(var a=0;a<4-this.levelState.currentLevel-1;a++){var o=new h.Yl([M,y,le]),l=this.world.createEntityByArchetype(o);this.gameState.bulletIDs.push(l);var u=this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],M),c=this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],y);this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],le).setDmg(25);var f=this.world.getComponent(this.gameState.enemyIDs[we(0,this.gameState.enemyIDs.length)],M);this.tempVec2.setVector(f.pos).subVector(t.pos).nor(),c.setDirection(this.tempVec2.x,this.tempVec2.y),c.speed=15,u.setPos(t.pos.x,t.pos.y),u.setRadius(10)}this.timeSkill3=0}}}]),i}(h.xP),re=b(ne.prototype,"configGame",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se=b(ne.prototype,"joyStick",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=b(ne.prototype,"gameState",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe=b(ne.prototype,"levelState",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne),Ri=(_e=(0,h.tB)("gameState"),Te=(0,h.tB)("configGame"),Ae=(0,h.tB)("joyStick"),ke=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",Le,v(t)),x(t,"configGame",Se,v(t)),x(t,"joyStick",Ee,v(t)),t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.playerID,M),e=this.world.getComponent(this.gameState.playerID,y),i=this.world.getComponent(this.gameState.playerID,m);i.hp<=0&&(this.configGame.stop=!0),this.joyStick.dragging&&(t.pos.add(this.joyStick.direction.x*e.speed,this.joyStick.direction.y*e.speed),t.rotation=this.joyStick.direction.angle()<0?180*(2*Math.PI+this.joyStick.direction.angle())/Math.PI:this.joyStick.direction.angle()/Math.PI*180);for(var n=0;n<this.gameState.enemyIDs.length;n++){var r=this.world.getComponent(this.gameState.enemyIDs[n],M);t.pos.x<=r.pos.x+50&&t.pos.x>=r.pos.x-50&&t.pos.y<=r.pos.y+50&&t.pos.y>=r.pos.y-50&&(i.hp-=1)}}}]),i}(h.xP),Le=b(ke.prototype,"gameState",[_e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se=b(ke.prototype,"configGame",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ee=b(ke.prototype,"joyStick",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ke),Ii=(Ce=(0,h.tB)("gameState"),Pe=(0,h.tB)("shapeRenderer"),Re=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",Ie,v(t)),x(t,"shapeRenderer",Fe,v(t)),t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.protectSkill,M),e=this.world.getComponent(this.gameState.playerID,m);this.shapeRenderer.begin(),e.hp>=0&&this.shapeRenderer.circle(!0,t.pos.x,t.pos.y,t.radius,s.Color.RED),this.shapeRenderer.end()}}]),i}(h.xP),Ie=b(Re.prototype,"gameState",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fe=b(Re.prototype,"shapeRenderer",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re),Fi=(Ge=(0,h.tB)("gameState"),Be=(0,h.tB)("configGame"),Oe=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",Ue,v(t)),x(t,"configGame",De,v(t)),t}return o(i,[{key:"initialized",value:function(){var t=new h.Yl([M,le]),e=this.world.createEntityByArchetype(t);this.gameState.protectSkill=e,this.world.getComponent(this.gameState.protectSkill,le).setDmg(25)}},{key:"process",value:function(){this.configGame.timeToMakeDamage+=this.world.delta*this.configGame.sizeSkill1Mage;var t=this.world.getComponent(this.gameState.playerID,M),e=this.world.getComponent(this.gameState.protectSkill,M),i=this.world.getComponent(this.gameState.protectSkill,le);if(e.setPos(t.pos.x,t.pos.y),e.setRadius(this.configGame.timeToMakeDamage),this.configGame.timeToMakeDamage>this.configGame.sizeSkill1Mage){for(var n=0;n<this.gameState.enemyIDs.length;n++){var r=this.world.getComponent(this.gameState.enemyIDs[n],M),s=this.world.getComponent(this.gameState.enemyIDs[n],m);r.pos.x<=e.pos.x+e.radius&&r.pos.x>=e.pos.x-e.radius&&r.pos.y<=e.pos.y+e.radius&&r.pos.y>=e.pos.y-e.radius&&(s.hp=Math.max(s.hp-i.damage,0))}this.configGame.timeToMakeDamage=0}}}]),i}(h.xP),Ue=b(Oe.prototype,"gameState",[Ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=b(Oe.prototype,"configGame",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe),Gi=(Ve=(0,h.tB)("gameState"),Ne=(0,h.tB)("configGame"),ze=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",je,v(t)),x(t,"configGame",We,v(t)),t.offset=175,t}return o(i,[{key:"process",value:function(){for(var t=0;t<this.gameState.protectBall.length;t++){var e=this.world.getComponent(this.gameState.protectBall[t],M),i=this.world.getComponent(this.gameState.protectBall[t],le),n=this.world.getComponent(this.gameState.playerID,M);e.pos.set(this.offset,this.offset),e.pos.rotate(e.rotation-=this.configGame.speedProtectBall),e.pos.addVector(n.pos);for(var r=this.gameState.enemyIDs.length-1;r>=0;r--){var s=this.world.getComponent(this.gameState.enemyIDs[r],M),a=this.world.getComponent(this.gameState.enemyIDs[r],m);s.pos.x<=e.pos.x+25&&s.pos.x>=e.pos.x-25&&s.pos.y<=e.pos.y+25&&s.pos.y>=e.pos.y-25&&(a.hp=Math.max(a.hp-i.damage,0))}}}}]),i}(h.xP),je=b(ze.prototype,"gameState",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=b(ze.prototype,"configGame",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze),Bi=(He=(0,h.tB)("gameState"),Xe=(0,h.tB)("configGame"),Ye=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",qe,v(t)),x(t,"configGame",Ke,v(t)),t.offset=175,t}return o(i,[{key:"initialized",value:function(){for(var t=0;t<this.configGame.amountProtectBall;t++){var e=new h.Yl([M,le]),i=this.world.createEntityByArchetype(e);this.gameState.protectBall.push(i),this.world.getComponent(this.gameState.protectBall[t],le).setDmg(5);var n=this.world.getComponent(this.gameState.protectBall[t],M);n.pos.set(this.offset,this.offset),n.setRadius(15),n.setRotation(360/this.configGame.amountProtectBall*t)}}},{key:"process",value:function(){}}]),i}(h.xP),qe=b(Ye.prototype,"gameState",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=b(Ye.prototype,"configGame",[Xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye),Oi=(Ze=(0,h.tB)("shapeRenderer"),Qe=(0,h.tB)("gameState"),Je=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",$e,v(t)),x(t,"gameState",ti,v(t)),t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.playerID,m);if(this.shapeRenderer.begin(),t.hp>0)for(var e=0;e<this.gameState.protectBall.length;e++){var i=this.world.getComponent(this.gameState.protectBall[e],M);this.shapeRenderer.circle(!0,i.pos.x,i.pos.y,i.radius)}this.shapeRenderer.end()}}]),i}(h.xP),$e=b(Je.prototype,"shapeRenderer",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ti=b(Je.prototype,"gameState",[Qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je),Ui=(ei=(0,h.tB)("gameState"),ii=(0,h.tB)("joyStick"),ni=(0,h.tB)("levelState"),ri=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return x(t=e.call.apply(e,[this].concat(r)),"gameState",si,v(t)),x(t,"joyStick",ai,v(t)),x(t,"levelState",oi,v(t)),t.direction=new s.Vector2,t}return o(i,[{key:"process",value:function(){for(var t=this.world.getComponent(this.gameState.playerID,M),e=this.gameState.enemyIDs.length-1;e>=0;e--){this.world.getComponent(this.gameState.enemyIDs[e],m).hp<=0&&(this.world.deleteEntity(this.gameState.enemyIDs[e]),this.gameState.enemyIDs.splice(e,1),this.levelState.exp++)}for(var i=0;i<this.gameState.enemyIDs.length;i++){var n=this.world.getComponent(this.gameState.enemyIDs[i],M);this.direction.setVector(t.pos).subVector(n.pos).nor(),n.pos.add(3*this.direction.x,3*this.direction.y)}}}]),i}(h.xP),si=b(ri.prototype,"gameState",[ei],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ai=b(ri.prototype,"joyStick",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oi=b(ri.prototype,"levelState",[ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ri),Di=(li=(0,h.tB)("shapeRenderer"),ui=(0,h.tB)("gameState"),hi=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",ci,v(t)),x(t,"gameState",fi,v(t)),t.width=50,t.offset=25,t}return o(i,[{key:"process",value:function(){this.shapeRenderer.begin();for(var t=0;t<this.gameState.enemyIDs.length;t++){var e=this.world.getComponent(this.gameState.enemyIDs[t],M),i=this.world.getComponent(this.gameState.enemyIDs[t],m);this.shapeRenderer.circle(!0,e.pos.x,e.pos.y,e.radius,s.Color.BLUE),this.shapeRenderer.rect(!0,e.pos.x-this.offset,e.pos.y-this.offset-15,this.width*(i.hp/i.maxHP),15,s.Color.RED),this.shapeRenderer.rect(!1,e.pos.x-this.offset,e.pos.y-this.offset-15,this.width,15)}this.shapeRenderer.end()}}]),i}(h.xP),ci=b(hi.prototype,"shapeRenderer",[li],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fi=b(hi.prototype,"gameState",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hi),Vi=(di=(0,h.tB)("gameState"),vi=(0,h.tB)("configGame"),pi=(0,h.tB)("powerEnemy"),gi=(0,h.tB)("levelState"),mi=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",yi,v(t)),x(t,"configGame",Mi,v(t)),x(t,"powerEnemy",xi,v(t)),x(t,"levelState",bi,v(t)),t.MAX_ENEMIES=40,t.time=-1,t}return o(i,[{key:"getRandomInt",value:function(t,e){return Math.floor(Math.random()*(e-t))+t}},{key:"process",value:function(){if(this.time+=this.world.delta,this.time>=this.configGame.enemysRespawnTime&&this.gameState.enemyIDs.length<this.MAX_ENEMIES){var t=new h.Yl([M,m]),e=this.world.createEntityByArchetype(t);this.gameState.enemyIDs.push(e);var i=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],M);i.setPos(this.getRandomInt(0,u.SCREEN_WIDTH/2),this.getRandomInt(0,u.SCREEN_HEIGHT/2)),i.setRadius(25);var n=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],m);n.setHp(this.powerEnemy.hp),n.setMaxHP(this.powerEnemy.hp),this.time=0}}}]),i}(h.xP),yi=b(mi.prototype,"gameState",[di],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mi=b(mi.prototype,"configGame",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xi=b(mi.prototype,"powerEnemy",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bi=b(mi.prototype,"levelState",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mi);var Ni,zi,ji,Wi,Hi,Xi,Yi,qi=(wi=(0,h.tB)("configGame"),_i=(0,h.tB)("joyStick"),Ti=(0,h.tB)("gameState"),Ai=(0,h.tB)("levelState"),ki=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return x(t=e.call.apply(e,[this].concat(r)),"configGame",Li,v(t)),x(t,"joyStick",Si,v(t)),x(t,"gameState",Ei,v(t)),x(t,"levelState",Ci,v(t)),t.timeLaser=0,t.tempNumber=0,t.tempVec2=new s.Vector2,t}return o(i,[{key:"process",value:function(){this.timeLaser+=this.world.delta;var t,e,i=this.world.getComponent(this.gameState.playerID,M);if(this.timeLaser>=this.configGame.laserCooldown&&this.gameState.enemyIDs.length&&this.levelState.currentLevel<3){var n=new h.Yl([M,y,le]),r=this.world.createEntityByArchetype(n);this.gameState.laserSkillID.push(r);var s=this.world.getComponent(this.gameState.laserSkillID[this.gameState.laserSkillID.length-1],M),a=this.world.getComponent(this.gameState.laserSkillID[this.gameState.laserSkillID.length-1],y);this.world.getComponent(this.gameState.laserSkillID[this.gameState.laserSkillID.length-1],le).setDmg(15);var o=this.world.getComponent(this.gameState.enemyIDs[(t=0,e=this.gameState.enemyIDs.length,Math.floor(Math.random()*(e-t))+t)],M);this.tempVec2.setVector(o.pos).subVector(i.pos).nor(),a.setDirection(this.tempVec2.x,this.tempVec2.y),a.speed=15,s.setPos(i.pos.x,i.pos.y),s.setRadius(50),this.timeLaser=0}}}]),i}(h.xP),Li=b(ki.prototype,"configGame",[wi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=b(ki.prototype,"joyStick",[_i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei=b(ki.prototype,"gameState",[Ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ci=b(ki.prototype,"levelState",[Ai],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ki);var Ki,Zi,Qi,Ji,$i,tn,en,nn,rn,sn,an,on,ln,un,hn,cn,fn,dn,vn,pn,gn,mn,yn,Mn,xn,bn,wn,_n,Tn,An,kn,Ln,Sn,En,Cn,Pn,Rn,In,Fn=(Ni=(0,h.tB)("gameState"),zi=(0,h.tB)("configGame"),ji=(0,h.tB)("levelState"),Wi=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return x(t=e.call.apply(e,[this].concat(r)),"gameState",Hi,v(t)),x(t,"configGame",Xi,v(t)),x(t,"levelState",Yi,v(t)),t.time=0,t.tempNumber=0,t.tempVec2=new s.Vector2,t}return o(i,[{key:"process",value:function(){this.time+=this.world.delta;for(var t=this.gameState.laserSkillID.length-1;t>=0;t--){var e=this.world.getComponent(this.gameState.laserSkillID[t],M),i=this.world.getComponent(this.gameState.laserSkillID[t],y),n=this.world.getComponent(this.gameState.laserSkillID[t],le);e.pos.add(i.direction.x*i.speed,i.direction.y*i.speed);for(var r=this.gameState.enemyIDs.length-1;r>=0;r--){var s=this.world.getComponent(this.gameState.enemyIDs[r],M),a=this.world.getComponent(this.gameState.enemyIDs[r],m);s.pos.x<=e.pos.x+e.radius&&s.pos.x>=e.pos.x-e.radius&&s.pos.y<=e.pos.y+e.radius&&s.pos.y>=e.pos.y-e.radius&&(a.hp=Math.max(a.hp-n.damage,0));for(var o=this.world.getComponent(this.gameState.playerID,M),l=0;l<this.gameState.laserSkillID.length;l++){var u=this.world.getComponent(this.gameState.laserSkillID[l],M);o.pos.distance(u.pos)>1500&&(this.world.deleteEntity(this.gameState.laserSkillID[l]),this.gameState.laserSkillID.splice(l,1))}}}}}]),i}(h.xP),Hi=b(Wi.prototype,"gameState",[Ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=b(Wi.prototype,"configGame",[zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yi=b(Wi.prototype,"levelState",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wi),Gn=(Ki=(0,h.tB)("shapeRenderer"),Zi=(0,h.tB)("gameState"),Qi=(0,h.tB)("configGame"),Ji=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",$i,v(t)),x(t,"gameState",tn,v(t)),x(t,"configGame",en,v(t)),t}return o(i,[{key:"process",value:function(){this.shapeRenderer.begin();for(var t=0;t<this.gameState.laserSkillID.length;t++){var e=this.world.getComponent(this.gameState.laserSkillID[t],M);this.shapeRenderer.circle(!0,e.pos.x,e.pos.y,e.radius,s.Color.GREEN)}this.shapeRenderer.end()}}]),i}(h.xP),$i=b(Ji.prototype,"shapeRenderer",[Ki],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tn=b(Ji.prototype,"gameState",[Zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),en=b(Ji.prototype,"configGame",[Qi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ji),Bn=(nn=(0,h.tB)("gameState"),rn=(0,h.tB)("configGame"),sn=(0,h.tB)("inputHandler"),an=(0,h.tB)("levelState"),on=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"gameState",ln,v(t)),x(t,"configGame",un,v(t)),x(t,"inputHandler",hn,v(t)),x(t,"levelState",cn,v(t)),t}return o(i,[{key:"initialized",value:function(){var t=this;this.inputHandler.addEventListener(s.InputEvent.TouchStart,(function(e,i){console.log(e,i),0==t.configGame.start&&(e>=0&&e<=u.SCREEN_WIDTH/2&&(t.levelState.role=1,t.world.addSystem(new fe,!0),t.world.addSystem(new Ri,!0),t.world.addSystem(new Vi,!0),t.world.addSystem(new Ui,!0),t.world.addSystem(new Pi,!0),t.world.addSystem(new xe,!0),t.world.addSystem(new Me,!0),t.world.addSystem(new me,!0),t.world.addSystem(new ue,!0),t.world.addSystem(new pe,!0),t.world.addSystem(new de,!0),t.world.addSystem(new ge,!1),t.world.addSystem(new he,!1),t.world.addSystem(new ce,!1),t.world.addSystem(new Di,!1),t.world.addSystem(new ve,!1),t.world.addSystem(new be,!1),t.world.addSystem(new ye,!1),t.configGame.start=!0),e>=u.SCREEN_WIDTH/2&&(t.levelState.role=2,t.configGame.amountProtectBall=15,t.configGame.start=!0,t.world.addSystem(new Ri,!0),t.world.addSystem(new fe,!0),t.world.addSystem(new ue,!0),t.world.addSystem(new Vi,!0),t.world.addSystem(new Ui,!0),t.world.addSystem(new Fi,!0),t.world.addSystem(new Bi,!0),t.world.addSystem(new Gi,!0),t.world.addSystem(new qi,!0),t.world.addSystem(new Fn,!0),t.world.addSystem(new he,!1),t.world.addSystem(new Ii,!1),t.world.addSystem(new ge,!1),t.world.addSystem(new ce,!1),t.world.addSystem(new Di,!1),t.world.addSystem(new Oi,!1),t.world.addSystem(new Gn,!1)))}))}},{key:"process",value:function(){}}]),i}(h.xP),ln=b(on.prototype,"gameState",[nn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),un=b(on.prototype,"configGame",[rn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=b(on.prototype,"inputHandler",[sn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn=b(on.prototype,"levelState",[an],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),on),On=u.SCREEN_WIDTH/10,Un=On,Dn=(fn=(0,h.tB)("shapeRenderer"),dn=(0,h.tB)("gameState"),vn=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",pn,v(t)),x(t,"gameState",gn,v(t)),t}return o(i,[{key:"process",value:function(){var t=this.world.getComponent(this.gameState.playerID,M);this.shapeRenderer.begin();for(var e=t.pos.x%(u.SCREEN_WIDTH/2),i=Math.ceil((u.SCREEN_WIDTH+Math.abs(e))/On),n=0;n<=i;n++){var r=0;r=t.pos.x>=0?t.pos.x-e+On*n-u.SCREEN_WIDTH/2:t.pos.x-e-On*n+u.SCREEN_WIDTH/2,this.shapeRenderer.line(r,-u.SCREEN_HEIGHT/2+t.pos.y,r,u.SCREEN_HEIGHT+t.pos.y,s.Color.MAGENTA)}for(var a=t.pos.y%(u.SCREEN_HEIGHT/2),o=Math.ceil((u.SCREEN_HEIGHT+Math.abs(a))/Un),l=0;l<o;l++){var h=0;h=t.pos.y>=0?t.pos.y-a+Un*l-u.SCREEN_HEIGHT/2:t.pos.y-a-Un*l+u.SCREEN_HEIGHT/2,this.shapeRenderer.line(-u.SCREEN_WIDTH/2+t.pos.x,h,u.SCREEN_WIDTH+t.pos.x,h,s.Color.MAGENTA)}this.shapeRenderer.end()}}]),i}(h.xP),pn=b(vn.prototype,"shapeRenderer",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gn=b(vn.prototype,"gameState",[dn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vn),Vn=(mn=(0,h.tB)("cameraUI"),yn=(0,h.tB)("cameraGame"),Mn=(0,h.tB)("configGame"),xn=(0,h.tB)("inputHandler"),bn=(0,h.tB)("assetManager"),wn=(0,h.tB)("batch"),_n=(0,h.tB)("font1"),Tn=(0,h.tB)("font2"),An=function(t){f(i,t);var e=g(i);function i(){var t;l(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return x(t=e.call.apply(e,[this].concat(r)),"cameraUI",kn,v(t)),x(t,"cameraGame",Ln,v(t)),x(t,"configGame",Sn,v(t)),x(t,"inputHandler",En,v(t)),x(t,"assetManager",Cn,v(t)),x(t,"batch",Pn,v(t)),x(t,"font1",Rn,v(t)),x(t,"font2",In,v(t)),t.knight=void 0,t.mage=void 0,t.offset=150,t}return o(i,[{key:"initialized",value:function(){this.knight=this.assetManager.getTexture("knight"),this.mage=this.assetManager.getTexture("mage")}},{key:"process",value:function(){this.batch.setProjection(this.cameraUI.combined),this.batch.begin(),!1===this.configGame.start&&(this.batch.draw(this.knight,u.SCREEN_WIDTH/2-this.offset-200,u.SCREEN_HEIGHT/2-this.offset-50,300,300),this.batch.draw(this.mage,u.SCREEN_WIDTH/2-this.offset+250,u.SCREEN_HEIGHT/2-this.offset-25,200,250)),this.batch.end()}}]),i}(h.xP),kn=b(An.prototype,"cameraUI",[mn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=b(An.prototype,"cameraGame",[yn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sn=b(An.prototype,"configGame",[Mn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),En=b(An.prototype,"inputHandler",[xn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=b(An.prototype,"assetManager",[bn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pn=b(An.prototype,"batch",[wn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=b(An.prototype,"font1",[_n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=b(An.prototype,"font2",[Tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An),Nn=function(){var t=r(e().mark((function t(i,n){var r,a,o,l,c,f,d,v,p,g,x,b,w,_,T,A,k,L,S;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.getContext(),a=n.getCamera(),o=n.getViewportInfo(),l=new s.OrthoCamera(u.SCREEN_WIDTH,u.SCREEN_HEIGHT,o.worldWidth,o.worldHeight),n.addCamera(l),c=new h.q3,f=new s.PolygonBatch(r),d=new s.ShapeRenderer(r),v=new s.ViewportInputHandler(n),t.next=11,s.BitmapFont.load(r,"./font.fnt");case 11:return p=t.sent,t.next=14,s.BitmapFont.load(r,"./font2.fnt");case 14:return g=t.sent,x={origin:new s.Vector2,direction:new s.Vector2,thumbPos:new s.Vector2,touched:!1,move:!1,dragging:!1},b={normalAttack:.25,cooldownSkill3:.45,enemysRespawnTime:.2,amountProtectBall:10,speedProtectBall:5,timeToMakeDamage:.75,sizeSkill1Mage:200,laserCooldown:1.25,start:!1,pause:!1,stop:!1},w=new h.Yl([M,y,m]),_=c.createEntityByArchetype(w),T={playerID:_,enemyIDs:[],bulletIDs:[],normalAttackBulletIDs:[],protectBall:[],protectSkill:0,laserSkillID:[],tempBullet:[]},A={role:0,exp:1,maxExp:100,currentLevel:1},k={hp:100,damage:25},(L=c.getComponent(T.playerID,M)).setPos(0,0),L.setRadius(25),c.getComponent(T.playerID,y).speed=4,(S=c.getComponent(T.playerID,m)).setHp(100),S.setMaxHP(100),c.register("cameraGame",l),c.register("batch",f),c.register("shapeRenderer",d),c.register("assetManager",i),c.register("cameraUI",a),c.register("cameraGame",l),c.register("gameState",T),c.register("configGame",b),c.register("levelState",A),c.register("powerEnemy",k),c.register("inputHandler",v),c.register("joyStick",x),c.register("font",p),c.register("font2",g),c.addSystem(new Dn,!1),c.addSystem(new Vn,!1),c.addSystem(new Bn,!0),r.clearColor(0,0,0,1),t.abrupt("return",{update:function(t){r.clear(r.COLOR_BUFFER_BIT),f.setProjection(l.combined),d.setProjection(l.combined),c.setDelta(t),b.pause||b.stop||c.processActiveSystem(),c.processPassiveSystem()},dispose:function(){}});case 49:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}(),zn=function(){var t=r(e().mark((function t(){var i,n,r,a,o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=(0,s.createStage)(),n=i.getCanvas(),r=(0,s.createViewport)(n,u.SCREEN_WIDTH,u.SCREEN_HEIGHT),a=r.getContext(),o=new s.AssetManager(a),t.next=7,o.loadTexture("./knight.png","knight");case 7:return t.next=9,o.loadTexture("./mage.png","mage");case 9:return t.t0=s.Game.shared,t.next=12,Nn(o,r);case 12:t.t1=t.sent,t.t0.setScreen.call(t.t0,t.t1),(0,s.createGameLoop)((function(t){s.Game.shared.update(t)}));case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();zn()}()}();
//# sourceMappingURL=main.e6fbd2a2.js.map